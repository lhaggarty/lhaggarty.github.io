<!DOCTYPE html>
<html>
		<head>
			<title>Hot Potato Tool</title>
			<link rel="stylesheet" type="text/css" href="css/style.css"/>
			<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
			<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js" ></script>
	        
	        <link type="text/css" href="css/bootstrap-timepicker.min.css" />
			<!-- Latest compiled and minified JavaScript -->
			<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
	        
			<script type="text/javascript" src="js/bootstrap-timepicker.js"></script>
			
			<script>
		  var tempOutputLink=$('input#OutputYouTubeLink').html();
		  alert(tempOutputLink);
  	      function init() {
  	        gapi.client.setApiKey('AIzaSyACLrao747cjeAEyK_xBMZNQKtiE2Cyo8Y');
  	        gapi.client.load('urlshortener', 'v1').then(makeRequest);
  	      }
  	      function makeRequest() {
  	        var request = gapi.client.urlshortener.url.insert({
				'longUrl': tempOutputLink
  	        });
  	        request.then(function(response) {
  	          appendResults(response.result);
  	        }, function(reason) {
  	          console.log('Error: ' + reason.result.error.message);
  	        });
  	      }
  	      function appendResults(text) {
  	        var results = document.getElementById('OutputYouTubeLink');
  	        //results.appendChild(document.createElement('P'));
  	        results.appendChild(document.createTextNode(text.id));
  			console.log('Data: ' + JSON.stringify(text));
  	      }
			</script>
		</head>
<body>
	<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
	      <div class="container">
	        <div class="navbar-header">
	          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
	            <span class="sr-only">Toggle navigation</span>
	            <span class="icon-bar"></span>
	            <span class="icon-bar"></span>
	            <span class="icon-bar"></span>
	          </button>
	        </div>
	        <div class="navbar-collapse collapse">
	          <ul class="nav navbar-nav">
	            <li class="active"><a href="index.html">Home</a></li>
	            <li><a href="about.html">About &amp; Contact</a></li>
				<li><a href="but_why.html">But Why?</a></li>
	        </div><!--/.nav-collapse -->
	      </div>
	    </div>
	</div>
			<div class="container">
				<div class="row">
					<div class="col-md-12">
						<div class="intro-message">
							<h1>
								Hot Potato: The YouTube Video Editor
							</h1>
							<h3>
								Try the tool and share your edits!
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="container">
				<form role="form">
					<div class="form-group">
						<div class ="row">
							<div class="col-md-4 col-md-offset-4">  
				    <label for="InputYouTubeLink" style="color: #FFF">Enter YouTube Video Link Here</label>
				    <input type="text" class="form-control" id="InputYouTubeLink" placeholder="www.youtube.com..." onclick="displayTimeControls()">
				  			</div>
						</div>
					</div>
				</form>
				<form  class="form-inline" role="form">
					<div class="form-group">
						<div class ="row">
							<div class="col-md-8 col-md-offset-11">
								<div class="bootstrap-timepicker">
				    				<label for="InputPlayPoint" style="color: #FFF">Enter video play point</label>
				    				<input type="text" class="form-control" id="InputPlayPoint" required disabled>
									<i class="icon-time"></i>
								</div>
				  			</div>
						</div>
					</div>
					<div class="form-group">
						<div class="col-md-8 col-md-offset-9">  
							<div class="bootstrap-timepicker">
				    			<label for="InputEndPoint" style="color: #FFF">Enter video end point</label>
				    			<input type="text" class="form-control" id="InputEndPoint" disabled>
								<i class="icon-time"></i>
							</div>
				  		</div>
					</div>
					
					<div class ="row">
						<div class="col-md-4 col-md-offset-5" style="padding-left: 4.5%"> 
							
							<button type="button" class="btn btn-default" onclick="myFunction()">Submit</button>
						</div>
					</div>
					
			  	</form>
				
			</div>
			<div class="container">
				<div class ="row" style="padding-top: 2%; display: none" id="outputButtons">
					<div class="col-md-6 col-md-offset-3">
						<button type="button" class="btn btn-default" id="selectAllButton" onclick="selectText('OutputYouTubeLink')">Select Link</button>
						<button type="button" class="btn btn-default" id="backButton" onclick="backFunction()">Reset</button>
					</div>
				</div>
				<div class ="row" style="padding-top: 2%">
					<div class="col-md-6 col-md-offset-3">
						
						<div class="well" id="OutputYouTubeLink" ></div>
						
					</div>
				</div>
			</div>
			
	        <script type="text/javascript">
	            $('#InputPlayPoint').timepicker({
	                template: false,
	                showInputs: false,
	                minuteStep: 5,
					showSeconds: true,
					showMeridian: false,
					defaultTime: '0:01:00',
	            });
	            $('#InputEndPoint').timepicker({
	                showInputs: false,
	                minuteStep: 5,
					showSeconds: true,
					showMeridian: false,
					defaultTime: '0:02:00'
	            });
	        </script>
			
			<script>
				function displayTimeControls(){
					$("input").removeAttr('disabled');
				}
			</script>
			
			<script>
			
			function myFunction(){
				var hms1 = $('input#InputPlayPoint').val();
				var hms2 = $('input#InputEndPoint').val();
				var secps1 = hms1.split(':'); // split it at the colons
				var secps2 = hms2.split(':'); // split it at the colons
				// minutes are worth 60 seconds. Hours are worth 60 minutes.
				var secondsIn = (+secps1[0]) * 60 * 60 + (+secps1[1]) * 60 + (+secps1[2]); 
				var secondsOut = (+secps2[0]) * 60 * 60 + (+secps2[1]) * 60 + (+secps2[2]);
				var shortYTLink;
				
				//shortYTLink = $( '#InputYouTubeLink' ).not( 'www.youtube.com/watch?v=' ).val();
				
				shortYTLink = getQueryVariable("v",$( '#InputYouTubeLink' ).val());
				//tempOutputLink = ( "https://www.youtube.com/v/" + shortYTLink + '%26start=' + secondsIn + '%26end=' + secondsOut);
				$( '#OutputYouTubeLink' ).html( "https://www.youtube.com/v/" + shortYTLink + '%26start=' + secondsIn + '%26end=' + secondsOut);
				
				$("form").slideUp();
				
				
				document.getElementById('videoPlaybackFrame').src = $('#OutputYouTubeLink').html();
				document.getElementById('videoPlayback').style.display ="";
				document.getElementById('outputButtons').style.display ="";
				shortURLFunction(); 
			}
			
			function getQueryVariable(name,url) {
				   var query = url.split( "?" );
			       var vars = query[1].split("&");
			       for (var i=0;i<vars.length;i++) {
			               var pair = vars[i].split("=");
			               if(pair[0] == name){return pair[1];}
			       }
			       return(query);
			}
			</script>
			
			<script src="https://apis.google.com/js/client.js?onload=init">
			function shortURLFunction (){
			}
			</script>
			
			<script>
			function backFunction(){
				document.getElementById('videoPlayback').style.display ="none";
				document.getElementById('outputButtons').style.display ="none";
				$( '#OutputYouTubeLink' ).html("");
				$("form").slideDown();
				
			}
			</script>
			<script type="text/javascript">
			function selectText( containerid ) {

			        var node = document.getElementById( containerid );

			        if ( document.selection ) {
			            var range = document.body.createTextRange();
			            range.moveToElementText( node  );
			            range.select();
			        } else if ( window.getSelection ) {
			            var range = document.createRange();
			            range.selectNodeContents( node );
			            window.getSelection().removeAllRanges();
			            window.getSelection().addRange( range );
			        }
			    }
			</script>
			
			<div class="col-md-offset-3" id="videoPlayback" style="display: none; padding-top: 1%; padding-left: 3.3%">
			 	<iframe id="videoPlaybackFrame" width="560" height="315" src="" frameborder="0" allowfullscreen></iframe>
			</div>

</body>
</html> 
