!function(t,e,r){function a(t){return t}function i(t){return o(decodeURIComponent(t.replace(s," ")))}function o(t){return 0===t.indexOf('"')&&(t=t.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")),t}function n(t){return u.json?JSON.parse(t):t}var s=/\+/g,u=t.cookie=function(o,s,m){if(s!==r){if(m=t.extend({},u.defaults,m),null===s&&(m.expires=-1),"number"==typeof m.expires){var d=m.expires,l=m.expires=new Date;l.setDate(l.getDate()+d)}return s=u.json?JSON.stringify(s):String(s),e.cookie=[encodeURIComponent(o),"=",u.raw?s:encodeURIComponent(s),m.expires?"; expires="+m.expires.toUTCString():"",m.path?"; path="+m.path:"",m.domain?"; domain="+m.domain:"",m.secure?"; secure":""].join("")}for(var c=u.raw?a:i,h=e.cookie.split("; "),p=o?null:{},f=0,_=h.length;_>f;f++){var g=h[f].split("="),w=c(g.shift()),y=c(g.join("="));if(o&&o===w){p=n(y);break}o||(p[w]=n(y))}return p};u.defaults={},t.removeCookie=function(e,r){return null!==t.cookie(e)?(t.cookie(e,null,r),!0):!1}}(jQuery,document),function(){var t,e,r,a,i,o,n={}.hasOwnProperty;o="undefined"!=typeof exports&&null!==exports?exports:this,e=function(t){this.message=t},e.prototype=new Error,i={prefix:"",default_url_options:{}},t={GROUP:1,CAT:2,SYMBOL:3,OR:4,STAR:5,LITERAL:6,SLASH:7,DOT:8},r={serialize:function(t,e){var r,a,i,s,u,m,d,l;if(null==e&&(e=null),!t)return"";if(!e&&"object"!==this.get_object_type(t))throw new Error("Url parameters should be a javascript hash");if(o.jQuery)return u=o.jQuery.param(t),u?u:"";switch(m=[],this.get_object_type(t)){case"array":for(a=d=0,l=t.length;l>d;a=++d)r=t[a],m.push(this.serialize(r,e+"[]"));break;case"object":for(i in t)n.call(t,i)&&(s=t[i],null!=s&&(null!=e&&(i=""+e+"["+i+"]"),m.push(this.serialize(s,i))));break;default:t&&m.push(""+encodeURIComponent(e.toString())+"="+encodeURIComponent(t.toString()))}return m.length?m.join("&"):""},clean_path:function(t){var e;return t=t.split("://"),e=t.length-1,t[e]=t[e].replace(/\/+/g,"/"),t.join("://")},set_default_url_options:function(t,e){var r,a,o,n,s;for(s=[],r=o=0,n=t.length;n>o;r=++o)a=t[r],!e.hasOwnProperty(a)&&i.default_url_options.hasOwnProperty(a)&&s.push(e[a]=i.default_url_options[a]);return s},extract_anchor:function(t){var e;return e="",t.hasOwnProperty("anchor")&&(e="#"+t.anchor,delete t.anchor),e},extract_trailing_slash:function(t){var e;return e=!1,i.default_url_options.hasOwnProperty("trailing_slash")&&(e=i.default_url_options.trailing_slash),t.hasOwnProperty("trailing_slash")&&(e=t.trailing_slash,delete t.trailing_slash),e},extract_options:function(t,e){var r;return r=e[e.length-1],e.length>t||null!=r&&"object"===this.get_object_type(r)&&!this.look_like_serialized_model(r)?e.pop():{}},look_like_serialized_model:function(t){return"id"in t||"to_param"in t},path_identifier:function(t){var e;return 0===t?"0":t?(e=t,"object"===this.get_object_type(t)&&(e="to_param"in t?t.to_param:"id"in t?t.id:t,"function"===this.get_object_type(e)&&(e=e.call(t))),e.toString()):""},clone:function(t){var e,r,a;if(null==t||"object"!==this.get_object_type(t))return t;r=t.constructor();for(a in t)n.call(t,a)&&(e=t[a],r[a]=e);return r},prepare_parameters:function(t,e,r){var a,i,o,n,s;for(i=this.clone(r)||{},a=n=0,s=t.length;s>n;a=++n)o=t[a],a<e.length&&(i[o]=e[a]);return i},build_path:function(t,e,a,i){var o,n,s,u,m,d,l;if(i=Array.prototype.slice.call(i),n=this.extract_options(t.length,i),i.length>t.length)throw new Error("Too many parameters provided for path");return s=this.prepare_parameters(t,i,n),this.set_default_url_options(e,s),o=this.extract_anchor(s),m=this.extract_trailing_slash(s),u=""+this.get_prefix()+this.visit(a,s),d=r.clean_path(""+u),m===!0&&(d=d.replace(/(.*?)[\/]?$/,"$1/")),(l=this.serialize(s)).length&&(d+="?"+l),d+=o},visit:function(r,a,i){var o,n,s,u,m,d;switch(null==i&&(i=!1),m=r[0],o=r[1],s=r[2],m){case t.GROUP:return this.visit(o,a,!0);case t.STAR:return this.visit_globbing(o,a,!0);case t.LITERAL:case t.SLASH:case t.DOT:return o;case t.CAT:return n=this.visit(o,a,i),u=this.visit(s,a,i),!i||n&&u?""+n+u:"";case t.SYMBOL:if(d=a[o],null!=d)return delete a[o],this.path_identifier(d);if(i)return"";throw new e("Route parameter missing: "+o);default:throw new Error("Unknown Rails node type")}},build_path_spec:function(e,r){var a,i,o;switch(null==r&&(r=!1),o=e[0],a=e[1],i=e[2],o){case t.GROUP:return"("+this.build_path_spec(a)+")";case t.CAT:return""+this.build_path_spec(a)+this.build_path_spec(i);case t.STAR:return this.build_path_spec(a,!0);case t.SYMBOL:return r===!0?""+("*"===a[0]?"":"*")+a:":"+a;case t.SLASH:case t.DOT:case t.LITERAL:return a;default:throw new Error("Unknown Rails node type")}},visit_globbing:function(t,e,r){var a,i,o,n;return o=t[0],a=t[1],i=t[2],a.replace(/^\*/i,"")!==a&&(t[1]=a=a.replace(/^\*/i,"")),n=e[a],null==n?this.visit(t,e,r):(e[a]=function(){switch(this.get_object_type(n)){case"array":return n.join("/");default:return n}}.call(this),this.visit(t,e,r))},get_prefix:function(){var t;return t=i.prefix,""!==t&&(t=t.match("/$")?t:""+t+"/"),t},route:function(t,e,a){var i;return i=function(){return r.build_path(t,e,a,arguments)},i.required_params=t,i.toString=function(){return r.build_path_spec(a)},i},_classToTypeCache:null,_classToType:function(){var t,e,r,a;if(null!=this._classToTypeCache)return this._classToTypeCache;for(this._classToTypeCache={},a="Boolean Number String Function Array Date RegExp Object Error".split(" "),e=0,r=a.length;r>e;e++)t=a[e],this._classToTypeCache["[object "+t+"]"]=t.toLowerCase();return this._classToTypeCache},get_object_type:function(t){return o.jQuery&&null!=o.jQuery.type?o.jQuery.type(t):null==t?""+t:"object"==typeof t||"function"==typeof t?this._classToType()[Object.prototype.toString.call(t)]||"object":typeof t}},a=function(){var t;return t=function(e,r){var a,i;return i=r?r.split("."):[],i.length?(a=i.shift(),e[a]=e[a]||{},t(e[a],i.join("."))):void 0},t(o,"Routes"),o.Routes={api_users_GetUserInfo_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"api",!1],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[6,"GetUserInfo",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]]]],arguments),api_users_press_reader_me_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"api",!1],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[6,"press_reader_me",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]]]],arguments),cancel_user_registration_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[6,"cancel",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),cities_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"cities",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]],arguments),city_path:r.route(["id"],["format"],[2,[7,"/",!1],[2,[6,"cities",!1],[2,[7,"/",!1],[2,[3,"id",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),city_weathers_path:r.route(["city_id"],["format"],[2,[7,"/",!1],[2,[6,"cities",!1],[2,[7,"/",!1],[2,[3,"city_id",!1],[2,[7,"/",!1],[2,[6,"weathers",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]]]],arguments),confirmations_success_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"confirmations",!1],[2,[7,"/",!1],[2,[6,"success",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),csrf_users_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[6,"csrf",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),current_users_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[6,"current",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),current_weather_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"weathers",!1],[2,[7,"/",!1],[2,[6,"current",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),destroy_user_session_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[6,"sign_out",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),edit_city_path:r.route(["id"],["format"],[2,[7,"/",!1],[2,[6,"cities",!1],[2,[7,"/",!1],[2,[3,"id",!1],[2,[7,"/",!1],[2,[6,"edit",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]]]],arguments),edit_province_path:r.route(["id"],["format"],[2,[7,"/",!1],[2,[6,"provinces",!1],[2,[7,"/",!1],[2,[3,"id",!1],[2,[7,"/",!1],[2,[6,"edit",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]]]],arguments),edit_user_password_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[6,"password",!1],[2,[7,"/",!1],[2,[6,"edit",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]]]],arguments),edit_user_registration_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[6,"edit",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),edit_weather_path:r.route(["id"],["format"],[2,[7,"/",!1],[2,[6,"weathers",!1],[2,[7,"/",!1],[2,[3,"id",!1],[2,[7,"/",!1],[2,[6,"edit",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]]]],arguments),finish_signup_path:r.route(["id"],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[3,"id",!1],[2,[7,"/",!1],[2,[6,"finish_signup",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]]]],arguments),new_city_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"cities",!1],[2,[7,"/",!1],[2,[6,"new",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),new_city_weather_path:r.route(["city_id"],["format"],[2,[7,"/",!1],[2,[6,"cities",!1],[2,[7,"/",!1],[2,[3,"city_id",!1],[2,[7,"/",!1],[2,[6,"weathers",!1],[2,[7,"/",!1],[2,[6,"new",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]]]]]],arguments),new_province_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"provinces",!1],[2,[7,"/",!1],[2,[6,"new",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),new_province_city_path:r.route(["province_id"],["format"],[2,[7,"/",!1],[2,[6,"provinces",!1],[2,[7,"/",!1],[2,[3,"province_id",!1],[2,[7,"/",!1],[2,[6,"cities",!1],[2,[7,"/",!1],[2,[6,"new",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]]]]]],arguments),new_user_confirmation_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[6,"confirmation",!1],[2,[7,"/",!1],[2,[6,"new",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]]]],arguments),new_user_password_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[6,"password",!1],[2,[7,"/",!1],[2,[6,"new",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]]]],arguments),new_user_registration_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[6,"sign_up",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),new_user_session_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[6,"sign_in",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),newsletters_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"newsletters",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]],arguments),passwords_success_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"passwords",!1],[2,[7,"/",!1],[2,[6,"success",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),province_path:r.route(["id"],["format"],[2,[7,"/",!1],[2,[6,"provinces",!1],[2,[7,"/",!1],[2,[3,"id",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),province_cities_path:r.route(["province_id"],["format"],[2,[7,"/",!1],[2,[6,"provinces",!1],[2,[7,"/",!1],[2,[3,"province_id",!1],[2,[7,"/",!1],[2,[6,"cities",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]]]],arguments),provinces_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"provinces",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]],arguments),rails_admin_dashboard_path:r.route([],[],[2,[2,[7,"/",!1],[6,"admin",!1]],[7,"/",!1]],arguments),rails_admin_index_path:r.route(["model_name"],["format"],[2,[2,[2,[7,"/",!1],[6,"admin",!1]],[7,"/",!1]],[2,[3,"model_name",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]],arguments),rails_admin_new_path:r.route(["model_name"],["format"],[2,[2,[2,[7,"/",!1],[6,"admin",!1]],[7,"/",!1]],[2,[3,"model_name",!1],[2,[7,"/",!1],[2,[6,"new",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),rails_admin_export_path:r.route(["model_name"],["format"],[2,[2,[2,[7,"/",!1],[6,"admin",!1]],[7,"/",!1]],[2,[3,"model_name",!1],[2,[7,"/",!1],[2,[6,"export",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),rails_admin_bulk_delete_path:r.route(["model_name"],["format"],[2,[2,[2,[7,"/",!1],[6,"admin",!1]],[7,"/",!1]],[2,[3,"model_name",!1],[2,[7,"/",!1],[2,[6,"bulk_delete",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),rails_admin_bulk_action_path:r.route(["model_name"],["format"],[2,[2,[2,[7,"/",!1],[6,"admin",!1]],[7,"/",!1]],[2,[3,"model_name",!1],[2,[7,"/",!1],[2,[6,"bulk_action",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),rails_admin_show_path:r.route(["model_name","id"],["format"],[2,[2,[2,[7,"/",!1],[6,"admin",!1]],[7,"/",!1]],[2,[3,"model_name",!1],[2,[7,"/",!1],[2,[3,"id",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),rails_admin_edit_path:r.route(["model_name","id"],["format"],[2,[2,[2,[7,"/",!1],[6,"admin",!1]],[7,"/",!1]],[2,[3,"model_name",!1],[2,[7,"/",!1],[2,[3,"id",!1],[2,[7,"/",!1],[2,[6,"edit",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]]]],arguments),rails_admin_delete_path:r.route(["model_name","id"],["format"],[2,[2,[2,[7,"/",!1],[6,"admin",!1]],[7,"/",!1]],[2,[3,"model_name",!1],[2,[7,"/",!1],[2,[3,"id",!1],[2,[7,"/",!1],[2,[6,"delete",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]]]],arguments),rails_admin_show_in_app_path:r.route(["model_name","id"],["format"],[2,[2,[2,[7,"/",!1],[6,"admin",!1]],[7,"/",!1]],[2,[3,"model_name",!1],[2,[7,"/",!1],[2,[3,"id",!1],[2,[7,"/",!1],[2,[6,"show_in_app",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]]]],arguments),registrations_success_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"registrations",!1],[2,[7,"/",!1],[2,[6,"success",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),root_path:r.route([],[],[7,"/",!1],arguments),sess_users_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[6,"sess",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),sessions_signed_in_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"sessions",!1],[2,[7,"/",!1],[2,[6,"signed_in",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),sessions_signed_out_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"sessions",!1],[2,[7,"/",!1],[2,[6,"signed_out",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),user_path:r.route(["id"],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[3,"id",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),user_confirmation_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[6,"confirmation",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),user_omniauth_authorize_path:r.route(["provider"],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[6,"auth",!1],[2,[7,"/",!1],[2,[3,"provider",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]]]],arguments),user_omniauth_callback_path:r.route(["action"],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[6,"auth",!1],[2,[7,"/",!1],[2,[3,"action",!1],[2,[7,"/",!1],[2,[6,"callback",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]]]]]],arguments),user_password_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[6,"password",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),user_registration_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]],arguments),user_session_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[6,"sign_in",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),users_city_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[6,"city",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),users_city_edit_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[6,"city",!1],[2,[7,"/",!1],[2,[6,"edit",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]]]],arguments),verify_session_users_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"users",!1],[2,[7,"/",!1],[2,[6,"verify_session",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),weather_path:r.route(["id"],["format"],[2,[7,"/",!1],[2,[6,"weathers",!1],[2,[7,"/",!1],[2,[3,"id",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),weather_city_path:r.route(["id"],["format"],[2,[7,"/",!1],[2,[6,"cities",!1],[2,[7,"/",!1],[2,[3,"id",!1],[2,[7,"/",!1],[2,[6,"weather",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]]]],arguments),widgets_settings_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"widgets",!1],[2,[7,"/",!1],[2,[6,"settings",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments),widgets_weather_path:r.route([],["format"],[2,[7,"/",!1],[2,[6,"widgets",!1],[2,[7,"/",!1],[2,[6,"weather",!1],[1,[2,[8,".",!1],[3,"format",!1]],!1]]]]],arguments)},o.Routes.options=i,o.Routes},"function"==typeof define&&define.amd?define([],function(){return a()}):a()}.call(this),$(document).ready(function(){$(document).on("click",".mystar .settings .navigation .expand-menu",function(t){t.preventDefault(),$(this).closest(".navigation").children(".item:not(:first-child)").toggle()}),$(document).on("click",".mystar .settings a.open-user-widget",function(t){t.preventDefault(),$(this).closest(".navigation").children(".item:not(:first-child)").hide(),myStar.closeWeatherWindow(),0==$("#mystar-settings-window").length&&($(this).hasClass("invisible-window")?myStar.openInvisibleWindow($(this)):myStar.openSettingsWindow($(this)))}),$(document).on("click",".mystar .weather a.open-weather-widget",function(t){t.preventDefault(),myStar.closeSettingsWindow(),myStar.closeInvisibleWindow(),0==$("#mystar-weather-window").length?myStar.openWeatherWindow($(this)):!1})}),function(){function t(){this.domain=document.domain,this.loadCSS=function(){var t=this,e=document.createElement("link");e.setAttribute("media","all"),e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",t.domain+"/assets/mystar.css"),"undefined"!=typeof e&&document.getElementsByTagName("head")[0].appendChild(e)},this.loadSettingsWidget=function(){var t=this,e=$.ajax({url:t.domain+Routes.widgets_settings_path({format:"js"}),type:"GET",dataType:"jsonp",jsonpCallback:"mystarLoadSettingsWidgetCallback"});e.success(function(e){var r=$(".mystar .settings");r.html(e.html);var a=r.find("a.open-user-widget");if($.cookie("auto_open_uri")){var i=$.cookie("auto_open_uri"),o=$.cookie("auto_open_type");"settings"==o&&t.openSettingsWindow(a,i)}})},this.loadWeatherWidget=function(){var t=this,e=$.ajax({url:t.domain+Routes.widgets_weather_path({format:"js"}),type:"GET",dataType:"jsonp",jsonpCallback:"mystarLoadWeatherWidgetCallback"});e.success(function(e){var r=$(".mystar .weather");r.html(e.html);var a=r.find("a.open-weather-widget");if($.cookie("auto_open_uri")){var i=$.cookie("auto_open_uri"),o=$.cookie("auto_open_type");"weather"==o&&t.openWeatherWindow(a,i)}})},this.openSettingsWindow=function(t,e){var r=this;url=null!=e?r.domain+e:null!=t.attr("href")?r.domain+t.attr("href"):r.domain+Routes.new_user_session_path();$('<div id="mystar-settings-window" />').dialog({autoOpen:!0,width:460,height:530,position:{my:"right top",at:"right bottom",of:t.closest(".navigation").children(".item:first-child")},create:function(t){$(t.target).parent().find(".ui-dialog-titlebar").remove()},open:function(){$(this).append('<div class="closeWindow"><span aria-hidden="true"><span class="sr-only">Close</span></div>'),$(this).append('<iframe id="mystar-settings-window-frame" width="460" height="530" frameborder="0" border="0" src="'+url+'"></iframe>'),$(".mystar .settings a").addClass("selected")},close:function(){$(".mystar .settings a").removeClass("selected"),$(this).dialog("destroy").empty().remove()}})},this.resizeSettingsWindow=function(t,e){var r=$("#mystar-settings-window").dialog();r.dialog("option","width",t),r.dialog("option","height",e),r.children("iframe").width(t).height(e)},this.closeSettingsWindow=function(){$("#mystar-settings-window").dialog("close")},this.openWeatherWindow=function(t,e){var r=this;url=null!=e?r.domain+e:null!=t.attr("href")?r.domain+t.attr("href"):r.domain+Routes.weather_city_path("toronto");$('<div id="mystar-weather-window" />').dialog({autoOpen:!0,width:420,height:620,position:{my:"left top",at:"left bottom",of:t},create:function(t){$(t.target).parent().find(".ui-dialog-titlebar").remove()},open:function(){$(this).append('<div class="closeWindow"><span aria-hidden="true"><span class="sr-only">Close</span></div>'),$(this).append('<iframe id="mystar-weather-window-frame" width="420" height="620" frameborder="0" border="0" src="'+url+'"></iframe>'),$(".mystar .weather a").addClass("weather-active")},close:function(){$(".mystar .weather a").removeClass("weather-active"),$(this).dialog("destroy").empty().remove()}})},this.resizeWeatherWindow=function(t,e){var r=$("#mystar-weather-window").dialog();r.dialog("option","width",t),r.dialog("option","height",e),r.children("iframe").width(t).height(e)},this.closeWeatherWindow=function(){$("#mystar-weather-window").dialog("close")},this.openInvisibleWindow=function(t,e){var r=this,a=r.domain;null!=e?a+=e:null!=t.attr("href")&&(a+=t.attr("href"));$('<div id="mystar-invisible-window" style="visibility: hidden; outline: none;" />').dialog({autoOpen:!0,width:1,height:1,position:{my:"left bottom",at:"right top",of:window},create:function(t){$(t.target).parent().find(".ui-dialog-titlebar").remove()},open:function(){$(this).append('<iframe id="mystar-invisible-window-frame" width="1" height="1" frameborder="0" border="0" src="'+a+'"></iframe>'),$(".mystar .settings a").addClass("selected")},close:function(){$(".mystar .settings a").removeClass("selected"),$(this).dialog("destroy").empty().remove()}})},this.closeInvisibleWindow=function(){$("#mystar-invisible-window").dialog("close")},this.getCurrentUser=function(t){var e=this,r=$.ajax({url:e.domain+Routes.current_users_path({format:"js"}),type:"GET",dataType:"jsonp",jsonpCallback:"mystarGetCurrentUserCallback"});r.success(function(e){t(e)})},this.loadComments=function(){var t=window.location.host,e=$.cookie("_session_id");"local.thestar.com"!=t&&void 0!=window.viafoura&&window.viafoura.session.login.cookie(e),$(".vf-login-button, .vf-comment-form").off("click"),$("#comments-section").off("click"),$("#comments-section").removeClass("loggedOut"),$("#comments-section").addClass("loggedIn"),$(".alt-vf-login").hide(),$(".vf-login-widget").show()},this.unloadComments=function(){window.viafoura.session.logout(),$(".vf-commenting").prepend('<a href="#" class="alt-vf-login">Login</a>'),listenSelector=".alt-vf-login, .vf-comment-form",1==$.browser.msie&&"8.0"==$.browser.version&&(listenSelector="#comments_list"),$(listenSelector).click(function(){return $("html, body").animate({scrollTop:0},600),$(".mystar .settings a").trigger("click"),!1}),$("#comments-section").addClass("loggedOut"),$("#comments-section").removeClass("loggedIn"),$(".alt-vf-login").show(),$(".vf-login-widget").hide()}}window.myStar=new t}(),$(document).ready(function(){var t=$('script[src$="mystar.js"]').attr("src"),e=$("<a>",{href:t});myStar.domain=-1!==e.prop("host").indexOf("localhost")?e.prop("protocol")+"//"+e.prop("host"):e.prop("protocol")+"//"+e.prop("host").split(":")[0],myStar.loadCSS(),myStar.loadSettingsWidget(),myStar.loadWeatherWidget();var r=window.addEventListener?"addEventListener":"attachEvent",a=window[r],i="attachEvent"==r?"onmessage":"message";a(i,function(t){data=t.data.split(":"),identifier=data.shift(),action=data.shift(),lastParam=data.pop(),firstParam=data.join(":"),t.origin==myStar.domain&&"myStar"==identifier&&("signedIn"==action||"signedOut"==action||"newUser"==action?(myStar.closeSettingsWindow(),myStar.closeInvisibleWindow(),myStar.loadSettingsWidget(),myStar.loadWeatherWidget(),myStar.loadComments()):"updateInfo"==action?(myStar.loadSettingsWidget(),myStar.loadWeatherWidget()):"resizeSettingsWindow"==action?myStar.resizeSettingsWindow(firstParam,lastParam):"resizeWeatherWindow"==action&&myStar.resizeWeatherWindow(firstParam,lastParam))},!1),$(document).on("click","#mystar-settings-window .closeWindow",function(t){t.preventDefault(),myStar.closeSettingsWindow()}),$(document).on("click","#mystar-weather-window .closeWindow",function(t){t.preventDefault(),myStar.closeWeatherWindow()})});