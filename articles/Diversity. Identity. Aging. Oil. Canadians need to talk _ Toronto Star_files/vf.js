/*! Copyright Viafoura 8b654f4 1433370252 | https://cdn.viafoura.net/licenses.txt */
!function(t){function e(i){if(n[i])return n[i].exports;var s=n[i]={exports:{},id:i,loaded:!1};return t[i].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i=window.webpackJsonp;window.webpackJsonp=function(n,r){for(var o,a,l=0,u=[];l<n.length;l++)a=n[l],s[a]&&u.push.apply(u,s[a]),s[a]=0;for(o in r)t[o]=r[o];for(i&&i(n,r);u.length;)u.shift().call(null,e)};var n={},s={0:0};return e.e=function(t,i){if(0===s[t])return i.call(null,e);if(void 0!==s[t])s[t].push(i);else{s[t]=[i];var n=document.getElementsByTagName("head")[0],r=document.createElement("script");r.type="text/javascript",r.charset="utf-8",r.async=!0,r.src=e.p+"8b654f4/"+{1:"717b1c54d04d465afe27",2:"d08ed9e0c368c6ef5aac"}[t]+".vf.js",n.appendChild(r)}},e.m=t,e.c=n,e.p="",e(0)}([function(t,e,i){var n,s;n=[i(1),i(2),i(4),i(11),i(55),i(92),i(132),i(133)],s=function(t,e,i,n,s){i.isInitializedOnWindow()||(i.ready(function(){new s({el:e("body")})}),window.JSON=window.JSON||t,i.init())}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;(function(window){var JSON=window.JSON||{};!function(){"use strict";function f(t){return 10>t?"0"+t:t}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var i,n,s,r,o,a=gap,l=e[t];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(t)),"function"==typeof rep&&(l=rep.call(e,t,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(l)){for(r=l.length,i=0;r>i;i+=1)o[i]=str(i,l)||"null";return s=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+a+"]":"["+o.join(",")+"]",gap=a,s}if(rep&&"object"==typeof rep)for(r=rep.length,i=0;r>i;i+=1)"string"==typeof rep[i]&&(n=rep[i],s=str(n,l),s&&o.push(quote(n)+(gap?": ":":")+s));else for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(s=str(n,l),s&&o.push(quote(n)+(gap?": ":":")+s));return s=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+a+"}":"{"+o.join(",")+"}",gap=a,s}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(t){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(t){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,e,i){var n;if(gap="",indent="","number"==typeof i)for(n=0;i>n;n+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})});var old=JSON.stringify;JSON.stringify=function(){return window.Prototype&&[].toJSON&&Object.toJSON?Object.toJSON.apply(this,arguments):window.MooTools&&[].toJSON&&JSON.encode?JSON.encode.apply(this,arguments):old.apply(this,arguments)},"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(t,e){var i,n,s=t[e];if(s&&"object"==typeof s)for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(n=walk(s,i),void 0!==n?s[i]=n:delete s[i]);return reviver.call(t,e,s)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),__WEBPACK_AMD_DEFINE_RESULT__=function(){return JSON}.call(exports,__webpack_require__,exports,module),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}).call(this,this)},function(t,e,i){var n,s;!function(r,o){function a(t){var e=t.length,i=ft.type(t);return ft.isWindow(t)?!1:1===t.nodeType&&e?!0:"array"===i||"function"!==i&&(0===e||"number"==typeof e&&e>0&&e-1 in t)}function l(t){var e=At[t]={};return ft.each(t.match(mt)||[],function(t,i){e[i]=!0}),e}function u(t,e,i,n){if(ft.acceptData(t)){var s,r,a=ft.expando,l="string"==typeof e,u=t.nodeType,c=u?ft.cache:t,h=u?t[a]:t[a]&&a;if(h&&c[h]&&(n||c[h].data)||!l||i!==o)return h||(u?t[a]=h=st.pop()||ft.guid++:h=a),c[h]||(c[h]={},u||(c[h].toJSON=ft.noop)),("object"==typeof e||"function"==typeof e)&&(n?c[h]=ft.extend(c[h],e):c[h].data=ft.extend(c[h].data,e)),s=c[h],n||(s.data||(s.data={}),s=s.data),i!==o&&(s[ft.camelCase(e)]=i),l?(r=s[e],null==r&&(r=s[ft.camelCase(e)])):r=s,r}}function c(t,e,i){if(ft.acceptData(t)){var n,s,r,o=t.nodeType,a=o?ft.cache:t,l=o?t[ft.expando]:ft.expando;if(a[l]){if(e&&(r=i?a[l]:a[l].data)){ft.isArray(e)?e=e.concat(ft.map(e,ft.camelCase)):e in r?e=[e]:(e=ft.camelCase(e),e=e in r?[e]:e.split(" "));for(n=0,s=e.length;s>n;n++)delete r[e[n]];if(!(i?d:ft.isEmptyObject)(r))return}(i||(delete a[l].data,d(a[l])))&&(o?ft.cleanData([t],!0):ft.support.deleteExpando||a!=a.window?delete a[l]:a[l]=null)}}}function h(t,e,i){if(i===o&&1===t.nodeType){var n="data-"+e.replace(Nt,"-$1").toLowerCase();if(i=t.getAttribute(n),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:$t.test(i)?ft.parseJSON(i):i}catch(s){}ft.data(t,e,i)}else i=o}return i}function d(t){var e;for(e in t)if(("data"!==e||!ft.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function f(){return!0}function p(){return!1}function m(t,e){do t=t[e];while(t&&1!==t.nodeType);return t}function g(t,e,i){if(e=e||0,ft.isFunction(e))return ft.grep(t,function(t,n){var s=!!e.call(t,n,t);return s===i});if(e.nodeType)return ft.grep(t,function(t){return t===e===i});if("string"==typeof e){var n=ft.grep(t,function(t){return 1===t.nodeType});if(Xt.test(e))return ft.filter(e,n,!i);e=ft.filter(e,n)}return ft.grep(t,function(t){return ft.inArray(t,e)>=0===i})}function v(t){var e=Yt.split("|"),i=t.createDocumentFragment();if(i.createElement)for(;e.length;)i.createElement(e.pop());return i}function y(t,e){return t.getElementsByTagName(e)[0]||t.appendChild(t.ownerDocument.createElement(e))}function b(t){var e=t.getAttributeNode("type");return t.type=(e&&e.specified)+"/"+t.type,t}function w(t){var e=ue.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function _(t,e){for(var i,n=0;null!=(i=t[n]);n++)ft._data(i,"globalEval",!e||ft._data(e[n],"globalEval"))}function x(t,e){if(1===e.nodeType&&ft.hasData(t)){var i,n,s,r=ft._data(t),o=ft._data(e,r),a=r.events;if(a){delete o.handle,o.events={};for(i in a)for(n=0,s=a[i].length;s>n;n++)ft.event.add(e,i,a[i][n])}o.data&&(o.data=ft.extend({},o.data))}}function k(t,e){var i,n,s;if(1===e.nodeType){if(i=e.nodeName.toLowerCase(),!ft.support.noCloneEvent&&e[ft.expando]){s=ft._data(e);for(n in s.events)ft.removeEvent(e,n,s.handle);e.removeAttribute(ft.expando)}"script"===i&&e.text!==t.text?(b(e).text=t.text,w(e)):"object"===i?(e.parentNode&&(e.outerHTML=t.outerHTML),ft.support.html5Clone&&t.innerHTML&&!ft.trim(e.innerHTML)&&(e.innerHTML=t.innerHTML)):"input"===i&&oe.test(t.type)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===i?e.defaultSelected=e.selected=t.defaultSelected:("input"===i||"textarea"===i)&&(e.defaultValue=t.defaultValue)}}function S(t,e){var i,n,s=0,r=typeof t.getElementsByTagName!==Q?t.getElementsByTagName(e||"*"):typeof t.querySelectorAll!==Q?t.querySelectorAll(e||"*"):o;if(!r)for(r=[],i=t.childNodes||t;null!=(n=i[s]);s++)!e||ft.nodeName(n,e)?r.push(n):ft.merge(r,S(n,e));return e===o||e&&ft.nodeName(t,e)?ft.merge([t],r):r}function T(t){oe.test(t.type)&&(t.defaultChecked=t.checked)}function C(t,e){if(e in t)return e;for(var i=e.charAt(0).toUpperCase()+e.slice(1),n=e,s=$e.length;s--;)if(e=$e[s]+i,e in t)return e;return n}function E(t,e){return t=e||t,"none"===ft.css(t,"display")||!ft.contains(t.ownerDocument,t)}function A(t,e){for(var i,n,s,r=[],o=0,a=t.length;a>o;o++)n=t[o],n.style&&(r[o]=ft._data(n,"olddisplay"),i=n.style.display,e?(r[o]||"none"!==i||(n.style.display=""),""===n.style.display&&E(n)&&(r[o]=ft._data(n,"olddisplay",D(n.nodeName)))):r[o]||(s=E(n),(i&&"none"!==i||!s)&&ft._data(n,"olddisplay",s?i:ft.css(n,"display"))));for(o=0;a>o;o++)n=t[o],n.style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?r[o]||"":"none"));return t}function $(t,e,i){var n=xe.exec(e);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):e}function N(t,e,i,n,s){for(var r=i===(n?"border":"content")?4:"width"===e?1:0,o=0;4>r;r+=2)"margin"===i&&(o+=ft.css(t,i+Ae[r],!0,s)),n?("content"===i&&(o-=ft.css(t,"padding"+Ae[r],!0,s)),"margin"!==i&&(o-=ft.css(t,"border"+Ae[r]+"Width",!0,s))):(o+=ft.css(t,"padding"+Ae[r],!0,s),"padding"!==i&&(o+=ft.css(t,"border"+Ae[r]+"Width",!0,s)));return o}function L(t,e,i){var n=!0,s="width"===e?t.offsetWidth:t.offsetHeight,r=me(t),o=ft.support.boxSizing&&"border-box"===ft.css(t,"boxSizing",!1,r);if(0>=s||null==s){if(s=ge(t,e,r),(0>s||null==s)&&(s=t.style[e]),ke.test(s))return s;n=o&&(ft.support.boxSizingReliable||s===t.style[e]),s=parseFloat(s)||0}return s+N(t,e,i||(o?"border":"content"),n,r)+"px"}function D(t){var e=Z,i=Te[t];return i||(i=I(t,e),"none"!==i&&i||(pe=(pe||ft("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(e.documentElement),e=(pe[0].contentWindow||pe[0].contentDocument).document,e.write("<!doctype html><html><body>"),e.close(),i=I(t,e),pe.detach()),Te[t]=i),i}function I(t,e){var i=ft(e.createElement(t)).appendTo(e.body),n=ft.css(i[0],"display");return i.remove(),n}function R(t,e,i,n){var s;if(ft.isArray(e))ft.each(e,function(e,s){i||Le.test(t)?n(t,s):R(t+"["+("object"==typeof s?e:"")+"]",s,i,n)});else if(i||"object"!==ft.type(e))n(t,e);else for(s in e)R(t+"["+s+"]",e[s],i,n)}function P(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,s=0,r=e.toLowerCase().match(mt)||[];if(ft.isFunction(i))for(;n=r[s++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function M(t,e,i,n){function s(a){var l;return r[a]=!0,ft.each(t[a]||[],function(t,a){var u=a(e,i,n);return"string"!=typeof u||o||r[u]?o?!(l=u):void 0:(e.dataTypes.unshift(u),s(u),!1)}),l}var r={},o=t===Xe;return s(e.dataTypes[0])||!r["*"]&&s("*")}function O(t,e){var i,n,s=ft.ajaxSettings.flatOptions||{};for(n in e)e[n]!==o&&((s[n]?t:i||(i={}))[n]=e[n]);return i&&ft.extend(!0,t,i),t}function j(t,e,i){var n,s,r,a,l=t.contents,u=t.dataTypes,c=t.responseFields;for(a in c)a in i&&(e[c[a]]=i[a]);for(;"*"===u[0];)u.shift(),s===o&&(s=t.mimeType||e.getResponseHeader("Content-Type"));if(s)for(a in l)if(l[a]&&l[a].test(s)){u.unshift(a);break}if(u[0]in i)r=u[0];else{for(a in i){if(!u[0]||t.converters[a+" "+u[0]]){r=a;break}n||(n=a)}r=r||n}return r?(r!==u[0]&&u.unshift(r),i[r]):void 0}function F(t,e){var i,n,s,r,o={},a=0,l=t.dataTypes.slice(),u=l[0];if(t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l[1])for(s in t.converters)o[s.toLowerCase()]=t.converters[s];for(;n=l[++a];)if("*"!==n){if("*"!==u&&u!==n){if(s=o[u+" "+n]||o["* "+n],!s)for(i in o)if(r=i.split(" "),r[1]===n&&(s=o[u+" "+r[0]]||o["* "+r[0]])){s===!0?s=o[i]:o[i]!==!0&&(n=r[0],l.splice(a--,0,n));break}if(s!==!0)if(s&&t["throws"])e=s(e);else try{e=s(e)}catch(c){return{state:"parsererror",error:s?c:"No conversion from "+u+" to "+n}}}u=n}return{state:"success",data:e}}function q(){try{return new r.XMLHttpRequest}catch(t){}}function H(){try{return new r.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function B(){return setTimeout(function(){ni=o}),ni=ft.now()}function z(t,e){ft.each(e,function(e,i){for(var n=(ui[e]||[]).concat(ui["*"]),s=0,r=n.length;r>s;s++)if(n[s].call(t,e,i))return})}function U(t,e,i){var n,s,r=0,o=li.length,a=ft.Deferred().always(function(){delete l.elem}),l=function(){if(s)return!1;for(var e=ni||B(),i=Math.max(0,u.startTime+u.duration-e),n=i/u.duration||0,r=1-n,o=0,l=u.tweens.length;l>o;o++)u.tweens[o].run(r);return a.notifyWith(t,[u,r,i]),1>r&&l?i:(a.resolveWith(t,[u]),!1)},u=a.promise({elem:t,props:ft.extend({},e),opts:ft.extend(!0,{specialEasing:{}},i),originalProperties:e,originalOptions:i,startTime:ni||B(),duration:i.duration,tweens:[],createTween:function(e,i){var n=ft.Tween(t,u.opts,e,i,u.opts.specialEasing[e]||u.opts.easing);return u.tweens.push(n),n},stop:function(e){var i=0,n=e?u.tweens.length:0;if(s)return this;for(s=!0;n>i;i++)u.tweens[i].run(1);return e?a.resolveWith(t,[u,e]):a.rejectWith(t,[u,e]),this}}),c=u.props;for(W(c,u.opts.specialEasing);o>r;r++)if(n=li[r].call(u,t,c,u.opts))return n;return z(u,c),ft.isFunction(u.opts.start)&&u.opts.start.call(t,u),ft.fx.timer(ft.extend(l,{elem:t,anim:u,queue:u.opts.queue})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}function W(t,e){var i,n,s,r,o;for(s in t)if(n=ft.camelCase(s),r=e[n],i=t[s],ft.isArray(i)&&(r=i[1],i=t[s]=i[0]),s!==n&&(t[n]=i,delete t[s]),o=ft.cssHooks[n],o&&"expand"in o){i=o.expand(i),delete t[n];for(s in i)s in t||(t[s]=i[s],e[s]=r)}else e[n]=r}function V(t,e,i){var n,s,r,o,a,l,u,c,h,d=this,f=t.style,p={},m=[],g=t.nodeType&&E(t);i.queue||(c=ft._queueHooks(t,"fx"),null==c.unqueued&&(c.unqueued=0,h=c.empty.fire,c.empty.fire=function(){c.unqueued||h()}),c.unqueued++,d.always(function(){d.always(function(){c.unqueued--,ft.queue(t,"fx").length||c.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[f.overflow,f.overflowX,f.overflowY],"inline"===ft.css(t,"display")&&"none"===ft.css(t,"float")&&(ft.support.inlineBlockNeedsLayout&&"inline"!==D(t.nodeName)?f.zoom=1:f.display="inline-block")),i.overflow&&(f.overflow="hidden",ft.support.shrinkWrapBlocks||d.always(function(){f.overflow=i.overflow[0],f.overflowX=i.overflow[1],f.overflowY=i.overflow[2]}));for(s in e)if(o=e[s],ri.exec(o)){if(delete e[s],l=l||"toggle"===o,o===(g?"hide":"show"))continue;m.push(s)}if(r=m.length){a=ft._data(t,"fxshow")||ft._data(t,"fxshow",{}),"hidden"in a&&(g=a.hidden),l&&(a.hidden=!g),g?ft(t).show():d.done(function(){ft(t).hide()}),d.done(function(){var e;ft._removeData(t,"fxshow");for(e in p)ft.style(t,e,p[e])});for(s=0;r>s;s++)n=m[s],u=d.createTween(n,g?a[n]:0),p[n]=a[n]||ft.style(t,n),n in a||(a[n]=u.start,g&&(u.end=u.start,u.start="width"===n||"height"===n?1:0))}}function J(t,e,i,n,s){return new J.prototype.init(t,e,i,n,s)}function X(t,e){var i,n={height:t},s=0;for(e=e?1:0;4>s;s+=2-e)i=Ae[s],n["margin"+i]=n["padding"+i]=t;return e&&(n.opacity=n.width=t),n}function K(t){return ft.isWindow(t)?t:9===t.nodeType?t.defaultView||t.parentWindow:!1}var G,Y,Q=typeof o,Z=r.document,tt=r.location,et=r.jQuery,it=r.$,nt={},st=[],rt="1.9.1",ot=st.concat,at=st.push,lt=st.slice,ut=st.indexOf,ct=nt.toString,ht=nt.hasOwnProperty,dt=rt.trim,ft=function(t,e){return new ft.fn.init(t,e,Y)},pt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,mt=/\S+/g,gt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,vt=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,yt=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,bt=/^[\],:{}\s]*$/,wt=/(?:^|:|,)(?:\s*\[)+/g,_t=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,xt=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,kt=/^-ms-/,St=/-([\da-z])/gi,Tt=function(t,e){return e.toUpperCase()},Ct=function(t){(Z.addEventListener||"load"===t.type||"complete"===Z.readyState)&&(Et(),ft.ready())},Et=function(){Z.addEventListener?(Z.removeEventListener("DOMContentLoaded",Ct,!1),r.removeEventListener("load",Ct,!1)):(Z.detachEvent("onreadystatechange",Ct),r.detachEvent("onload",Ct))};ft.fn=ft.prototype={jquery:rt,constructor:ft,init:function(t,e,i){var n,s;if(!t)return this;if("string"==typeof t){if(n="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:vt.exec(t),!n||!n[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(n[1]){if(e=e instanceof ft?e[0]:e,ft.merge(this,ft.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:Z,!0)),yt.test(n[1])&&ft.isPlainObject(e))for(n in e)ft.isFunction(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}if(s=Z.getElementById(n[2]),s&&s.parentNode){if(s.id!==n[2])return i.find(t);this.length=1,this[0]=s}return this.context=Z,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):ft.isFunction(t)?i.ready(t):(t.selector!==o&&(this.selector=t.selector,this.context=t.context),ft.makeArray(t,this))},selector:"",length:0,size:function(){return this.length},toArray:function(){return lt.call(this)},get:function(t){return null==t?this.toArray():0>t?this[this.length+t]:this[t]},pushStack:function(t){var e=ft.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return ft.each(this,t,e)},ready:function(t){return ft.ready.promise().done(t),this},slice:function(){return this.pushStack(lt.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(0>t?e:0);return this.pushStack(i>=0&&e>i?[this[i]]:[])},map:function(t){return this.pushStack(ft.map(this,function(e,i){return t.call(e,i,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:at,sort:[].sort,splice:[].splice},ft.fn.init.prototype=ft.fn,ft.extend=ft.fn.extend=function(){var t,e,i,n,s,r,a=arguments[0]||{},l=1,u=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[1]||{},l=2),"object"==typeof a||ft.isFunction(a)||(a={}),u===l&&(a=this,--l);u>l;l++)if(null!=(s=arguments[l]))for(n in s)t=a[n],i=s[n],a!==i&&(c&&i&&(ft.isPlainObject(i)||(e=ft.isArray(i)))?(e?(e=!1,r=t&&ft.isArray(t)?t:[]):r=t&&ft.isPlainObject(t)?t:{},a[n]=ft.extend(c,r,i)):i!==o&&(a[n]=i));return a},ft.extend({noConflict:function(t){return r.$===ft&&(r.$=it),t&&r.jQuery===ft&&(r.jQuery=et),ft},isReady:!1,readyWait:1,holdReady:function(t){t?ft.readyWait++:ft.ready(!0)},ready:function(t){if(t===!0?!--ft.readyWait:!ft.isReady){if(!Z.body)return setTimeout(ft.ready);ft.isReady=!0,t!==!0&&--ft.readyWait>0||(G.resolveWith(Z,[ft]),ft.fn.trigger&&ft(Z).trigger("ready").off("ready"))}},isFunction:function(t){return"function"===ft.type(t)},isArray:Array.isArray||function(t){return"array"===ft.type(t)},isWindow:function(t){return null!=t&&t==t.window},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},type:function(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?nt[ct.call(t)]||"object":typeof t},isPlainObject:function(t){if(!t||"object"!==ft.type(t)||t.nodeType||ft.isWindow(t))return!1;try{if(t.constructor&&!ht.call(t,"constructor")&&!ht.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}var i;for(i in t);return i===o||ht.call(t,i)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},error:function(t){throw new Error(t)},parseHTML:function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||Z;var n=yt.exec(t),s=!i&&[];return n?[e.createElement(n[1])]:(n=ft.buildFragment([t],e,s),s&&ft(s).remove(),ft.merge([],n.childNodes))},parseJSON:function(t){return r.JSON&&r.JSON.parse?r.JSON.parse(t):null===t?t:"string"==typeof t&&(t=ft.trim(t),t&&bt.test(t.replace(_t,"@").replace(xt,"]").replace(wt,"")))?new Function("return "+t)():void ft.error("Invalid JSON: "+t)},parseXML:function(t){var e,i;if(!t||"string"!=typeof t)return null;try{r.DOMParser?(i=new DOMParser,e=i.parseFromString(t,"text/xml")):(e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(t))}catch(n){e=o}return e&&e.documentElement&&!e.getElementsByTagName("parsererror").length||ft.error("Invalid XML: "+t),e},noop:function(){},globalEval:function(t){t&&ft.trim(t)&&(r.execScript||function(t){r.eval.call(r,t)})(t)},camelCase:function(t){return t.replace(kt,"ms-").replace(St,Tt)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,i){var n,s=0,r=t.length,o=a(t);if(i){if(o)for(;r>s&&(n=e.apply(t[s],i),n!==!1);s++);else for(s in t)if(n=e.apply(t[s],i),n===!1)break}else if(o)for(;r>s&&(n=e.call(t[s],s,t[s]),n!==!1);s++);else for(s in t)if(n=e.call(t[s],s,t[s]),n===!1)break;return t},trim:dt&&!dt.call("\ufeffÂ ")?function(t){return null==t?"":dt.call(t)}:function(t){return null==t?"":(t+"").replace(gt,"")},makeArray:function(t,e){var i=e||[];return null!=t&&(a(Object(t))?ft.merge(i,"string"==typeof t?[t]:t):at.call(i,t)),i},inArray:function(t,e,i){var n;if(e){if(ut)return ut.call(e,t,i);for(n=e.length,i=i?0>i?Math.max(0,n+i):i:0;n>i;i++)if(i in e&&e[i]===t)return i}return-1},merge:function(t,e){var i=e.length,n=t.length,s=0;if("number"==typeof i)for(;i>s;s++)t[n++]=e[s];else for(;e[s]!==o;)t[n++]=e[s++];return t.length=n,t},grep:function(t,e,i){var n,s=[],r=0,o=t.length;for(i=!!i;o>r;r++)n=!!e(t[r],r),i!==n&&s.push(t[r]);return s},map:function(t,e,i){var n,s=0,r=t.length,o=a(t),l=[];if(o)for(;r>s;s++)n=e(t[s],s,i),null!=n&&(l[l.length]=n);else for(s in t)n=e(t[s],s,i),null!=n&&(l[l.length]=n);return ot.apply([],l)},guid:1,proxy:function(t,e){var i,n,s;return"string"==typeof e&&(s=t[e],e=t,t=s),ft.isFunction(t)?(i=lt.call(arguments,2),n=function(){return t.apply(e||this,i.concat(lt.call(arguments)))},n.guid=t.guid=t.guid||ft.guid++,n):o},access:function(t,e,i,n,s,r,a){var l=0,u=t.length,c=null==i;if("object"===ft.type(i)){s=!0;for(l in i)ft.access(t,e,l,i[l],!0,r,a)}else if(n!==o&&(s=!0,ft.isFunction(n)||(a=!0),c&&(a?(e.call(t,n),e=null):(c=e,e=function(t,e,i){return c.call(ft(t),i)})),e))for(;u>l;l++)e(t[l],i,a?n:n.call(t[l],l,e(t[l],i)));return s?t:c?e.call(t):u?e(t[0],i):r},now:function(){return(new Date).getTime()}}),ft.ready.promise=function(t){if(!G)if(G=ft.Deferred(),"complete"===Z.readyState)setTimeout(ft.ready);else if(Z.addEventListener)Z.addEventListener("DOMContentLoaded",Ct,!1),r.addEventListener("load",Ct,!1);else{Z.attachEvent("onreadystatechange",Ct),r.attachEvent("onload",Ct);var e=!1;try{e=null==r.frameElement&&Z.documentElement}catch(i){}e&&e.doScroll&&!function n(){if(!ft.isReady){try{e.doScroll("left")}catch(t){return setTimeout(n,50)}Et(),ft.ready()}}()}return G.promise(t)},ft.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){nt["[object "+e+"]"]=e.toLowerCase()}),Y=ft(Z);var At={};ft.Callbacks=function(t){t="string"==typeof t?At[t]||l(t):ft.extend({},t);var e,i,n,s,r,a,u=[],c=!t.once&&[],h=function(o){for(i=t.memory&&o,n=!0,r=a||0,a=0,s=u.length,e=!0;u&&s>r;r++)if(u[r].apply(o[0],o[1])===!1&&t.stopOnFalse){i=!1;break}e=!1,u&&(c?c.length&&h(c.shift()):i?u=[]:d.disable())},d={add:function(){if(u){var n=u.length;!function r(e){ft.each(e,function(e,i){var n=ft.type(i);"function"===n?t.unique&&d.has(i)||u.push(i):i&&i.length&&"string"!==n&&r(i)})}(arguments),e?s=u.length:i&&(a=n,h(i))}return this},remove:function(){return u&&ft.each(arguments,function(t,i){for(var n;(n=ft.inArray(i,u,n))>-1;)u.splice(n,1),e&&(s>=n&&s--,r>=n&&r--)}),this},has:function(t){return t?ft.inArray(t,u)>-1:!(!u||!u.length)},empty:function(){return u=[],this},disable:function(){return u=c=i=o,this},disabled:function(){return!u},lock:function(){return c=o,i||d.disable(),this},locked:function(){return!c},fireWith:function(t,i){return i=i||[],i=[t,i.slice?i.slice():i],!u||n&&!c||(e?c.push(i):h(i)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!n}};return d},ft.extend({Deferred:function(t){var e=[["resolve","done",ft.Callbacks("once memory"),"resolved"],["reject","fail",ft.Callbacks("once memory"),"rejected"],["notify","progress",ft.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var t=arguments;return ft.Deferred(function(i){ft.each(e,function(e,r){var o=r[0],a=ft.isFunction(t[e])&&t[e];s[r[1]](function(){var t=a&&a.apply(this,arguments);t&&ft.isFunction(t.promise)?t.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[o+"With"](this===n?i.promise():this,a?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?ft.extend(t,n):n}},s={};return n.pipe=n.then,ft.each(e,function(t,r){var o=r[2],a=r[3];n[r[1]]=o.add,a&&o.add(function(){i=a},e[1^t][2].disable,e[2][2].lock),s[r[0]]=function(){return s[r[0]+"With"](this===s?n:this,arguments),this},s[r[0]+"With"]=o.fireWith}),n.promise(s),t&&t.call(s,s),s},when:function(t){var e,i,n,s=0,r=lt.call(arguments),o=r.length,a=1!==o||t&&ft.isFunction(t.promise)?o:0,l=1===a?t:ft.Deferred(),u=function(t,i,n){return function(s){i[t]=this,n[t]=arguments.length>1?lt.call(arguments):s,n===e?l.notifyWith(i,n):--a||l.resolveWith(i,n)}};if(o>1)for(e=new Array(o),i=new Array(o),n=new Array(o);o>s;s++)r[s]&&ft.isFunction(r[s].promise)?r[s].promise().done(u(s,n,r)).fail(l.reject).progress(u(s,i,e)):--a;return a||l.resolveWith(n,r),l.promise()}}),ft.support=function(){var t,e,i,n,s,o,a,l,u,c,h=Z.createElement("div");if(h.setAttribute("className","t"),h.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=h.getElementsByTagName("*"),i=h.getElementsByTagName("a")[0],!e||!i||!e.length)return{};s=Z.createElement("select"),a=s.appendChild(Z.createElement("option")),n=h.getElementsByTagName("input")[0],i.style.cssText="top:1px;float:left;opacity:.5",t={getSetAttribute:"t"!==h.className,leadingWhitespace:3===h.firstChild.nodeType,tbody:!h.getElementsByTagName("tbody").length,htmlSerialize:!!h.getElementsByTagName("link").length,style:/top/.test(i.getAttribute("style")),hrefNormalized:"/a"===i.getAttribute("href"),opacity:/^0.5/.test(i.style.opacity),cssFloat:!!i.style.cssFloat,checkOn:!!n.value,optSelected:a.selected,enctype:!!Z.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==Z.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===Z.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},n.checked=!0,t.noCloneChecked=n.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!a.disabled;try{delete h.test}catch(d){t.deleteExpando=!1}n=Z.createElement("input"),n.setAttribute("value",""),t.input=""===n.getAttribute("value"),n.value="t",n.setAttribute("type","radio"),t.radioValue="t"===n.value,n.setAttribute("checked","t"),n.setAttribute("name","t"),o=Z.createDocumentFragment(),o.appendChild(n),t.appendChecked=n.checked,t.checkClone=o.cloneNode(!0).cloneNode(!0).lastChild.checked,h.attachEvent&&(h.attachEvent("onclick",function(){t.noCloneEvent=!1}),h.cloneNode(!0).click());for(c in{submit:!0,change:!0,focusin:!0})h.setAttribute(l="on"+c,"t"),t[c+"Bubbles"]=l in r||h.attributes[l].expando===!1;return h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===h.style.backgroundClip,ft(function(){var e,i,n,s="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",o=Z.getElementsByTagName("body")[0];o&&(e=Z.createElement("div"),e.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",o.appendChild(e).appendChild(h),h.innerHTML="<table><tr><td></td><td>t</td></tr></table>",n=h.getElementsByTagName("td"),n[0].style.cssText="padding:0;margin:0;border:0;display:none",u=0===n[0].offsetHeight,n[0].style.display="",n[1].style.display="none",t.reliableHiddenOffsets=u&&0===n[0].offsetHeight,h.innerHTML="",h.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=4===h.offsetWidth,t.doesNotIncludeMarginInBodyOffset=1!==o.offsetTop,r.getComputedStyle&&(t.pixelPosition="1%"!==(r.getComputedStyle(h,null)||{}).top,t.boxSizingReliable="4px"===(r.getComputedStyle(h,null)||{width:"4px"}).width,i=h.appendChild(Z.createElement("div")),i.style.cssText=h.style.cssText=s,i.style.marginRight=i.style.width="0",h.style.width="1px",t.reliableMarginRight=!parseFloat((r.getComputedStyle(i,null)||{}).marginRight)),typeof h.style.zoom!==Q&&(h.innerHTML="",h.style.cssText=s+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===h.offsetWidth,h.style.display="block",h.innerHTML="<div></div>",h.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==h.offsetWidth,t.inlineBlockNeedsLayout&&(o.style.zoom=1)),o.removeChild(e),e=h=n=i=null)}),e=s=o=a=i=n=null,t}();var $t=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Nt=/([A-Z])/g;ft.extend({cache:{},expando:"jQuery"+(rt+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(t){return t=t.nodeType?ft.cache[t[ft.expando]]:t[ft.expando],!!t&&!d(t)},data:function(t,e,i){return u(t,e,i)},removeData:function(t,e){return c(t,e)},_data:function(t,e,i){return u(t,e,i,!0)},_removeData:function(t,e){return c(t,e,!0)},acceptData:function(t){if(t.nodeType&&1!==t.nodeType&&9!==t.nodeType)return!1;var e=t.nodeName&&ft.noData[t.nodeName.toLowerCase()];return!e||e!==!0&&t.getAttribute("classid")===e}}),ft.fn.extend({data:function(t,e){var i,n,s=this[0],r=0,a=null;if(t===o){if(this.length&&(a=ft.data(s),1===s.nodeType&&!ft._data(s,"parsedAttrs"))){for(i=s.attributes;r<i.length;r++)n=i[r].name,n.indexOf("data-")||(n=ft.camelCase(n.slice(5)),h(s,n,a[n]));ft._data(s,"parsedAttrs",!0)}return a}return"object"==typeof t?this.each(function(){ft.data(this,t)}):ft.access(this,function(e){return e===o?s?h(s,t,ft.data(s,t)):null:void this.each(function(){ft.data(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){ft.removeData(this,t)})}}),ft.extend({queue:function(t,e,i){var n;return t?(e=(e||"fx")+"queue",n=ft._data(t,e),i&&(!n||ft.isArray(i)?n=ft._data(t,e,ft.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(t,e){e=e||"fx";var i=ft.queue(t,e),n=i.length,s=i.shift(),r=ft._queueHooks(t,e),o=function(){ft.dequeue(t,e)};"inprogress"===s&&(s=i.shift(),n--),r.cur=s,s&&("fx"===e&&i.unshift("inprogress"),delete r.stop,s.call(t,o,r)),!n&&r&&r.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return ft._data(t,i)||ft._data(t,i,{empty:ft.Callbacks("once memory").add(function(){ft._removeData(t,e+"queue"),ft._removeData(t,i)})})}}),ft.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?ft.queue(this[0],t):e===o?this:this.each(function(){var i=ft.queue(this,t,e);ft._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&ft.dequeue(this,t)})},dequeue:function(t){return this.each(function(){ft.dequeue(this,t)})},delay:function(t,e){return t=ft.fx?ft.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,i){var n=setTimeout(e,t);i.stop=function(){clearTimeout(n)}})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,s=ft.Deferred(),r=this,a=this.length,l=function(){--n||s.resolveWith(r,[r])};for("string"!=typeof t&&(e=t,t=o),t=t||"fx";a--;)i=ft._data(r[a],t+"queueHooks"),i&&i.empty&&(n++,i.empty.add(l));return l(),s.promise(e)}});var Lt,Dt,It=/[\t\r\n]/g,Rt=/\r/g,Pt=/^(?:input|select|textarea|button|object)$/i,Mt=/^(?:a|area)$/i,Ot=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,jt=/^(?:checked|selected)$/i,Ft=ft.support.getSetAttribute,qt=ft.support.input;ft.fn.extend({attr:function(t,e){return ft.access(this,ft.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){ft.removeAttr(this,t)})},prop:function(t,e){return ft.access(this,ft.prop,t,e,arguments.length>1);
},removeProp:function(t){return t=ft.propFix[t]||t,this.each(function(){try{this[t]=o,delete this[t]}catch(e){}})},addClass:function(t){var e,i,n,s,r,o=0,a=this.length,l="string"==typeof t&&t;if(ft.isFunction(t))return this.each(function(e){ft(this).addClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(mt)||[];a>o;o++)if(i=this[o],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(It," "):" ")){for(r=0;s=e[r++];)n.indexOf(" "+s+" ")<0&&(n+=s+" ");i.className=ft.trim(n)}return this},removeClass:function(t){var e,i,n,s,r,o=0,a=this.length,l=0===arguments.length||"string"==typeof t&&t;if(ft.isFunction(t))return this.each(function(e){ft(this).removeClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(mt)||[];a>o;o++)if(i=this[o],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(It," "):"")){for(r=0;s=e[r++];)for(;n.indexOf(" "+s+" ")>=0;)n=n.replace(" "+s+" "," ");i.className=t?ft.trim(n):""}return this},toggleClass:function(t,e){var i=typeof t,n="boolean"==typeof e;return ft.isFunction(t)?this.each(function(i){ft(this).toggleClass(t.call(this,i,this.className,e),e)}):this.each(function(){if("string"===i)for(var s,r=0,o=ft(this),a=e,l=t.match(mt)||[];s=l[r++];)a=n?a:!o.hasClass(s),o[a?"addClass":"removeClass"](s);else(i===Q||"boolean"===i)&&(this.className&&ft._data(this,"__className__",this.className),this.className=this.className||t===!1?"":ft._data(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(It," ").indexOf(e)>=0)return!0;return!1},val:function(t){var e,i,n,s=this[0];{if(arguments.length)return n=ft.isFunction(t),this.each(function(e){var s,r=ft(this);1===this.nodeType&&(s=n?t.call(this,e,r.val()):t,null==s?s="":"number"==typeof s?s+="":ft.isArray(s)&&(s=ft.map(s,function(t){return null==t?"":t+""})),i=ft.valHooks[this.type]||ft.valHooks[this.nodeName.toLowerCase()],i&&"set"in i&&i.set(this,s,"value")!==o||(this.value=s))});if(s)return i=ft.valHooks[s.type]||ft.valHooks[s.nodeName.toLowerCase()],i&&"get"in i&&(e=i.get(s,"value"))!==o?e:(e=s.value,"string"==typeof e?e.replace(Rt,""):null==e?"":e)}}}),ft.extend({valHooks:{option:{get:function(t){var e=t.attributes.value;return!e||e.specified?t.value:t.text}},select:{get:function(t){for(var e,i,n=t.options,s=t.selectedIndex,r="select-one"===t.type||0>s,o=r?null:[],a=r?s+1:n.length,l=0>s?a:r?s:0;a>l;l++)if(i=n[l],!(!i.selected&&l!==s||(ft.support.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&ft.nodeName(i.parentNode,"optgroup"))){if(e=ft(i).val(),r)return e;o.push(e)}return o},set:function(t,e){var i=ft.makeArray(e);return ft(t).find("option").each(function(){this.selected=ft.inArray(ft(this).val(),i)>=0}),i.length||(t.selectedIndex=-1),i}}},attr:function(t,e,i){var n,s,r,a=t.nodeType;if(t&&3!==a&&8!==a&&2!==a)return typeof t.getAttribute===Q?ft.prop(t,e,i):(s=1!==a||!ft.isXMLDoc(t),s&&(e=e.toLowerCase(),n=ft.attrHooks[e]||(Ot.test(e)?Dt:Lt)),i===o?n&&s&&"get"in n&&null!==(r=n.get(t,e))?r:(typeof t.getAttribute!==Q&&(r=t.getAttribute(e)),null==r?o:r):null!==i?n&&s&&"set"in n&&(r=n.set(t,i,e))!==o?r:(t.setAttribute(e,i+""),i):void ft.removeAttr(t,e))},removeAttr:function(t,e){var i,n,s=0,r=e&&e.match(mt);if(r&&1===t.nodeType)for(;i=r[s++];)n=ft.propFix[i]||i,Ot.test(i)?!Ft&&jt.test(i)?t[ft.camelCase("default-"+i)]=t[n]=!1:t[n]=!1:ft.attr(t,i,""),t.removeAttribute(Ft?i:n)},attrHooks:{type:{set:function(t,e){if(!ft.support.radioValue&&"radio"===e&&ft.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(t,e,i){var n,s,r,a=t.nodeType;if(t&&3!==a&&8!==a&&2!==a)return r=1!==a||!ft.isXMLDoc(t),r&&(e=ft.propFix[e]||e,s=ft.propHooks[e]),i!==o?s&&"set"in s&&(n=s.set(t,i,e))!==o?n:t[e]=i:s&&"get"in s&&null!==(n=s.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=t.getAttributeNode("tabindex");return e&&e.specified?parseInt(e.value,10):Pt.test(t.nodeName)||Mt.test(t.nodeName)&&t.href?0:o}}}}),Dt={get:function(t,e){var i=ft.prop(t,e),n="boolean"==typeof i&&t.getAttribute(e),s="boolean"==typeof i?qt&&Ft?null!=n:jt.test(e)?t[ft.camelCase("default-"+e)]:!!n:t.getAttributeNode(e);return s&&s.value!==!1?e.toLowerCase():o},set:function(t,e,i){return e===!1?ft.removeAttr(t,i):qt&&Ft||!jt.test(i)?t.setAttribute(!Ft&&ft.propFix[i]||i,i):t[ft.camelCase("default-"+i)]=t[i]=!0,i}},qt&&Ft||(ft.attrHooks.value={get:function(t,e){var i=t.getAttributeNode(e);return ft.nodeName(t,"input")?t.defaultValue:i&&i.specified?i.value:o},set:function(t,e,i){return ft.nodeName(t,"input")?void(t.defaultValue=e):Lt&&Lt.set(t,e,i)}}),Ft||(Lt=ft.valHooks.button={get:function(t,e){var i=t.getAttributeNode(e);return i&&("id"===e||"name"===e||"coords"===e?""!==i.value:i.specified)?i.value:o},set:function(t,e,i){var n=t.getAttributeNode(i);return n||t.setAttributeNode(n=t.ownerDocument.createAttribute(i)),n.value=e+="","value"===i||e===t.getAttribute(i)?e:o}},ft.attrHooks.contenteditable={get:Lt.get,set:function(t,e,i){Lt.set(t,""===e?!1:e,i)}},ft.each(["width","height"],function(t,e){ft.attrHooks[e]=ft.extend(ft.attrHooks[e],{set:function(t,i){return""===i?(t.setAttribute(e,"auto"),i):void 0}})})),ft.support.hrefNormalized||(ft.each(["href","src","width","height"],function(t,e){ft.attrHooks[e]=ft.extend(ft.attrHooks[e],{get:function(t){var i=t.getAttribute(e,2);return null==i?o:i}})}),ft.each(["href","src"],function(t,e){ft.propHooks[e]={get:function(t){return t.getAttribute(e,4)}}})),ft.support.style||(ft.attrHooks.style={get:function(t){return t.style.cssText||o},set:function(t,e){return t.style.cssText=e+""}}),ft.support.optSelected||(ft.propHooks.selected=ft.extend(ft.propHooks.selected,{get:function(t){var e=t.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null}})),ft.support.enctype||(ft.propFix.enctype="encoding"),ft.support.checkOn||ft.each(["radio","checkbox"],function(){ft.valHooks[this]={get:function(t){return null===t.getAttribute("value")?"on":t.value}}}),ft.each(["radio","checkbox"],function(){ft.valHooks[this]=ft.extend(ft.valHooks[this],{set:function(t,e){return ft.isArray(e)?t.checked=ft.inArray(ft(t).val(),e)>=0:void 0}})});var Ht=/^(?:input|select|textarea)$/i,Bt=/^key/,zt=/^(?:mouse|contextmenu)|click/,Ut=/^(?:focusinfocus|focusoutblur)$/,Wt=/^([^.]*)(?:\.(.+)|)$/;ft.event={global:{},add:function(t,e,i,n,s){var r,a,l,u,c,h,d,f,p,m,g,v=ft._data(t);if(v){for(i.handler&&(u=i,i=u.handler,s=u.selector),i.guid||(i.guid=ft.guid++),(a=v.events)||(a=v.events={}),(h=v.handle)||(h=v.handle=function(t){return typeof ft===Q||t&&ft.event.triggered===t.type?o:ft.event.dispatch.apply(h.elem,arguments)},h.elem=t),e=(e||"").match(mt)||[""],l=e.length;l--;)r=Wt.exec(e[l])||[],p=g=r[1],m=(r[2]||"").split(".").sort(),c=ft.event.special[p]||{},p=(s?c.delegateType:c.bindType)||p,c=ft.event.special[p]||{},d=ft.extend({type:p,origType:g,data:n,handler:i,guid:i.guid,selector:s,needsContext:s&&ft.expr.match.needsContext.test(s),namespace:m.join(".")},u),(f=a[p])||(f=a[p]=[],f.delegateCount=0,c.setup&&c.setup.call(t,n,m,h)!==!1||(t.addEventListener?t.addEventListener(p,h,!1):t.attachEvent&&t.attachEvent("on"+p,h))),c.add&&(c.add.call(t,d),d.handler.guid||(d.handler.guid=i.guid)),s?f.splice(f.delegateCount++,0,d):f.push(d),ft.event.global[p]=!0;t=null}},remove:function(t,e,i,n,s){var r,o,a,l,u,c,h,d,f,p,m,g=ft.hasData(t)&&ft._data(t);if(g&&(c=g.events)){for(e=(e||"").match(mt)||[""],u=e.length;u--;)if(a=Wt.exec(e[u])||[],f=m=a[1],p=(a[2]||"").split(".").sort(),f){for(h=ft.event.special[f]||{},f=(n?h.delegateType:h.bindType)||f,d=c[f]||[],a=a[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=r=d.length;r--;)o=d[r],!s&&m!==o.origType||i&&i.guid!==o.guid||a&&!a.test(o.namespace)||n&&n!==o.selector&&("**"!==n||!o.selector)||(d.splice(r,1),o.selector&&d.delegateCount--,h.remove&&h.remove.call(t,o));l&&!d.length&&(h.teardown&&h.teardown.call(t,p,g.handle)!==!1||ft.removeEvent(t,f,g.handle),delete c[f])}else for(f in c)ft.event.remove(t,f+e[u],i,n,!0);ft.isEmptyObject(c)&&(delete g.handle,ft._removeData(t,"events"))}},trigger:function(t,e,i,n){var s,a,l,u,c,h,d,f=[i||Z],p=ht.call(t,"type")?t.type:t,m=ht.call(t,"namespace")?t.namespace.split("."):[];if(l=h=i=i||Z,3!==i.nodeType&&8!==i.nodeType&&!Ut.test(p+ft.event.triggered)&&(p.indexOf(".")>=0&&(m=p.split("."),p=m.shift(),m.sort()),a=p.indexOf(":")<0&&"on"+p,t=t[ft.expando]?t:new ft.Event(p,"object"==typeof t&&t),t.isTrigger=!0,t.namespace=m.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=o,t.target||(t.target=i),e=null==e?[t]:ft.makeArray(e,[t]),c=ft.event.special[p]||{},n||!c.trigger||c.trigger.apply(i,e)!==!1)){if(!n&&!c.noBubble&&!ft.isWindow(i)){for(u=c.delegateType||p,Ut.test(u+p)||(l=l.parentNode);l;l=l.parentNode)f.push(l),h=l;h===(i.ownerDocument||Z)&&f.push(h.defaultView||h.parentWindow||r)}for(d=0;(l=f[d++])&&!t.isPropagationStopped();)t.type=d>1?u:c.bindType||p,s=(ft._data(l,"events")||{})[t.type]&&ft._data(l,"handle"),s&&s.apply(l,e),s=a&&l[a],s&&ft.acceptData(l)&&s.apply&&s.apply(l,e)===!1&&t.preventDefault();if(t.type=p,!(n||t.isDefaultPrevented()||c._default&&c._default.apply(i.ownerDocument,e)!==!1||"click"===p&&ft.nodeName(i,"a")||!ft.acceptData(i)||!a||!i[p]||ft.isWindow(i))){h=i[a],h&&(i[a]=null),ft.event.triggered=p;try{i[p]()}catch(g){}ft.event.triggered=o,h&&(i[a]=h)}return t.result}},dispatch:function(t){t=ft.event.fix(t);var e,i,n,s,r,a=[],l=lt.call(arguments),u=(ft._data(this,"events")||{})[t.type]||[],c=ft.event.special[t.type]||{};if(l[0]=t,t.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,t)!==!1){for(a=ft.event.handlers.call(this,t,u),e=0;(s=a[e++])&&!t.isPropagationStopped();)for(t.currentTarget=s.elem,r=0;(n=s.handlers[r++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(n.namespace))&&(t.handleObj=n,t.data=n.data,i=((ft.event.special[n.origType]||{}).handle||n.handler).apply(s.elem,l),i!==o&&(t.result=i)===!1&&(t.preventDefault(),t.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,t),t.result}},handlers:function(t,e){var i,n,s,r,a=[],l=e.delegateCount,u=t.target;if(l&&u.nodeType&&(!t.button||"click"!==t.type))for(;u!=this;u=u.parentNode||this)if(1===u.nodeType&&(u.disabled!==!0||"click"!==t.type)){for(s=[],r=0;l>r;r++)n=e[r],i=n.selector+" ",s[i]===o&&(s[i]=n.needsContext?ft(i,this).index(u)>=0:ft.find(i,this,null,[u]).length),s[i]&&s.push(n);s.length&&a.push({elem:u,handlers:s})}return l<e.length&&a.push({elem:this,handlers:e.slice(l)}),a},fix:function(t){if(t[ft.expando])return t;var e,i,n,s=t.type,r=t,o=this.fixHooks[s];for(o||(this.fixHooks[s]=o=zt.test(s)?this.mouseHooks:Bt.test(s)?this.keyHooks:{}),n=o.props?this.props.concat(o.props):this.props,t=new ft.Event(r),e=n.length;e--;)i=n[e],t[i]=r[i];return t.target||(t.target=r.srcElement||Z),3===t.target.nodeType&&(t.target=t.target.parentNode),t.metaKey=!!t.metaKey,o.filter?o.filter(t,r):t},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var i,n,s,r=e.button,a=e.fromElement;return null==t.pageX&&null!=e.clientX&&(n=t.target.ownerDocument||Z,s=n.documentElement,i=n.body,t.pageX=e.clientX+(s&&s.scrollLeft||i&&i.scrollLeft||0)-(s&&s.clientLeft||i&&i.clientLeft||0),t.pageY=e.clientY+(s&&s.scrollTop||i&&i.scrollTop||0)-(s&&s.clientTop||i&&i.clientTop||0)),!t.relatedTarget&&a&&(t.relatedTarget=a===t.target?e.toElement:a),t.which||r===o||(t.which=1&r?1:2&r?3:4&r?2:0),t}},special:{load:{noBubble:!0},click:{trigger:function(){return ft.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0}},focus:{trigger:function(){if(this!==Z.activeElement&&this.focus)try{return this.focus(),!1}catch(t){}},delegateType:"focusin"},blur:{trigger:function(){return this===Z.activeElement&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},beforeunload:{postDispatch:function(t){t.result!==o&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,i,n){var s=ft.extend(new ft.Event,i,{type:t,isSimulated:!0,originalEvent:{}});n?ft.event.trigger(s,null,e):ft.event.dispatch.call(e,s),s.isDefaultPrevented()&&i.preventDefault()}},ft.removeEvent=Z.removeEventListener?function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i,!1)}:function(t,e,i){var n="on"+e;t.detachEvent&&(typeof t[n]===Q&&(t[n]=null),t.detachEvent(n,i))},ft.Event=function(t,e){return this instanceof ft.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||t.returnValue===!1||t.getPreventDefault&&t.getPreventDefault()?f:p):this.type=t,e&&ft.extend(this,e),this.timeStamp=t&&t.timeStamp||ft.now(),void(this[ft.expando]=!0)):new ft.Event(t,e)},ft.Event.prototype={isDefaultPrevented:p,isPropagationStopped:p,isImmediatePropagationStopped:p,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=f,t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=f,t&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=f,this.stopPropagation()}},ft.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(t,e){ft.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,s=t.relatedTarget,r=t.handleObj;return(!s||s!==n&&!ft.contains(n,s))&&(t.type=r.origType,i=r.handler.apply(this,arguments),t.type=e),i}}}),ft.support.submitBubbles||(ft.event.special.submit={setup:function(){return ft.nodeName(this,"form")?!1:void ft.event.add(this,"click._submit keypress._submit",function(t){var e=t.target,i=ft.nodeName(e,"input")||ft.nodeName(e,"button")?e.form:o;i&&!ft._data(i,"submitBubbles")&&(ft.event.add(i,"submit._submit",function(t){t._submit_bubble=!0}),ft._data(i,"submitBubbles",!0))})},postDispatch:function(t){t._submit_bubble&&(delete t._submit_bubble,this.parentNode&&!t.isTrigger&&ft.event.simulate("submit",this.parentNode,t,!0))},teardown:function(){return ft.nodeName(this,"form")?!1:void ft.event.remove(this,"._submit")}}),ft.support.changeBubbles||(ft.event.special.change={setup:function(){return Ht.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(ft.event.add(this,"propertychange._change",function(t){"checked"===t.originalEvent.propertyName&&(this._just_changed=!0)}),ft.event.add(this,"click._change",function(t){this._just_changed&&!t.isTrigger&&(this._just_changed=!1),ft.event.simulate("change",this,t,!0)})),!1):void ft.event.add(this,"beforeactivate._change",function(t){var e=t.target;Ht.test(e.nodeName)&&!ft._data(e,"changeBubbles")&&(ft.event.add(e,"change._change",function(t){!this.parentNode||t.isSimulated||t.isTrigger||ft.event.simulate("change",this.parentNode,t,!0)}),ft._data(e,"changeBubbles",!0))})},handle:function(t){var e=t.target;return this!==e||t.isSimulated||t.isTrigger||"radio"!==e.type&&"checkbox"!==e.type?t.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return ft.event.remove(this,"._change"),!Ht.test(this.nodeName)}}),ft.support.focusinBubbles||ft.each({focus:"focusin",blur:"focusout"},function(t,e){var i=0,n=function(t){ft.event.simulate(e,t.target,ft.event.fix(t),!0)};ft.event.special[e]={setup:function(){0===i++&&Z.addEventListener(t,n,!0)},teardown:function(){0===--i&&Z.removeEventListener(t,n,!0)}}}),ft.fn.extend({on:function(t,e,i,n,s){var r,a;if("object"==typeof t){"string"!=typeof e&&(i=i||e,e=o);for(r in t)this.on(r,e,i,t[r],s);return this}if(null==i&&null==n?(n=e,i=e=o):null==n&&("string"==typeof e?(n=i,i=o):(n=i,i=e,e=o)),n===!1)n=p;else if(!n)return this;return 1===s&&(a=n,n=function(t){return ft().off(t),a.apply(this,arguments)},n.guid=a.guid||(a.guid=ft.guid++)),this.each(function(){ft.event.add(this,t,n,i,e)})},one:function(t,e,i,n){return this.on(t,e,i,n,1)},off:function(t,e,i){var n,s;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,ft(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(s in t)this.off(s,e,t[s]);return this}return(e===!1||"function"==typeof e)&&(i=e,e=o),i===!1&&(i=p),this.each(function(){ft.event.remove(this,t,i,e)})},bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)},trigger:function(t,e){return this.each(function(){ft.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];return i?ft.event.trigger(t,e,i,!0):void 0}}),function(t,e){function i(t){return pt.test(t+"")}function n(){var t,e=[];return t=function(i,n){return e.push(i+=" ")>S.cacheLength&&delete t[e.shift()],t[i]=n}}function s(t){return t[F]=!0,t}function r(t){var e=L.createElement("div");try{return t(e)}catch(i){return!1}finally{e=null}}function o(t,e,i,n){var s,r,o,a,l,u,c,f,p,m;if((e?e.ownerDocument||e:q)!==L&&N(e),e=e||L,i=i||[],!t||"string"!=typeof t)return i;if(1!==(a=e.nodeType)&&9!==a)return[];if(!I&&!n){if(s=mt.exec(t))if(o=s[1]){if(9===a){if(r=e.getElementById(o),!r||!r.parentNode)return i;if(r.id===o)return i.push(r),i}else if(e.ownerDocument&&(r=e.ownerDocument.getElementById(o))&&O(e,r)&&r.id===o)return i.push(r),i}else{if(s[2])return Y.apply(i,Q.call(e.getElementsByTagName(t),0)),i;if((o=s[3])&&H.getByClassName&&e.getElementsByClassName)return Y.apply(i,Q.call(e.getElementsByClassName(o),0)),i}if(H.qsa&&!R.test(t)){if(c=!0,f=F,p=e,m=9===a&&t,1===a&&"object"!==e.nodeName.toLowerCase()){for(u=h(t),(c=e.getAttribute("id"))?f=c.replace(yt,"\\$&"):e.setAttribute("id",f),f="[id='"+f+"'] ",l=u.length;l--;)u[l]=f+d(u[l]);p=dt.test(t)&&e.parentNode||e,m=u.join(",")}if(m)try{return Y.apply(i,Q.call(p.querySelectorAll(m),0)),i}catch(g){}finally{c||e.removeAttribute("id")}}}return w(t.replace(ot,"$1"),e,i,n)}function a(t,e){var i=e&&t,n=i&&(~e.sourceIndex||X)-(~t.sourceIndex||X);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function l(t){return function(e){var i=e.nodeName.toLowerCase();return"input"===i&&e.type===t}}function u(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function c(t){return s(function(e){return e=+e,s(function(i,n){for(var s,r=t([],i.length,e),o=r.length;o--;)i[s=r[o]]&&(i[s]=!(n[s]=i[s]))})})}function h(t,e){var i,n,s,r,a,l,u,c=W[t+" "];if(c)return e?0:c.slice(0);for(a=t,l=[],u=S.preFilter;a;){(!i||(n=at.exec(a)))&&(n&&(a=a.slice(n[0].length)||a),l.push(s=[])),i=!1,(n=lt.exec(a))&&(i=n.shift(),s.push({value:i,type:n[0].replace(ot," ")}),a=a.slice(i.length));for(r in S.filter)!(n=ht[r].exec(a))||u[r]&&!(n=u[r](n))||(i=n.shift(),s.push({value:i,type:r,matches:n}),a=a.slice(i.length));if(!i)break}return e?a.length:a?o.error(t):W(t,l).slice(0)}function d(t){for(var e=0,i=t.length,n="";i>e;e++)n+=t[e].value;return n}function f(t,e,i){var n=e.dir,s=i&&"parentNode"===n,r=z++;return e.first?function(e,i,r){for(;e=e[n];)if(1===e.nodeType||s)return t(e,i,r)}:function(e,i,o){var a,l,u,c=B+" "+r;if(o){for(;e=e[n];)if((1===e.nodeType||s)&&t(e,i,o))return!0}else for(;e=e[n];)if(1===e.nodeType||s)if(u=e[F]||(e[F]={}),(l=u[n])&&l[0]===c){if((a=l[1])===!0||a===k)return a===!0}else if(l=u[n]=[c],l[1]=t(e,i,o)||k,l[1]===!0)return!0}}function p(t){return t.length>1?function(e,i,n){for(var s=t.length;s--;)if(!t[s](e,i,n))return!1;return!0}:t[0]}function m(t,e,i,n,s){for(var r,o=[],a=0,l=t.length,u=null!=e;l>a;a++)(r=t[a])&&(!i||i(r,n,s))&&(o.push(r),u&&e.push(a));return o}function g(t,e,i,n,r,o){return n&&!n[F]&&(n=g(n)),r&&!r[F]&&(r=g(r,o)),s(function(s,o,a,l){var u,c,h,d=[],f=[],p=o.length,g=s||b(e||"*",a.nodeType?[a]:a,[]),v=!t||!s&&e?g:m(g,d,t,a,l),y=i?r||(s?t:p||n)?[]:o:v;if(i&&i(v,y,a,l),n)for(u=m(y,f),n(u,[],a,l),c=u.length;c--;)(h=u[c])&&(y[f[c]]=!(v[f[c]]=h));if(s){if(r||t){if(r){for(u=[],c=y.length;c--;)(h=y[c])&&u.push(v[c]=h);r(null,y=[],u,l)}for(c=y.length;c--;)(h=y[c])&&(u=r?Z.call(s,h):d[c])>-1&&(s[u]=!(o[u]=h))}}else y=m(y===o?y.splice(p,y.length):y),r?r(null,o,y,l):Y.apply(o,y)})}function v(t){for(var e,i,n,s=t.length,r=S.relative[t[0].type],o=r||S.relative[" "],a=r?1:0,l=f(function(t){return t===e},o,!0),u=f(function(t){return Z.call(e,t)>-1},o,!0),c=[function(t,i,n){return!r&&(n||i!==$)||((e=i).nodeType?l(t,i,n):u(t,i,n))}];s>a;a++)if(i=S.relative[t[a].type])c=[f(p(c),i)];else{if(i=S.filter[t[a].type].apply(null,t[a].matches),i[F]){for(n=++a;s>n&&!S.relative[t[n].type];n++);return g(a>1&&p(c),a>1&&d(t.slice(0,a-1)).replace(ot,"$1"),i,n>a&&v(t.slice(a,n)),s>n&&v(t=t.slice(n)),s>n&&d(t))}c.push(i)}return p(c)}function y(t,e){var i=0,n=e.length>0,r=t.length>0,a=function(s,a,l,u,c){var h,d,f,p=[],g=0,v="0",y=s&&[],b=null!=c,w=$,_=s||r&&S.find.TAG("*",c&&a.parentNode||a),x=B+=null==w?1:Math.random()||.1;for(b&&($=a!==L&&a,k=i);null!=(h=_[v]);v++){if(r&&h){for(d=0;f=t[d++];)if(f(h,a,l)){u.push(h);break}b&&(B=x,k=++i)}n&&((h=!f&&h)&&g--,s&&y.push(h))}if(g+=v,n&&v!==g){for(d=0;f=e[d++];)f(y,p,a,l);if(s){if(g>0)for(;v--;)y[v]||p[v]||(p[v]=G.call(u));p=m(p)}Y.apply(u,p),b&&!s&&p.length>0&&g+e.length>1&&o.uniqueSort(u)}return b&&(B=x,$=w),y};return n?s(a):a}function b(t,e,i){for(var n=0,s=e.length;s>n;n++)o(t,e[n],i);return i}function w(t,e,i,n){var s,r,o,a,l,u=h(t);if(!n&&1===u.length){if(r=u[0]=u[0].slice(0),r.length>2&&"ID"===(o=r[0]).type&&9===e.nodeType&&!I&&S.relative[r[1].type]){if(e=S.find.ID(o.matches[0].replace(wt,_t),e)[0],!e)return i;t=t.slice(r.shift().value.length)}for(s=ht.needsContext.test(t)?0:r.length;s--&&(o=r[s],!S.relative[a=o.type]);)if((l=S.find[a])&&(n=l(o.matches[0].replace(wt,_t),dt.test(r[0].type)&&e.parentNode||e))){if(r.splice(s,1),t=n.length&&d(r),!t)return Y.apply(i,Q.call(n,0)),i;break}}return E(t,u)(n,e,I,i,dt.test(t)),i}function _(){}var x,k,S,T,C,E,A,$,N,L,D,I,R,P,M,O,j,F="sizzle"+-new Date,q=t.document,H={},B=0,z=0,U=n(),W=n(),V=n(),J=typeof e,X=1<<31,K=[],G=K.pop,Y=K.push,Q=K.slice,Z=K.indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(this[e]===t)return e;return-1},tt="[\\x20\\t\\r\\n\\f]",et="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",it=et.replace("w","w#"),nt="([*^$|!~]?=)",st="\\["+tt+"*("+et+")"+tt+"*(?:"+nt+tt+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+it+")|)|)"+tt+"*\\]",rt=":("+et+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+st.replace(3,8)+")*)|.*)\\)|)",ot=new RegExp("^"+tt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+tt+"+$","g"),at=new RegExp("^"+tt+"*,"+tt+"*"),lt=new RegExp("^"+tt+"*([\\x20\\t\\r\\n\\f>+~])"+tt+"*"),ut=new RegExp(rt),ct=new RegExp("^"+it+"$"),ht={ID:new RegExp("^#("+et+")"),CLASS:new RegExp("^\\.("+et+")"),NAME:new RegExp("^\\[name=['\"]?("+et+")['\"]?\\]"),TAG:new RegExp("^("+et.replace("w","w*")+")"),ATTR:new RegExp("^"+st),PSEUDO:new RegExp("^"+rt),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+tt+"*(even|odd|(([+-]|)(\\d*)n|)"+tt+"*(?:([+-]|)"+tt+"*(\\d+)|))"+tt+"*\\)|)","i"),needsContext:new RegExp("^"+tt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+tt+"*((?:-\\d)?\\d*)"+tt+"*\\)|)(?=[^-]|$)","i")},dt=/[\x20\t\r\n\f]*[+~]/,pt=/^[^{]+\{\s*\[native code/,mt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,gt=/^(?:input|select|textarea|button)$/i,vt=/^h\d$/i,yt=/'|\\/g,bt=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,wt=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,_t=function(t,e){var i="0x"+e-65536;return i!==i?e:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)};try{Q.call(q.documentElement.childNodes,0)[0].nodeType}catch(xt){Q=function(t){for(var e,i=[];e=this[t++];)i.push(e);return i}}C=o.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return e?"HTML"!==e.nodeName:!1},N=o.setDocument=function(t){var n=t?t.ownerDocument||t:q;return n!==L&&9===n.nodeType&&n.documentElement?(L=n,D=n.documentElement,I=C(n),H.tagNameNoComments=r(function(t){return t.appendChild(n.createComment("")),!t.getElementsByTagName("*").length}),H.attributes=r(function(t){t.innerHTML="<select></select>";var e=typeof t.lastChild.getAttribute("multiple");return"boolean"!==e&&"string"!==e}),H.getByClassName=r(function(t){return t.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",t.getElementsByClassName&&t.getElementsByClassName("e").length?(t.lastChild.className="e",2===t.getElementsByClassName("e").length):!1}),H.getByName=r(function(t){t.id=F+0,t.innerHTML="<a name='"+F+"'></a><div name='"+F+"'></div>",D.insertBefore(t,D.firstChild);var e=n.getElementsByName&&n.getElementsByName(F).length===2+n.getElementsByName(F+0).length;return H.getIdNotName=!n.getElementById(F),D.removeChild(t),e}),S.attrHandle=r(function(t){return t.innerHTML="<a href='#'></a>",t.firstChild&&typeof t.firstChild.getAttribute!==J&&"#"===t.firstChild.getAttribute("href")})?{}:{href:function(t){return t.getAttribute("href",2)},type:function(t){return t.getAttribute("type")}},H.getIdNotName?(S.find.ID=function(t,e){if(typeof e.getElementById!==J&&!I){var i=e.getElementById(t);return i&&i.parentNode?[i]:[]}},S.filter.ID=function(t){var e=t.replace(wt,_t);return function(t){return t.getAttribute("id")===e}}):(S.find.ID=function(t,i){if(typeof i.getElementById!==J&&!I){var n=i.getElementById(t);return n?n.id===t||typeof n.getAttributeNode!==J&&n.getAttributeNode("id").value===t?[n]:e:[]}},S.filter.ID=function(t){var e=t.replace(wt,_t);return function(t){var i=typeof t.getAttributeNode!==J&&t.getAttributeNode("id");return i&&i.value===e}}),S.find.TAG=H.tagNameNoComments?function(t,e){return typeof e.getElementsByTagName!==J?e.getElementsByTagName(t):void 0}:function(t,e){var i,n=[],s=0,r=e.getElementsByTagName(t);if("*"===t){for(;i=r[s++];)1===i.nodeType&&n.push(i);return n}return r},S.find.NAME=H.getByName&&function(t,e){return typeof e.getElementsByName!==J?e.getElementsByName(name):void 0},S.find.CLASS=H.getByClassName&&function(t,e){return typeof e.getElementsByClassName===J||I?void 0:e.getElementsByClassName(t)},P=[],R=[":focus"],(H.qsa=i(n.querySelectorAll))&&(r(function(t){t.innerHTML="<select><option selected=''></option></select>",t.querySelectorAll("[selected]").length||R.push("\\["+tt+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),t.querySelectorAll(":checked").length||R.push(":checked")}),r(function(t){t.innerHTML="<input type='hidden' i=''/>",t.querySelectorAll("[i^='']").length&&R.push("[*^$]="+tt+"*(?:\"\"|'')"),t.querySelectorAll(":enabled").length||R.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),R.push(",.*:")})),(H.matchesSelector=i(M=D.matchesSelector||D.mozMatchesSelector||D.webkitMatchesSelector||D.oMatchesSelector||D.msMatchesSelector))&&r(function(t){H.disconnectedMatch=M.call(t,"div"),M.call(t,"[s!='']:x"),P.push("!=",rt)}),R=new RegExp(R.join("|")),P=new RegExp(P.join("|")),O=i(D.contains)||D.compareDocumentPosition?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},j=D.compareDocumentPosition?function(t,e){var i;return t===e?(A=!0,0):(i=e.compareDocumentPosition&&t.compareDocumentPosition&&t.compareDocumentPosition(e))?1&i||t.parentNode&&11===t.parentNode.nodeType?t===n||O(q,t)?-1:e===n||O(q,e)?1:0:4&i?-1:1:t.compareDocumentPosition?-1:1}:function(t,e){var i,s=0,r=t.parentNode,o=e.parentNode,l=[t],u=[e];if(t===e)return A=!0,0;if(!r||!o)return t===n?-1:e===n?1:r?-1:o?1:0;if(r===o)return a(t,e);for(i=t;i=i.parentNode;)l.unshift(i);for(i=e;i=i.parentNode;)u.unshift(i);for(;l[s]===u[s];)s++;return s?a(l[s],u[s]):l[s]===q?-1:u[s]===q?1:0},A=!1,[0,0].sort(j),H.detectDuplicates=A,L):L},o.matches=function(t,e){return o(t,null,null,e)},o.matchesSelector=function(t,e){if((t.ownerDocument||t)!==L&&N(t),e=e.replace(bt,"='$1']"),!(!H.matchesSelector||I||P&&P.test(e)||R.test(e)))try{var i=M.call(t,e);if(i||H.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(n){}return o(e,L,null,[t]).length>0},o.contains=function(t,e){return(t.ownerDocument||t)!==L&&N(t),O(t,e)},o.attr=function(t,e){var i;return(t.ownerDocument||t)!==L&&N(t),I||(e=e.toLowerCase()),(i=S.attrHandle[e])?i(t):I||H.attributes?t.getAttribute(e):((i=t.getAttributeNode(e))||t.getAttribute(e))&&t[e]===!0?e:i&&i.specified?i.value:null},o.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},o.uniqueSort=function(t){var e,i=[],n=1,s=0;if(A=!H.detectDuplicates,t.sort(j),A){for(;e=t[n];n++)e===t[n-1]&&(s=i.push(n));for(;s--;)t.splice(i[s],1)}return t},T=o.getText=function(t){var e,i="",n=0,s=t.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=T(t)}else if(3===s||4===s)return t.nodeValue}else for(;e=t[n];n++)i+=T(e);return i},S=o.selectors={cacheLength:50,createPseudo:s,match:ht,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(wt,_t),t[3]=(t[4]||t[5]||"").replace(wt,_t),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||o.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&o.error(t[0]),t},PSEUDO:function(t){var e,i=!t[5]&&t[2];return ht.CHILD.test(t[0])?null:(t[4]?t[2]=t[4]:i&&ut.test(i)&&(e=h(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){return"*"===t?function(){return!0}:(t=t.replace(wt,_t).toLowerCase(),function(e){return e.nodeName&&e.nodeName.toLowerCase()===t})},CLASS:function(t){var e=U[t+" "];return e||(e=new RegExp("(^|"+tt+")"+t+"("+tt+"|$)"))&&U(t,function(t){return e.test(t.className||typeof t.getAttribute!==J&&t.getAttribute("class")||"")})},ATTR:function(t,e,i){return function(n){var s=o.attr(n,t);return null==s?"!="===e:e?(s+="","="===e?s===i:"!="===e?s!==i:"^="===e?i&&0===s.indexOf(i):"*="===e?i&&s.indexOf(i)>-1:"$="===e?i&&s.slice(-i.length)===i:"~="===e?(" "+s+" ").indexOf(i)>-1:"|="===e?s===i||s.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(t,e,i,n,s){var r="nth"!==t.slice(0,3),o="last"!==t.slice(-4),a="of-type"===e;return 1===n&&0===s?function(t){return!!t.parentNode}:function(e,i,l){var u,c,h,d,f,p,m=r!==o?"nextSibling":"previousSibling",g=e.parentNode,v=a&&e.nodeName.toLowerCase(),y=!l&&!a;if(g){if(r){for(;m;){for(h=e;h=h[m];)if(a?h.nodeName.toLowerCase()===v:1===h.nodeType)return!1;p=m="only"===t&&!p&&"nextSibling"}return!0}if(p=[o?g.firstChild:g.lastChild],o&&y){for(c=g[F]||(g[F]={}),u=c[t]||[],f=u[0]===B&&u[1],d=u[0]===B&&u[2],h=f&&g.childNodes[f];h=++f&&h&&h[m]||(d=f=0)||p.pop();)if(1===h.nodeType&&++d&&h===e){c[t]=[B,f,d];break}}else if(y&&(u=(e[F]||(e[F]={}))[t])&&u[0]===B)d=u[1];else for(;(h=++f&&h&&h[m]||(d=f=0)||p.pop())&&((a?h.nodeName.toLowerCase()!==v:1!==h.nodeType)||!++d||(y&&((h[F]||(h[F]={}))[t]=[B,d]),h!==e)););return d-=s,d===n||d%n===0&&d/n>=0}}},PSEUDO:function(t,e){var i,n=S.pseudos[t]||S.setFilters[t.toLowerCase()]||o.error("unsupported pseudo: "+t);return n[F]?n(e):n.length>1?(i=[t,t,"",e],S.setFilters.hasOwnProperty(t.toLowerCase())?s(function(t,i){
for(var s,r=n(t,e),o=r.length;o--;)s=Z.call(t,r[o]),t[s]=!(i[s]=r[o])}):function(t){return n(t,0,i)}):n}},pseudos:{not:s(function(t){var e=[],i=[],n=E(t.replace(ot,"$1"));return n[F]?s(function(t,e,i,s){for(var r,o=n(t,null,s,[]),a=t.length;a--;)(r=o[a])&&(t[a]=!(e[a]=r))}):function(t,s,r){return e[0]=t,n(e,null,r,i),!i.pop()}}),has:s(function(t){return function(e){return o(t,e).length>0}}),contains:s(function(t){return function(e){return(e.textContent||e.innerText||T(e)).indexOf(t)>-1}}),lang:s(function(t){return ct.test(t||"")||o.error("unsupported lang: "+t),t=t.replace(wt,_t).toLowerCase(),function(e){var i;do if(i=I?e.getAttribute("xml:lang")||e.getAttribute("lang"):e.lang)return i=i.toLowerCase(),i===t||0===i.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===D},focus:function(t){return t===L.activeElement&&(!L.hasFocus||L.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeName>"@"||3===t.nodeType||4===t.nodeType)return!1;return!0},parent:function(t){return!S.pseudos.empty(t)},header:function(t){return vt.test(t.nodeName)},input:function(t){return gt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||e.toLowerCase()===t.type)},first:c(function(){return[0]}),last:c(function(t,e){return[e-1]}),eq:c(function(t,e,i){return[0>i?i+e:i]}),even:c(function(t,e){for(var i=0;e>i;i+=2)t.push(i);return t}),odd:c(function(t,e){for(var i=1;e>i;i+=2)t.push(i);return t}),lt:c(function(t,e,i){for(var n=0>i?i+e:i;--n>=0;)t.push(n);return t}),gt:c(function(t,e,i){for(var n=0>i?i+e:i;++n<e;)t.push(n);return t})}};for(x in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})S.pseudos[x]=l(x);for(x in{submit:!0,reset:!0})S.pseudos[x]=u(x);E=o.compile=function(t,e){var i,n=[],s=[],r=V[t+" "];if(!r){for(e||(e=h(t)),i=e.length;i--;)r=v(e[i]),r[F]?n.push(r):s.push(r);r=V(t,y(s,n))}return r},S.pseudos.nth=S.pseudos.eq,S.filters=_.prototype=S.pseudos,S.setFilters=new _,N(),o.attr=ft.attr,ft.find=o,ft.expr=o.selectors,ft.expr[":"]=ft.expr.pseudos,ft.unique=o.uniqueSort,ft.text=o.getText,ft.isXMLDoc=o.isXML,ft.contains=o.contains}(r);var Vt=/Until$/,Jt=/^(?:parents|prev(?:Until|All))/,Xt=/^.[^:#\[\.,]*$/,Kt=ft.expr.match.needsContext,Gt={children:!0,contents:!0,next:!0,prev:!0};ft.fn.extend({find:function(t){var e,i,n,s=this.length;if("string"!=typeof t)return n=this,this.pushStack(ft(t).filter(function(){for(e=0;s>e;e++)if(ft.contains(n[e],this))return!0}));for(i=[],e=0;s>e;e++)ft.find(t,this[e],i);return i=this.pushStack(s>1?ft.unique(i):i),i.selector=(this.selector?this.selector+" ":"")+t,i},has:function(t){var e,i=ft(t,this),n=i.length;return this.filter(function(){for(e=0;n>e;e++)if(ft.contains(this,i[e]))return!0})},not:function(t){return this.pushStack(g(this,t,!1))},filter:function(t){return this.pushStack(g(this,t,!0))},is:function(t){return!!t&&("string"==typeof t?Kt.test(t)?ft(t,this.context).index(this[0])>=0:ft.filter(t,this).length>0:this.filter(t).length>0)},closest:function(t,e){for(var i,n=0,s=this.length,r=[],o=Kt.test(t)||"string"!=typeof t?ft(t,e||this.context):0;s>n;n++)for(i=this[n];i&&i.ownerDocument&&i!==e&&11!==i.nodeType;){if(o?o.index(i)>-1:ft.find.matchesSelector(i,t)){r.push(i);break}i=i.parentNode}return this.pushStack(r.length>1?ft.unique(r):r)},index:function(t){return t?"string"==typeof t?ft.inArray(this[0],ft(t)):ft.inArray(t.jquery?t[0]:t,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){var i="string"==typeof t?ft(t,e):ft.makeArray(t&&t.nodeType?[t]:t),n=ft.merge(this.get(),i);return this.pushStack(ft.unique(n))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),ft.fn.andSelf=ft.fn.addBack,ft.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return ft.dir(t,"parentNode")},parentsUntil:function(t,e,i){return ft.dir(t,"parentNode",i)},next:function(t){return m(t,"nextSibling")},prev:function(t){return m(t,"previousSibling")},nextAll:function(t){return ft.dir(t,"nextSibling")},prevAll:function(t){return ft.dir(t,"previousSibling")},nextUntil:function(t,e,i){return ft.dir(t,"nextSibling",i)},prevUntil:function(t,e,i){return ft.dir(t,"previousSibling",i)},siblings:function(t){return ft.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return ft.sibling(t.firstChild)},contents:function(t){return ft.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:ft.merge([],t.childNodes)}},function(t,e){ft.fn[t]=function(i,n){var s=ft.map(this,e,i);return Vt.test(t)||(n=i),n&&"string"==typeof n&&(s=ft.filter(n,s)),s=this.length>1&&!Gt[t]?ft.unique(s):s,this.length>1&&Jt.test(t)&&(s=s.reverse()),this.pushStack(s)}}),ft.extend({filter:function(t,e,i){return i&&(t=":not("+t+")"),1===e.length?ft.find.matchesSelector(e[0],t)?[e[0]]:[]:ft.find.matches(t,e)},dir:function(t,e,i){for(var n=[],s=t[e];s&&9!==s.nodeType&&(i===o||1!==s.nodeType||!ft(s).is(i));)1===s.nodeType&&n.push(s),s=s[e];return n},sibling:function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}});var Yt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Qt=/ jQuery\d+="(?:null|\d+)"/g,Zt=new RegExp("<(?:"+Yt+")[\\s/>]","i"),te=/^\s+/,ee=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ie=/<([\w:]+)/,ne=/<tbody/i,se=/<|&#?\w+;/,re=/<(?:script|style|link)/i,oe=/^(?:checkbox|radio)$/i,ae=/checked\s*(?:[^=]|=\s*.checked.)/i,le=/^$|\/(?:java|ecma)script/i,ue=/^true\/(.*)/,ce=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,he={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ft.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},de=v(Z),fe=de.appendChild(Z.createElement("div"));he.optgroup=he.option,he.tbody=he.tfoot=he.colgroup=he.caption=he.thead,he.th=he.td,ft.fn.extend({text:function(t){return ft.access(this,function(t){return t===o?ft.text(this):this.empty().append((this[0]&&this[0].ownerDocument||Z).createTextNode(t))},null,t,arguments.length)},wrapAll:function(t){if(ft.isFunction(t))return this.each(function(e){ft(this).wrapAll(t.call(this,e))});if(this[0]){var e=ft(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstChild&&1===t.firstChild.nodeType;)t=t.firstChild;return t}).append(this)}return this},wrapInner:function(t){return ft.isFunction(t)?this.each(function(e){ft(this).wrapInner(t.call(this,e))}):this.each(function(){var e=ft(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=ft.isFunction(t);return this.each(function(i){ft(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(){return this.parent().each(function(){ft.nodeName(this,"body")||ft(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(t){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(t)})},prepend:function(){return this.domManip(arguments,!0,function(t){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(t,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,!1,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var i,n=0;null!=(i=this[n]);n++)(!t||ft.filter(t,[i]).length>0)&&(e||1!==i.nodeType||ft.cleanData(S(i)),i.parentNode&&(e&&ft.contains(i.ownerDocument,i)&&_(S(i,"script")),i.parentNode.removeChild(i)));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++){for(1===t.nodeType&&ft.cleanData(S(t,!1));t.firstChild;)t.removeChild(t.firstChild);t.options&&ft.nodeName(t,"select")&&(t.options.length=0)}return this},clone:function(t,e){return t=null==t?!1:t,e=null==e?t:e,this.map(function(){return ft.clone(this,t,e)})},html:function(t){return ft.access(this,function(t){var e=this[0]||{},i=0,n=this.length;if(t===o)return 1===e.nodeType?e.innerHTML.replace(Qt,""):o;if(!("string"!=typeof t||re.test(t)||!ft.support.htmlSerialize&&Zt.test(t)||!ft.support.leadingWhitespace&&te.test(t)||he[(ie.exec(t)||["",""])[1].toLowerCase()])){t=t.replace(ee,"<$1></$2>");try{for(;n>i;i++)e=this[i]||{},1===e.nodeType&&(ft.cleanData(S(e,!1)),e.innerHTML=t);e=0}catch(s){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(t){var e=ft.isFunction(t);return e||"string"==typeof t||(t=ft(t).not(this).detach()),this.domManip([t],!0,function(t){var e=this.nextSibling,i=this.parentNode;i&&(ft(this).remove(),i.insertBefore(t,e))})},detach:function(t){return this.remove(t,!0)},domManip:function(t,e,i){t=ot.apply([],t);var n,s,r,a,l,u,c=0,h=this.length,d=this,f=h-1,p=t[0],m=ft.isFunction(p);if(m||!(1>=h||"string"!=typeof p||ft.support.checkClone)&&ae.test(p))return this.each(function(n){var s=d.eq(n);m&&(t[0]=p.call(this,n,e?s.html():o)),s.domManip(t,e,i)});if(h&&(u=ft.buildFragment(t,this[0].ownerDocument,!1,this),n=u.firstChild,1===u.childNodes.length&&(u=n),n)){for(e=e&&ft.nodeName(n,"tr"),a=ft.map(S(u,"script"),b),r=a.length;h>c;c++)s=u,c!==f&&(s=ft.clone(s,!0,!0),r&&ft.merge(a,S(s,"script"))),i.call(e&&ft.nodeName(this[c],"table")?y(this[c],"tbody"):this[c],s,c);if(r)for(l=a[a.length-1].ownerDocument,ft.map(a,w),c=0;r>c;c++)s=a[c],le.test(s.type||"")&&!ft._data(s,"globalEval")&&ft.contains(l,s)&&(s.src?ft.ajax({url:s.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):ft.globalEval((s.text||s.textContent||s.innerHTML||"").replace(ce,"")));u=n=null}return this}}),ft.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){ft.fn[t]=function(t){for(var i,n=0,s=[],r=ft(t),o=r.length-1;o>=n;n++)i=n===o?this:this.clone(!0),ft(r[n])[e](i),at.apply(s,i.get());return this.pushStack(s)}}),ft.extend({clone:function(t,e,i){var n,s,r,o,a,l=ft.contains(t.ownerDocument,t);if(ft.support.html5Clone||ft.isXMLDoc(t)||!Zt.test("<"+t.nodeName+">")?r=t.cloneNode(!0):(fe.innerHTML=t.outerHTML,fe.removeChild(r=fe.firstChild)),!(ft.support.noCloneEvent&&ft.support.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||ft.isXMLDoc(t)))for(n=S(r),a=S(t),o=0;null!=(s=a[o]);++o)n[o]&&k(s,n[o]);if(e)if(i)for(a=a||S(t),n=n||S(r),o=0;null!=(s=a[o]);o++)x(s,n[o]);else x(t,r);return n=S(r,"script"),n.length>0&&_(n,!l&&S(t,"script")),n=a=s=null,r},buildFragment:function(t,e,i,n){for(var s,r,o,a,l,u,c,h=t.length,d=v(e),f=[],p=0;h>p;p++)if(r=t[p],r||0===r)if("object"===ft.type(r))ft.merge(f,r.nodeType?[r]:r);else if(se.test(r)){for(a=a||d.appendChild(e.createElement("div")),l=(ie.exec(r)||["",""])[1].toLowerCase(),c=he[l]||he._default,a.innerHTML=c[1]+r.replace(ee,"<$1></$2>")+c[2],s=c[0];s--;)a=a.lastChild;if(!ft.support.leadingWhitespace&&te.test(r)&&f.push(e.createTextNode(te.exec(r)[0])),!ft.support.tbody)for(r="table"!==l||ne.test(r)?"<table>"!==c[1]||ne.test(r)?0:a:a.firstChild,s=r&&r.childNodes.length;s--;)ft.nodeName(u=r.childNodes[s],"tbody")&&!u.childNodes.length&&r.removeChild(u);for(ft.merge(f,a.childNodes),a.textContent="";a.firstChild;)a.removeChild(a.firstChild);a=d.lastChild}else f.push(e.createTextNode(r));for(a&&d.removeChild(a),ft.support.appendChecked||ft.grep(S(f,"input"),T),p=0;r=f[p++];)if((!n||-1===ft.inArray(r,n))&&(o=ft.contains(r.ownerDocument,r),a=S(d.appendChild(r),"script"),o&&_(a),i))for(s=0;r=a[s++];)le.test(r.type||"")&&i.push(r);return a=null,d},cleanData:function(t,e){for(var i,n,s,r,o=0,a=ft.expando,l=ft.cache,u=ft.support.deleteExpando,c=ft.event.special;null!=(i=t[o]);o++)if((e||ft.acceptData(i))&&(s=i[a],r=s&&l[s])){if(r.events)for(n in r.events)c[n]?ft.event.remove(i,n):ft.removeEvent(i,n,r.handle);l[s]&&(delete l[s],u?delete i[a]:typeof i.removeAttribute!==Q?i.removeAttribute(a):i[a]=null,st.push(s))}}});var pe,me,ge,ve=/alpha\([^)]*\)/i,ye=/opacity\s*=\s*([^)]*)/,be=/^(top|right|bottom|left)$/,we=/^(none|table(?!-c[ea]).+)/,_e=/^margin/,xe=new RegExp("^("+pt+")(.*)$","i"),ke=new RegExp("^("+pt+")(?!px)[a-z%]+$","i"),Se=new RegExp("^([+-])=("+pt+")","i"),Te={BODY:"block"},Ce={position:"absolute",visibility:"hidden",display:"block"},Ee={letterSpacing:0,fontWeight:400},Ae=["Top","Right","Bottom","Left"],$e=["Webkit","O","Moz","ms"];ft.fn.extend({css:function(t,e){return ft.access(this,function(t,e,i){var n,s,r={},a=0;if(ft.isArray(e)){for(s=me(t),n=e.length;n>a;a++)r[e[a]]=ft.css(t,e[a],!1,s);return r}return i!==o?ft.style(t,e,i):ft.css(t,e)},t,e,arguments.length>1)},show:function(){return A(this,!0)},hide:function(){return A(this)},toggle:function(t){var e="boolean"==typeof t;return this.each(function(){(e?t:E(this))?ft(this).show():ft(this).hide()})}}),ft.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=ge(t,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":ft.support.cssFloat?"cssFloat":"styleFloat"},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var s,r,a,l=ft.camelCase(e),u=t.style;if(e=ft.cssProps[l]||(ft.cssProps[l]=C(u,l)),a=ft.cssHooks[e]||ft.cssHooks[l],i===o)return a&&"get"in a&&(s=a.get(t,!1,n))!==o?s:u[e];if(r=typeof i,"string"===r&&(s=Se.exec(i))&&(i=(s[1]+1)*s[2]+parseFloat(ft.css(t,e)),r="number"),!(null==i||"number"===r&&isNaN(i)||("number"!==r||ft.cssNumber[l]||(i+="px"),ft.support.clearCloneStyle||""!==i||0!==e.indexOf("background")||(u[e]="inherit"),a&&"set"in a&&(i=a.set(t,i,n))===o)))try{u[e]=i}catch(c){}}},css:function(t,e,i,n){var s,r,a,l=ft.camelCase(e);return e=ft.cssProps[l]||(ft.cssProps[l]=C(t.style,l)),a=ft.cssHooks[e]||ft.cssHooks[l],a&&"get"in a&&(r=a.get(t,!0,i)),r===o&&(r=ge(t,e,n)),"normal"===r&&e in Ee&&(r=Ee[e]),""===i||i?(s=parseFloat(r),i===!0||ft.isNumeric(s)?s||0:r):r},swap:function(t,e,i,n){var s,r,o={};for(r in e)o[r]=t.style[r],t.style[r]=e[r];s=i.apply(t,n||[]);for(r in e)t.style[r]=o[r];return s}}),r.getComputedStyle?(me=function(t){return r.getComputedStyle(t,null)},ge=function(t,e,i){var n,s,r,a=i||me(t),l=a?a.getPropertyValue(e)||a[e]:o,u=t.style;return a&&(""!==l||ft.contains(t.ownerDocument,t)||(l=ft.style(t,e)),ke.test(l)&&_e.test(e)&&(n=u.width,s=u.minWidth,r=u.maxWidth,u.minWidth=u.maxWidth=u.width=l,l=a.width,u.width=n,u.minWidth=s,u.maxWidth=r)),l}):Z.documentElement.currentStyle&&(me=function(t){return t.currentStyle},ge=function(t,e,i){var n,s,r,a=i||me(t),l=a?a[e]:o,u=t.style;return null==l&&u&&u[e]&&(l=u[e]),ke.test(l)&&!be.test(e)&&(n=u.left,s=t.runtimeStyle,r=s&&s.left,r&&(s.left=t.currentStyle.left),u.left="fontSize"===e?"1em":l,l=u.pixelLeft+"px",u.left=n,r&&(s.left=r)),""===l?"auto":l}),ft.each(["height","width"],function(t,e){ft.cssHooks[e]={get:function(t,i,n){return i?0===t.offsetWidth&&we.test(ft.css(t,"display"))?ft.swap(t,Ce,function(){return L(t,e,n)}):L(t,e,n):void 0},set:function(t,i,n){var s=n&&me(t);return $(t,i,n?N(t,e,n,ft.support.boxSizing&&"border-box"===ft.css(t,"boxSizing",!1,s),s):0)}}}),ft.support.opacity||(ft.cssHooks.opacity={get:function(t,e){return ye.test((e&&t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":e?"1":""},set:function(t,e){var i=t.style,n=t.currentStyle,s=ft.isNumeric(e)?"alpha(opacity="+100*e+")":"",r=n&&n.filter||i.filter||"";i.zoom=1,(e>=1||""===e)&&""===ft.trim(r.replace(ve,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===e||n&&!n.filter)||(i.filter=ve.test(r)?r.replace(ve,s):r+" "+s)}}),ft(function(){ft.support.reliableMarginRight||(ft.cssHooks.marginRight={get:function(t,e){return e?ft.swap(t,{display:"inline-block"},ge,[t,"marginRight"]):void 0}}),!ft.support.pixelPosition&&ft.fn.position&&ft.each(["top","left"],function(t,e){ft.cssHooks[e]={get:function(t,i){return i?(i=ge(t,e),ke.test(i)?ft(t).position()[e]+"px":i):void 0}}})}),ft.expr&&ft.expr.filters&&(ft.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0||!ft.support.reliableHiddenOffsets&&"none"===(t.style&&t.style.display||ft.css(t,"display"))},ft.expr.filters.visible=function(t){return!ft.expr.filters.hidden(t)}),ft.each({margin:"",padding:"",border:"Width"},function(t,e){ft.cssHooks[t+e]={expand:function(i){for(var n=0,s={},r="string"==typeof i?i.split(" "):[i];4>n;n++)s[t+Ae[n]+e]=r[n]||r[n-2]||r[0];return s}},_e.test(t)||(ft.cssHooks[t+e].set=$)});var Ne=/%20/g,Le=/\[\]$/,De=/\r?\n/g,Ie=/^(?:submit|button|image|reset|file)$/i,Re=/^(?:input|select|textarea|keygen)/i;ft.fn.extend({serialize:function(){return ft.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=ft.prop(this,"elements");return t?ft.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!ft(this).is(":disabled")&&Re.test(this.nodeName)&&!Ie.test(t)&&(this.checked||!oe.test(t))}).map(function(t,e){var i=ft(this).val();return null==i?null:ft.isArray(i)?ft.map(i,function(t){return{name:e.name,value:t.replace(De,"\r\n")}}):{name:e.name,value:i.replace(De,"\r\n")}}).get()}}),ft.param=function(t,e){var i,n=[],s=function(t,e){e=ft.isFunction(e)?e():null==e?"":e,n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(e===o&&(e=ft.ajaxSettings&&ft.ajaxSettings.traditional),ft.isArray(t)||t.jquery&&!ft.isPlainObject(t))ft.each(t,function(){s(this.name,this.value)});else for(i in t)R(i,t[i],e,s);return n.join("&").replace(Ne,"+")},ft.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){ft.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),ft.fn.hover=function(t,e){return this.mouseenter(t).mouseleave(e||t)};var Pe,Me,Oe=ft.now(),je=/\?/,Fe=/#.*$/,qe=/([?&])_=[^&]*/,He=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Be=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,ze=/^(?:GET|HEAD)$/,Ue=/^\/\//,We=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Ve=ft.fn.load,Je={},Xe={},Ke="*/".concat("*");try{Me=tt.href}catch(Ge){Me=Z.createElement("a"),Me.href="",Me=Me.href}Pe=We.exec(Me.toLowerCase())||[],ft.fn.load=function(t,e,i){if("string"!=typeof t&&Ve)return Ve.apply(this,arguments);var n,s,r,a=this,l=t.indexOf(" ");return l>=0&&(n=t.slice(l,t.length),t=t.slice(0,l)),ft.isFunction(e)?(i=e,e=o):e&&"object"==typeof e&&(r="POST"),a.length>0&&ft.ajax({url:t,type:r,dataType:"html",data:e}).done(function(t){s=arguments,a.html(n?ft("<div>").append(ft.parseHTML(t)).find(n):t)}).complete(i&&function(t,e){a.each(i,s||[t.responseText,e,t])}),this},ft.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){ft.fn[e]=function(t){return this.on(e,t)}}),ft.each(["get","post"],function(t,e){ft[e]=function(t,i,n,s){return ft.isFunction(i)&&(s=s||n,n=i,i=o),ft.ajax({url:t,type:e,dataType:s,data:i,success:n})}}),ft.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Me,type:"GET",isLocal:Be.test(Pe[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ke,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":r.String,"text html":!0,"text json":ft.parseJSON,"text xml":ft.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?O(O(t,ft.ajaxSettings),e):O(ft.ajaxSettings,t)},ajaxPrefilter:P(Je),ajaxTransport:P(Xe),ajax:function(t,e){function i(t,e,i,n){var s,h,y,b,_,k=e;2!==w&&(w=2,l&&clearTimeout(l),c=o,a=n||"",x.readyState=t>0?4:0,i&&(b=j(d,x,i)),t>=200&&300>t||304===t?(d.ifModified&&(_=x.getResponseHeader("Last-Modified"),_&&(ft.lastModified[r]=_),_=x.getResponseHeader("etag"),_&&(ft.etag[r]=_)),204===t?(s=!0,k="nocontent"):304===t?(s=!0,k="notmodified"):(s=F(d,b),k=s.state,h=s.data,y=s.error,s=!y)):(y=k,(t||!k)&&(k="error",0>t&&(t=0))),x.status=t,x.statusText=(e||k)+"",s?m.resolveWith(f,[h,k,x]):m.rejectWith(f,[x,k,y]),x.statusCode(v),v=o,u&&p.trigger(s?"ajaxSuccess":"ajaxError",[x,d,s?h:y]),g.fireWith(f,[x,k]),u&&(p.trigger("ajaxComplete",[x,d]),--ft.active||ft.event.trigger("ajaxStop")))}"object"==typeof t&&(e=t,t=o),e=e||{};var n,s,r,a,l,u,c,h,d=ft.ajaxSetup({},e),f=d.context||d,p=d.context&&(f.nodeType||f.jquery)?ft(f):ft.event,m=ft.Deferred(),g=ft.Callbacks("once memory"),v=d.statusCode||{},y={},b={},w=0,_="canceled",x={readyState:0,getResponseHeader:function(t){var e;if(2===w){if(!h)for(h={};e=He.exec(a);)h[e[1].toLowerCase()]=e[2];e=h[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===w?a:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return w||(t=b[i]=b[i]||t,y[t]=e),this},overrideMimeType:function(t){return w||(d.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>w)for(e in t)v[e]=[v[e],t[e]];else x.always(t[x.status]);return this},abort:function(t){var e=t||_;return c&&c.abort(e),i(0,e),this}};if(m.promise(x).complete=g.add,x.success=x.done,x.error=x.fail,d.url=((t||d.url||Me)+"").replace(Fe,"").replace(Ue,Pe[1]+"//"),d.type=e.method||e.type||d.method||d.type,d.dataTypes=ft.trim(d.dataType||"*").toLowerCase().match(mt)||[""],null==d.crossDomain&&(n=We.exec(d.url.toLowerCase()),d.crossDomain=!(!n||n[1]===Pe[1]&&n[2]===Pe[2]&&(n[3]||("http:"===n[1]?80:443))==(Pe[3]||("http:"===Pe[1]?80:443)))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=ft.param(d.data,d.traditional)),M(Je,d,e,x),2===w)return x;u=d.global,u&&0===ft.active++&&ft.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!ze.test(d.type),r=d.url,d.hasContent||(d.data&&(r=d.url+=(je.test(r)?"&":"?")+d.data,delete d.data),d.cache===!1&&(d.url=qe.test(r)?r.replace(qe,"$1_="+Oe++):r+(je.test(r)?"&":"?")+"_="+Oe++)),d.ifModified&&(ft.lastModified[r]&&x.setRequestHeader("If-Modified-Since",ft.lastModified[r]),ft.etag[r]&&x.setRequestHeader("If-None-Match",ft.etag[r])),(d.data&&d.hasContent&&d.contentType!==!1||e.contentType)&&x.setRequestHeader("Content-Type",d.contentType),x.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+Ke+"; q=0.01":""):d.accepts["*"]);for(s in d.headers)x.setRequestHeader(s,d.headers[s]);if(d.beforeSend&&(d.beforeSend.call(f,x,d)===!1||2===w))return x.abort();_="abort";for(s in{success:1,error:1,complete:1})x[s](d[s]);if(c=M(Xe,d,e,x)){x.readyState=1,u&&p.trigger("ajaxSend",[x,d]),d.async&&d.timeout>0&&(l=setTimeout(function(){x.abort("timeout")},d.timeout));try{w=1,c.send(y,i)}catch(k){if(!(2>w))throw k;i(-1,k)}}else i(-1,"No Transport");return x},getScript:function(t,e){return ft.get(t,o,e,"script")},getJSON:function(t,e,i){return ft.get(t,e,i,"json")}}),ft.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return ft.globalEval(t),t}}}),ft.ajaxPrefilter("script",function(t){t.cache===o&&(t.cache=!1),t.crossDomain&&(t.type="GET",t.global=!1)}),ft.ajaxTransport("script",function(t){if(t.crossDomain){var e,i=Z.head||ft("head")[0]||Z.documentElement;return{send:function(n,s){e=Z.createElement("script"),e.async=!0,t.scriptCharset&&(e.charset=t.scriptCharset),e.src=t.url,e.onload=e.onreadystatechange=function(t,i){(i||!e.readyState||/loaded|complete/.test(e.readyState))&&(e.onload=e.onreadystatechange=null,e.parentNode&&e.parentNode.removeChild(e),e=null,i||s(200,"success"))},i.insertBefore(e,i.firstChild)},abort:function(){e&&e.onload(o,!0)}}}});var Ye=[],Qe=/(=)\?(?=&|$)|\?\?/;ft.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ye.pop()||ft.expando+"_"+Oe++;return this[t]=!0,t}}),ft.ajaxPrefilter("json jsonp",function(t,e,i){var n,s,a,l=t.jsonp!==!1&&(Qe.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Qe.test(t.data)&&"data");return l||"jsonp"===t.dataTypes[0]?(n=t.jsonpCallback=ft.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,l?t[l]=t[l].replace(Qe,"$1"+n):t.jsonp!==!1&&(t.url+=(je.test(t.url)?"&":"?")+t.jsonp+"="+n),t.converters["script json"]=function(){return a||ft.error(n+" was not called"),a[0]},t.dataTypes[0]="json",s=r[n],r[n]=function(){a=arguments},i.always(function(){r[n]=s,t[n]&&(t.jsonpCallback=e.jsonpCallback,Ye.push(n)),a&&ft.isFunction(s)&&s(a[0]),a=s=o}),"script"):void 0});var Ze,ti,ei=0,ii=r.ActiveXObject&&function(){var t;for(t in Ze)Ze[t](o,!0)};ft.ajaxSettings.xhr=r.ActiveXObject?function(){return!this.isLocal&&q()||H()}:q,ti=ft.ajaxSettings.xhr(),ft.support.cors=!!ti&&"withCredentials"in ti,ti=ft.support.ajax=!!ti,ti&&ft.ajaxTransport(function(t){if(!t.crossDomain||ft.support.cors){var e;return{send:function(i,n){var s,a,l=t.xhr();if(t.username?l.open(t.type,t.url,t.async,t.username,t.password):l.open(t.type,t.url,t.async),t.xhrFields)for(a in t.xhrFields)l[a]=t.xhrFields[a];t.mimeType&&l.overrideMimeType&&l.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");try{for(a in i)l.setRequestHeader(a,i[a])}catch(u){}l.send(t.hasContent&&t.data||null),e=function(i,r){var a,u,c,h;try{if(e&&(r||4===l.readyState))if(e=o,s&&(l.onreadystatechange=ft.noop,ii&&delete Ze[s]),r)4!==l.readyState&&l.abort();else{h={},a=l.status,u=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(h.text=l.responseText);try{c=l.statusText}catch(d){c=""}a||!t.isLocal||t.crossDomain?1223===a&&(a=204):a=h.text?200:404}}catch(f){r||n(-1,f)}h&&n(a,c,h,u)},t.async?4===l.readyState?setTimeout(e):(s=++ei,ii&&(Ze||(Ze={},ft(r).unload(ii)),Ze[s]=e),l.onreadystatechange=e):e()},abort:function(){e&&e(o,!0)}}}});var ni,si,ri=/^(?:toggle|show|hide)$/,oi=new RegExp("^(?:([+-])=|)("+pt+")([a-z%]*)$","i"),ai=/queueHooks$/,li=[V],ui={"*":[function(t,e){var i,n,s=this.createTween(t,e),r=oi.exec(e),o=s.cur(),a=+o||0,l=1,u=20;if(r){if(i=+r[2],n=r[3]||(ft.cssNumber[t]?"":"px"),"px"!==n&&a){a=ft.css(s.elem,t,!0)||i||1;do l=l||".5",a/=l,ft.style(s.elem,t,a+n);while(l!==(l=s.cur()/o)&&1!==l&&--u)}s.unit=n,s.start=a,s.end=r[1]?a+(r[1]+1)*i:i}return s}]};ft.Animation=ft.extend(U,{tweener:function(t,e){ft.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var i,n=0,s=t.length;s>n;n++)i=t[n],ui[i]=ui[i]||[],ui[i].unshift(e)},prefilter:function(t,e){e?li.unshift(t):li.push(t)}}),ft.Tween=J,J.prototype={constructor:J,init:function(t,e,i,n,s,r){this.elem=t,this.prop=i,this.easing=s||"swing",this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=r||(ft.cssNumber[i]?"":"px")},cur:function(){var t=J.propHooks[this.prop];return t&&t.get?t.get(this):J.propHooks._default.get(this)},run:function(t){var e,i=J.propHooks[this.prop];return this.options.duration?this.pos=e=ft.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):J.propHooks._default.set(this),this}},J.prototype.init.prototype=J.prototype,J.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=ft.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){ft.fx.step[t.prop]?ft.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[ft.cssProps[t.prop]]||ft.cssHooks[t.prop])?ft.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},J.propHooks.scrollTop=J.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},ft.each(["toggle","show","hide"],function(t,e){var i=ft.fn[e];ft.fn[e]=function(t,n,s){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(X(e,!0),t,n,s)}}),ft.fn.extend({fadeTo:function(t,e,i,n){return this.filter(E).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var s=ft.isEmptyObject(t),r=ft.speed(e,i,n),o=function(){var e=U(this,ft.extend({},t),r);o.finish=function(){e.stop(!0)},(s||ft._data(this,"finish"))&&e.stop(!0)};return o.finish=o,s||r.queue===!1?this.each(o):this.queue(r.queue,o)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=o),e&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,s=null!=t&&t+"queueHooks",r=ft.timers,o=ft._data(this);if(s)o[s]&&o[s].stop&&n(o[s]);else for(s in o)o[s]&&o[s].stop&&ai.test(s)&&n(o[s]);for(s=r.length;s--;)r[s].elem!==this||null!=t&&r[s].queue!==t||(r[s].anim.stop(i),e=!1,r.splice(s,1));(e||!i)&&ft.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,i=ft._data(this),n=i[t+"queue"],s=i[t+"queueHooks"],r=ft.timers,o=n?n.length:0;for(i.finish=!0,ft.queue(this,t,[]),s&&s.cur&&s.cur.finish&&s.cur.finish.call(this),e=r.length;e--;)r[e].elem===this&&r[e].queue===t&&(r[e].anim.stop(!0),r.splice(e,1));for(e=0;o>e;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish})}}),ft.each({slideDown:X("show"),slideUp:X("hide"),slideToggle:X("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){ft.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),ft.speed=function(t,e,i){var n=t&&"object"==typeof t?ft.extend({},t):{complete:i||!i&&e||ft.isFunction(t)&&t,duration:t,easing:i&&e||e&&!ft.isFunction(e)&&e};return n.duration=ft.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in ft.fx.speeds?ft.fx.speeds[n.duration]:ft.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){ft.isFunction(n.old)&&n.old.call(this),n.queue&&ft.dequeue(this,n.queue)},n},ft.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},ft.timers=[],ft.fx=J.prototype.init,ft.fx.tick=function(){var t,e=ft.timers,i=0;for(ni=ft.now();i<e.length;i++)t=e[i],t()||e[i]!==t||e.splice(i--,1);e.length||ft.fx.stop(),ni=o},ft.fx.timer=function(t){t()&&ft.timers.push(t)&&ft.fx.start()},ft.fx.interval=13,ft.fx.start=function(){si||(si=setInterval(ft.fx.tick,ft.fx.interval))},ft.fx.stop=function(){clearInterval(si),si=null},ft.fx.speeds={slow:600,fast:200,_default:400},ft.fx.step={},ft.expr&&ft.expr.filters&&(ft.expr.filters.animated=function(t){return ft.grep(ft.timers,function(e){return t===e.elem}).length}),ft.fn.offset=function(t){if(arguments.length)return t===o?this:this.each(function(e){ft.offset.setOffset(this,t,e)});var e,i,n={top:0,left:0},s=this[0],r=s&&s.ownerDocument;if(r)return e=r.documentElement,ft.contains(e,s)?(typeof s.getBoundingClientRect!==Q&&(n=s.getBoundingClientRect()),i=K(r),{top:n.top+(i.pageYOffset||e.scrollTop)-(e.clientTop||0),left:n.left+(i.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}):n},ft.offset={setOffset:function(t,e,i){var n=ft.css(t,"position");"static"===n&&(t.style.position="relative");var s,r,o=ft(t),a=o.offset(),l=ft.css(t,"top"),u=ft.css(t,"left"),c=("absolute"===n||"fixed"===n)&&ft.inArray("auto",[l,u])>-1,h={},d={};
c?(d=o.position(),s=d.top,r=d.left):(s=parseFloat(l)||0,r=parseFloat(u)||0),ft.isFunction(e)&&(e=e.call(t,i,a)),null!=e.top&&(h.top=e.top-a.top+s),null!=e.left&&(h.left=e.left-a.left+r),"using"in e?e.using.call(t,h):o.css(h)}},ft.fn.extend({position:function(){if(this[0]){var t,e,i={top:0,left:0},n=this[0];return"fixed"===ft.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),ft.nodeName(t[0],"html")||(i=t.offset()),i.top+=ft.css(t[0],"borderTopWidth",!0),i.left+=ft.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-ft.css(n,"marginTop",!0),left:e.left-i.left-ft.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||Z.documentElement;t&&!ft.nodeName(t,"html")&&"static"===ft.css(t,"position");)t=t.offsetParent;return t||Z.documentElement})}}),ft.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var i=/Y/.test(e);ft.fn[t]=function(n){return ft.access(this,function(t,n,s){var r=K(t);return s===o?r?e in r?r[e]:r.document.documentElement[n]:t[n]:void(r?r.scrollTo(i?ft(r).scrollLeft():s,i?s:ft(r).scrollTop()):t[n]=s)},t,n,arguments.length,null)}}),ft.each({Height:"height",Width:"width"},function(t,e){ft.each({padding:"inner"+t,content:e,"":"outer"+t},function(i,n){ft.fn[n]=function(n,s){var r=arguments.length&&(i||"boolean"!=typeof n),a=i||(n===!0||s===!0?"margin":"border");return ft.access(this,function(e,i,n){var s;return ft.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(s=e.documentElement,Math.max(e.body["scroll"+t],s["scroll"+t],e.body["offset"+t],s["offset"+t],s["client"+t])):n===o?ft.css(e,i,a):ft.style(e,i,n,a)},e,r?n:o,r,null)}})}),i(3)&&i(3).jQuery&&(n=[],s=function(){return ft}.apply(e,n),!(s!==o&&(t.exports=s)))}(window)},function(t,e,i){(function(e){t.exports=e}).call(e,{jQuery:!0})},function(t,e,i){var n,s;n=[i(2),i(6),i(8),i(10),i(15),i(9),i(16),i(18),i(21),i(22),i(28),i(30),i(5),i(31),i(37),i(40),i(42),i(46),i(47),i(48),i(12),i(50),i(7),i(52)],s=function(t,e,i,n,s,r,o,a,l,u,c,h,d,f,p,m,g,v,y,b,w,_,x,k){var S=function(){e.bindAll(this,"onUserLoad","onPageLoad","onSettingsLoad","onSectionTreeLoad","onError"),k.core=this,x.core=this,this.restAPI=new g,this.current={},this.current.settings=new h,this.current.page=new c,this.current.session=new l,this.current.user=new u,this.current.section_tree=new d,this.modules=new y(this),this.modules.add("google_analytics",b),this.widgetManager=new p,this.toolTip=new _(this.current.settings),this.userManager=new m(this.current.session,this.current.user,this.current.settings),this.listenTo(this.userManager,"session:change",this.onSessionChange),this.loginManager=new f(this.restAPI,this.current.session,this.current.settings),this.listenTo(this.loginManager,"login",this.onLogin),this.listenTo(this.loginManager,"logout",this.onLogout),this.required={settings:!1,page:!1,language:!1,user:!1,section_tree:!1},this.readyDeferred=new t.Deferred,this.listenTo(this.current.settings,"change:google_analytics",this.onGAChange),this.listenTo(this.current.settings,"change:enable_anonymous_comments",this.onAnonymousChange),this.listenTo(this.current.settings,"change:wowza_connection",this.onWowzaChange),this.listenTo(this.current.settings,"change:lang",this.onLangChange),this.deferredEvents=[]};return e.extend(S.prototype,i.Events,{Backbone:i,$:t,_:e,events:r,i18n:a,util:s,setReady:function(t){this.required[t]=!0,e.every(this.required,e.identity)&&(this.readyDeferred.resolve(),this.onReady())},ready:function(t){return this.readyDeferred.done(t),this.readyDeferred.promise()},register:function(t){return this.widgetManager.register(t)},unregister:function(t){return this.widgetManager.unregister(t)},poll:function(t){return this.widgetManager.poll(t)},reset:function(t){var e=this;v.unsubscribeAll(),v.close(!0),this.locations=n(),this.widgetManager.removeAll(),this.modules.stopAll(),this.modules.startAll();var i={success:function(){e.toolTip.refresh(),e.poll(t)},error:this.onError};this.loadLanguage(function(){e.loadPage(i)})},loadPage:function(t){var e=this.locations,i={title:e.title||e.domain+e.path,path:e.path};if(e.image&&(i.image_url=e.image),e.description&&(i.description=e.description),e.unique_id&&(i.unique_id=e.unique_id,i.unique_id.length>100)){var n="The unique_id field must be less than 100 characters";this.deferredEvents.push(n)}this.current.page.getPage(i,t)},loadCSS:function(){var e=w.css_url||w.asset_url+"viafoura.css";t('link[href="'+e+'"]',"head").length||t('<link href="'+e+'" rel="stylesheet">').appendTo("head")},loadLanguage:function(t){var e=this.current.settings.get("lang"),i=this.locations.lang||e;this.i18n.loadLanguage(i,e).then(t)},triggerInitCallbacks:function(){"function"==typeof window.vfAsyncInit&&s.guard(window.vfAsyncInit)()},isInitializedOnWindow:function(){return window.viafoura&&window.viafoura.core},fetch:function(){this.current.settings.fetch({batch:!0,computerTime:new Date,success:this.onSettingsLoad,error:this.onError}),this.userManager.fetchUser({success:this.onUserLoad,error:this.onError}),this.loadPage({success:this.onPageLoad,error:this.onError}),this.current.section_tree.fetch({batch:!0,success:this.onSectionTreeLoad})},init:function(){this.locations=n(),this.loadCSS(),o(this),this.i18n.asset_url=w.asset_url,this.restAPI.setAPIUrl(w.api_url),this.restAPI.setSite(this.locations.domain),this.restAPI.setSection(this.locations.section),this.userManager.detectSession(),this.modules.startAll(),this.fetch(),this.triggerInitCallbacks(),this.triggerDeferredEvents()},triggerDeferredEvents:function(){for(var t=0;t<this.deferredEvents.length;t++)r.trigger("widget/init/invalidID",this.deferredEvents[t])},destroy:function(){this.stopListening()},onPageLoad:function(){this.setReady("page")},onUserLoad:function(){this.setReady("user")},onSettingsLoad:function(){this.setReady("settings")},onSectionTreeLoad:function(){this.setReady("section_tree")},onReady:function(){this.loginManager.autoLogin(),this.toolTip.refresh(),this.toolTip.start(),this.widgetManager.poll()},onSessionChange:function(t){this.restAPI.setSession(t)},onAnonymousChange:function(t){this.current.user.forceAnonymous=t.isEnabled("enable_anonymous_comments")},onWowzaChange:function(t){this.locations.wowza_connection=t.get("wowza_connection")},onLangChange:function(t){var e=this;this.loadLanguage(function(){e.setReady("language")})},onLogin:function(t,e){this.userManager.resetUser(t,e),e?r.trigger("/user/login/success",this.user):this.userManager.fetchUser({success:function(){r.trigger("/user/login/success",this.user)}})},onLogout:function(){this.userManager.logout()},onError:function(t,e,i){var n,s;i&&i.data?(n=i.data.verb,s=i.data.route):e&&e.data&&(n=e.data.verb,s=e.data.route),logError({message:"Failed to load: "+t.error+" Code: "+t.http_status+" "+n+" "+s})}}),new S}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(7)],s=function(t,e){var i=e.extend({defaults:{descendants:[]},idAttribute:"section_id",url:"/sections/root",sync_event:function(){return"/services/section_tree"},initialize:function(i,n){e.prototype.initialize.call(this,i,n),this.has("descendants")&&this.set("names",t.invert(this.get("descendants")))},parse:function(){var i=e.prototype.parse.apply(this,arguments);return i.names=t.invert(i.descendants),i},getID:function(t,e){return e=void 0===e?this.id:e,this.get("descendants")[t]||e},getName:function(t,e){return this.id===t?"root":(e=void 0===e?"root":e,this.get("names")[t]||e)}});return i}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n;(function(){function s(t,e,i){for(var n=(i||0)-1,s=t?t.length:0;++n<s;)if(t[n]===e)return n;return-1}function r(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||"undefined"==typeof i)return 1;if(n>i||"undefined"==typeof n)return-1}return t.index-e.index}function o(){return Tt.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,leading:!1,maxWait:0,"null":!1,number:null,object:null,push:null,string:null,trailing:!1,"true":!1,undefined:!1,value:null}}function a(){}function l(t){var e=t.cache;e&&l(e),t.array=t.cache=t.criteria=t.object=t.number=t.string=t.value=null,Tt.length<At&&Tt.push(t)}function u(t){return t instanceof u?t:new c(t)}function c(t,e){this.__chain__=!!e,this.__wrapped__=t}function h(t,e,i){if("function"!=typeof t)return gt;if("undefined"==typeof e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,s){return t.call(e,i,n,s)};case 4:return function(i,n,s,r){return t.call(e,i,n,s,r)}}return ut(t,e)}function d(t,e,i,n){for(var s=(n||0)-1,r=t?t.length:0,o=[];++s<r;){var a=t[s];if(a&&"object"==typeof a&&"number"==typeof a.length&&(oe(a)||b(a))){e||(a=d(a,e,i));var l=-1,u=a.length,c=o.length;for(o.length+=u;++l<u;)o[c++]=a[l]}else i||o.push(a)}return o}function f(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;var s=typeof t,r=typeof e;if(!(t!==t||t&&Ft[s]||e&&Ft[r]))return!1;if(null==t||null==e)return t===e;var o=Jt.call(t),a=Jt.call(e);if(o!=a)return!1;switch(o){case Dt:case It:return+t==+e;case Pt:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case Ot:case jt:return t==String(e)}var l=o==Lt;if(!l){if(Wt.call(t,"__wrapped__ ")||e instanceof u)return f(t.__wrapped__||t,e.__wrapped__||e,i,n);if(o!=Mt)return!1;var c=t.constructor,h=e.constructor;if(c!=h&&!(A(c)&&c instanceof c&&A(h)&&h instanceof h))return!1}i||(i=[]),n||(n=[]);for(var d=i.length;d--;)if(i[d]==t)return n[d]==e;var p=!0,m=0;if(i.push(t),n.push(e),l){if(m=e.length,p=m==t.length)for(;m--&&(p=f(t[m],e[m],i,n)););return p}return he(e,function(e,s,r){return Wt.call(r,s)?(m++,!(p=Wt.call(t,s)&&f(t[s],e,i,n))&&Et):void 0}),p&&he(t,function(t,e,i){return Wt.call(i,e)?!(p=--m>-1)&&Et:void 0}),p}function p(t){return function(e,i,n){var s={};i=ht(i,n,3);var r=-1,o=e?e.length:0;if("number"==typeof o)for(;++r<o;){var a=e[r];t(s,a,i(a,r,e),e)}else de(e,function(e,n,r){t(s,e,i(e,n,r),r)});return s}}function m(t,e,i,n,s,r){var o=1&e,a=2&e,l=4&e,u=8&e,c=16&e,h=32&e,d=t;if(!a&&!A(t))throw new TypeError;if(c&&!i.length&&(e&=-17,c=i=!1),h&&!n.length&&(e&=-33,h=n=!1),o&&!(a||l||h)&&(re.fastBind||Kt&&c)){if(c){var f=[s];Vt.apply(f,i)}var p=c?Kt.apply(t,f):Kt.call(t,s)}else p=function(){var f=arguments,v=o?s:this;if((l||c||h)&&(f=ie.call(f),c&&Xt.apply(f,i),h&&Vt.apply(f,n),l&&f.length<r))return e|=16,m(t,u?e:-4&e,f,null,s,r);if(a&&(t=v[d]),this instanceof p){v=g(t.prototype);var y=t.apply(v,f);return $(y)?y:v}return t.apply(v,f)};return p}function g(t){return $(t)?Gt(t):{}}function v(t){return ue[t]}function y(){var t=(t=u.indexOf)===it?s:t;return t}function b(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Jt.call(t)==Nt||!1}function w(t){if(!t)return t;for(var e=1,i=arguments.length;i>e;e++){var n=arguments[e];if(n)for(var s in n)t[s]=n[s]}return t}function _(t){return $(t)?oe(t)?ie.call(t):w({},t):t}function x(t){if(!t)return t;for(var e=1,i=arguments.length;i>e;e++){var n=arguments[e];if(n)for(var s in n)"undefined"==typeof t[s]&&(t[s]=n[s])}return t}function k(t){var e=[];return he(t,function(t,i){A(t)&&e.push(i)}),e.sort()}function S(t,e){return t?Wt.call(t,e):!1}function T(t){for(var e=-1,i=le(t),n=i.length,s={};++e<n;){var r=i[e];s[t[r]]=r}return s}function C(t){if(!t)return!0;if(oe(t)||L(t))return!t.length;for(var e in t)if(Wt.call(t,e))return!1;return!0}function E(t,e){return f(t,e)}function A(t){return"function"==typeof t}function $(t){return!(!t||!Ft[typeof t])}function N(t){return t&&Ft[typeof t]?Jt.call(t)==Ot:!1}function L(t){return"string"==typeof t||Jt.call(t)==jt}function D(t){var e=y(),i=d(arguments,!0,!1,1),n={};return he(t,function(t,s){e(i,s)<0&&(n[s]=t)}),n}function I(t){for(var e=-1,i=le(t),n=i.length,s=Array(n);++e<n;){var r=i[e];s[e]=[r,t[r]]}return s}function R(t){for(var e=-1,i=d(arguments,!0,!1,1),n=i.length,s={};++e<n;){var r=i[e];r in t&&(s[r]=t[r])}return s}function P(t){for(var e=-1,i=le(t),n=i.length,s=Array(n);++e<n;)s[e]=t[i[e]];return s}function M(t,e){var i=y(),n=t?t.length:0,s=!1;return n&&"number"==typeof n?s=i(t,e)>-1:de(t,function(t){return(s=t===e)&&Et}),s}function O(t,e,i){var n=!0;e=ht(e,i,3);var s=-1,r=t?t.length:0;if("number"==typeof r)for(;++s<r&&(n=!!e(t[s],s,t)););else de(t,function(t,i,s){return!(n=!!e(t,i,s))&&Et});return n}function j(t,e,i){var n=[];e=ht(e,i,3);var s=-1,r=t?t.length:0;if("number"==typeof r)for(;++s<r;){var o=t[s];e(o,s,t)&&n.push(o)}else de(t,function(t,i,s){e(t,i,s)&&n.push(t)});return n}function F(t,e,i){e=ht(e,i,3);var n=-1,s=t?t.length:0;if("number"!=typeof s){var r;return de(t,function(t,i,n){return e(t,i,n)?(r=t,Et):void 0}),r}for(;++n<s;){var o=t[n];if(e(o,n,t))return o}}function q(t,e,i){var n=-1,s=t?t.length:0;if(e=e&&"undefined"==typeof i?e:h(e,i,3),"number"==typeof s)for(;++n<s&&e(t[n],n,t)!==Et;);else de(t,e)}function H(t,e){var i=t?t.length:0;if("number"==typeof i)for(;i--&&e(t[i],i,t)!==!1;);else{var n=le(t);i=n.length,de(t,function(t,s,r){return s=n?n[--i]:--i,e(r[s],s,r)===!1&&Et})}}function B(t,e){var i=ie.call(arguments,2),n=-1,s="function"==typeof e,r=t?t.length:0,o=Array("number"==typeof r?r:0);return q(t,function(t){o[++n]=(s?e:t[e]).apply(t,i)}),o}function z(t,e,i){var n=-1,s=t?t.length:0;if(e=ht(e,i,3),"number"==typeof s)for(var r=Array(s);++n<s;)r[n]=e(t[n],n,t);else r=[],de(t,function(t,i,s){r[++n]=e(t,i,s)});return r}function U(t,e,i){var n=-(1/0),s=n,r=-1,o=t?t.length:0;if(e||"number"!=typeof o)e=ht(e,i,3),q(t,function(t,i,r){var o=e(t,i,r);o>n&&(n=o,s=t)});else for(;++r<o;){var a=t[r];a>s&&(s=a)}return s}function W(t,e,i){var n=1/0,s=n,r=-1,o=t?t.length:0;if(e||"number"!=typeof o)e=ht(e,i,3),q(t,function(t,i,r){var o=e(t,i,r);n>o&&(n=o,s=t)});else for(;++r<o;){var a=t[r];s>a&&(s=a)}return s}function V(t,e,i,n){if(!t)return i;var s=arguments.length<3;e=h(e,n,4);var r=-1,o=t.length;if("number"==typeof o)for(s&&(i=t[++r]);++r<o;)i=e(i,t[r],r,t);else de(t,function(t,n,r){i=s?(s=!1,t):e(i,t,n,r)});return i}function J(t,e,i,n){var s=arguments.length<3;return e=h(e,n,4),H(t,function(t,n,r){i=s?(s=!1,t):e(i,t,n,r)}),i}function X(t,e,i){return e=ht(e,i,3),j(t,function(t,i,n){return!e(t,i,n)})}function K(t){var e=-1,i=t?t.length:0,n=Array("number"==typeof i?i:0);return q(t,function(t){var i=yt(++e);n[e]=n[i],n[i]=t}),n}function G(t){var e=t?t.length:0;return"number"==typeof e?e:le(t).length}function Y(t,e,i){var n;e=ht(e,i,3);var s=-1,r=t?t.length:0;if("number"==typeof r)for(;++s<r&&!(n=e(t[s],s,t)););else de(t,function(t,i,s){return(n=e(t,i,s))&&Et});return!!n}function Q(t,e,i){var n=-1,s=t?t.length:0,o=Array("number"==typeof s?s:0);for(e=ht(e,i,3),q(t,function(t,i,s){o[++n]={criteria:e(t,i,s),index:n,value:t}}),s=o.length,o.sort(r);s--;)o[s]=o[s].value;return o}function Z(t){return oe(t)?ie.call(t):t&&"number"==typeof t.length?z(t):P(t)}function tt(t){for(var e=-1,i=y(),n=t.length,s=d(arguments,!0,!0,1),r=[];++e<n;){var o=t[e];i(s,o)<0&&r.push(o)}return r}function et(t,e,i){var n=0,s=t?t.length:0;if("number"!=typeof e&&null!=e){var r=-1;for(e=ht(e,i,3);++r<s&&e(t[r],r,t);)n++}else if(n=e,null==n||i)return t?t[0]:St;return ie.call(t,0,te(Zt(0,n),s))}function it(t,e,i){if("number"==typeof i){var n=t?t.length:0;i=0>i?Zt(0,n+i):i||0}else if(i){var r=at(t,e);return t[r]===e?r:-1}return s(t,e,i)}function nt(t,e,i){var n=0,s=t?t.length:0;if("number"!=typeof e&&null!=e){var r=s;for(e=ht(e,i,3);r--&&e(t[r],r,t);)n++}else n=null==e||i?1:e||n;return ie.call(t,0,te(Zt(0,s-n),s))}function st(t,e,i){var n=0,s=t?t.length:0;if("number"!=typeof e&&null!=e){var r=s;for(e=ht(e,i,3);r--&&e(t[r],r,t);)n++}else if(n=e,null==n||i)return t?t[s-1]:St;return ie.call(t,Zt(0,s-n))}function rt(t,e,i){var n=t?t.length:0;for("number"==typeof i&&(n=(0>i?Zt(0,n+i):te(i,n-1))+1);n--;)if(t[n]===e)return n;return-1}function ot(t,e,i){if("number"!=typeof e&&null!=e){var n=0,s=-1,r=t?t.length:0;for(e=ht(e,i,3);++s<r&&e(t[s],s,t);)n++}else n=null==e||i?1:Zt(0,e);return ie.call(t,n)}function at(t,e,i,n){var s=0,r=t?t.length:s;for(i=i?ht(i,n,1):gt,e=i(e);r>s;){var o=s+r>>>1;i(t[o])<e?s=o+1:r=o}return s}function lt(t){return tt(t,ie.call(arguments,1))}function ut(t,e){return arguments.length>2?m(t,17,ie.call(arguments,2),null,e):m(t,1,null,null,e)}function ct(t){for(var e=arguments.length>1?d(arguments,!0,!1,1):k(t),i=-1,n=e.length;++i<n;){var s=e[i];t[s]=m(t[s],1,null,null,t)}return t}function ht(t,e,i){var n=typeof t;if(null==t||"function"==n)return h(t,e,i);if("object"!=n)return function(e){return e[t]};var s=le(t);return function(e){for(var i=s.length,n=!1;i--&&(n=e[s[i]]===t[s[i]]););return n}}function dt(t,e,i){var n,s,r,o,a,l,u,c=0,h=!1,d=!0;if(!A(t))throw new TypeError;if(e=Zt(0,e)||0,i===!0){var f=!0;d=!1}else $(i)&&(f=i.leading,h="maxWait"in i&&(Zt(e,i.maxWait)||0),d="trailing"in i?i.trailing:d);var p=function(){var i=e-(new Date-o);if(0>=i){s&&clearTimeout(s);var h=u;s=l=u=St,h&&(c=+new Date,r=t.apply(a,n))}else l=setTimeout(p,i)},m=function(){l&&clearTimeout(l),s=l=u=St,(d||h!==e)&&(c=+new Date,r=t.apply(a,n))};return function(){if(n=arguments,o=+new Date,a=this,u=d&&(l||!f),h===!1)var i=f&&!l;else{s||f||(c=o);var g=h-(o-c);0>=g?(s&&(s=clearTimeout(s)),c=o,r=t.apply(a,n)):s||(s=setTimeout(m,g))}return l||e===h||(l=setTimeout(p,e)),i&&(r=t.apply(a,n)),r}}function ft(t){var e,i;if(!A(t))throw new TypeError;return function(){return e?i:(e=!0,i=t.apply(this,arguments),t=null,i)}}function pt(t,e,i){var n=!0,s=!0;if(!A(t))throw new TypeError;i===!1?n=!1:$(i)&&(n="leading"in i?i.leading:n,s="trailing"in i?i.trailing:s),i=o(),i.leading=n,i.maxWait=e,i.trailing=s;var r=dt(t,e,i);return l(i),r}function mt(t){return null==t?"":String(t).replace(ce,v)}function gt(t){return t}function vt(t){q(k(t),function(e){var i=u[e]=t[e];u.prototype[e]=function(){var t=[this.__wrapped__];Vt.apply(t,arguments);var e=i.apply(u,t);return this.__chain__&&(e=new c(e),e.__chain__=!0),e}})}function yt(t,e){return null==t&&null==e&&(e=1),t=+t||0,null==e?(e=t,t=0):e=+e||0,t+Ut(ee()*(e-t+1))}function bt(t,e){if(t){var i=t[e];return A(i)?t[e]():i}}function wt(t){var e=++Ct+"";return t?t+e:e}function _t(t){return t=new c(t),t.__chain__=!0,t}function xt(){return this.__chain__=!0,this}function kt(){return this.__wrapped__}var St,Tt=[],Ct=0,Et={},At=40,$t=/\bthis\b/,Nt="[object Arguments]",Lt="[object Array]",Dt="[object Boolean]",It="[object Date]",Rt="[object Function]",Pt="[object Number]",Mt="[object Object]",Ot="[object RegExp]",jt="[object String]",Ft={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},qt=Ft[typeof window]&&window||this,Ht=[],Bt=Object.prototype,zt=RegExp("^"+String(Bt.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),Ut=Math.floor,Wt=Bt.hasOwnProperty,Vt=Ht.push,Jt=Bt.toString,Xt=Ht.unshift,Kt=zt.test(Kt=Jt.bind)&&Kt,Gt=zt.test(Gt=Object.create)&&Gt,Yt=zt.test(Yt=Array.isArray)&&Yt,Qt=zt.test(Qt=Object.keys)&&Qt,Zt=Math.max,te=Math.min,ee=Math.random,ie=Ht.slice,ne=zt.test(qt.attachEvent),se=Kt&&!/\n|true/.test(Kt+ne);c.prototype=u.prototype;var re={};!function(){var t={0:1,length:1};re.fastBind=Kt&&!se,re.funcDecomp=!zt.test(qt.WinRTError)&&$t.test(function(){return this}),re.spliceObjects=(Ht.splice.call(t,0,1),!t[0])}(1),Gt||(g=function(t){if($(t)){a.prototype=t;var e=new a;a.prototype=null}return e||{}}),b(arguments)||(b=function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Wt.call(t,"callee")||!1});var oe=Yt||function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Jt.call(t)==Lt||!1},ae=function(t){var e,i=t,n=[];if(!i)return n;if(!Ft[typeof t])return n;for(e in i)Wt.call(i,e)&&n.push(e);return n},le=Qt?function(t){return $(t)?Qt(t):[]}:ae,ue={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},ce=RegExp("["+le(ue).join("")+"]","g"),he=function(t,e){var i,n=t,s=n;if(!n)return s;if(!Ft[typeof n])return s;for(i in n)if(e(n[i],i,t)===Et)return s;return s},de=function(t,e){var i,n=t,s=n;if(!n)return s;if(!Ft[typeof n])return s;for(i in n)if(Wt.call(n,i)&&e(n[i],i,t)===Et)return s;return s};A(/x/)&&(A=function(t){return"function"==typeof t&&Jt.call(t)==Rt});var fe=p(function(t,e,i){Wt.call(t,i)?t[i]++:t[i]=1}),pe=p(function(t,e,i){(Wt.call(t,i)?t[i]:t[i]=[]).push(e)});u.bind=ut,u.bindAll=ct,u.chain=_t,u.countBy=fe,u.debounce=dt,u.defaults=x,u.difference=tt,u.filter=j,u.forEach=q,u.functions=k,u.groupBy=pe,u.initial=nt,u.invert=T,u.invoke=B,u.keys=le,u.map=z,u.max=U,u.min=W,u.omit=D,u.once=ft,u.pairs=I,u.pick=R,u.reject=X,u.rest=ot,u.shuffle=K,u.sortBy=Q,u.throttle=pt,u.toArray=Z,u.values=P,u.without=lt,u.collect=z,u.drop=ot,u.each=q,u.extend=w,u.methods=k,u.select=j,u.tail=ot,u.clone=_,u.contains=M,u.escape=mt,u.every=O,u.find=F,u.has=S,u.identity=gt,u.indexOf=it,u.isArguments=b,u.isArray=oe,u.isEmpty=C,u.isEqual=E,u.isFunction=A,u.isObject=$,u.isRegExp=N,u.isString=L,u.lastIndexOf=rt,u.mixin=vt,u.random=yt,u.reduce=V,u.reduceRight=J,u.result=bt,u.size=G,u.some=Y,u.sortedIndex=at,u.uniqueId=wt,u.all=O,u.any=Y,u.detect=F,u.foldl=V,u.foldr=J,u.include=M,u.inject=V,u.first=et,u.last=st,u.take=et,u.head=et,vt(u),u.VERSION="2.1.0",u.prototype.chain=xt,u.prototype.value=kt,q(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=Ht[t];u.prototype[t]=function(){var t=this.__wrapped__;return e.apply(t,arguments),re.spliceObjects||0!==t.length||delete t[0],this}}),q(["concat","join","slice"],function(t){var e=Ht[t];u.prototype[t]=function(){var t=this.__wrapped__,i=e.apply(t,arguments);return this.__chain__&&(i=new c(i),i.__chain__=!0),i}}),n=function(){return u}.call(e,i,e,t),!(n!==St&&(t.exports=n))}).call(this)},function(t,e,i){var n,s;n=[i(2),i(8),i(6),i(9)],s=function(t,e,i,n){var s=e.Model.extend({initialize:function(t,e){e=e||{},this.restAPI=e.restAPI||s.core.restAPI,this.domainSettings=e.domainSettings||s.core.current.settings},sync_event:function(){return"/services"+("function"==typeof this.url?this.url():this.url)},getRoute:function(){var t="function"==typeof this.url?this.url():this.url;return this.attributes.id&&(t+="/"+this.attributes.id),t},sync:function(t,e,s){var r={};s.params&&i.extend(r,this.toJSON());var o,a=this.getRoute(s),l=this.sync_event();"read"===t?o="get":"create"===t?(i.extend(r,e),o="post"):"delete"===t?(o="delete",l="/services/request"):"update"===t&&(i.extend(r,e),o="patch"),n.trigger(l,o,a,r,s)},save:function(t,e){var i="",n=this;e=e||{},e.data=t;var s=e.success;return e.success=function(t,e){n.set(t.result),s&&s(t,e)},i=this.isNew()?"create":"update",this.sync(i,t,e)},parse:function(t){return t.result||t},toJSON:function(){return i.clone(this.attributes)},recordShare:function(t){var e=this;n.trigger("/services/analytics/shares",this.id,t,function(t){e.set("shares",t.result.shares)})},getShareCount:function(t){var e=this.get("shares");return e?0|e[t]:0},reset:function(t){this.clear(t),this.set(this.defaults,t)}});return s}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(6)],s=function(t,n){var s={$:t,_:n};return function(){var t,n=this,s=n.Backbone,r=[],o=r.push,a=r.slice,l=r.splice;t=e,t.VERSION="1.0.0";var u=n._;u||(u=i(6)),t.$=n.jQuery||n.Zepto||n.ender||n.$,t.noConflict=function(){return n.Backbone=s,this},t.emulateHTTP=!1,t.emulateJSON=!1;var c=t.Events={on:function(t,e,i){if(!d(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});var n=this._events[t]||(this._events[t]=[]);return n.push({callback:e,context:i,ctx:i||this}),this},once:function(t,e,i){if(!d(this,"once",t,[e,i])||!e)return this;var n=this,s=u.once(function(){n.off(t,s),e.apply(this,arguments)});return s._callback=e,this.on(t,s,i)},off:function(t,e,i){var n,s,r,o,a,l,c,h;if(!this._events||!d(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events={},this;for(o=t?[t]:u.keys(this._events),a=0,l=o.length;l>a;a++)if(t=o[a],r=this._events[t]){if(this._events[t]=n=[],e||i)for(c=0,h=r.length;h>c;c++)s=r[c],(e&&e!==s.callback&&e!==s.callback._callback||i&&i!==s.context)&&n.push(s);n.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=a.call(arguments,1);if(!d(this,"trigger",t,e))return this;var i=this._events[t],n=this._events.all;return i&&f(i,e),n&&f(n,arguments),this},stopListening:function(t,e,i){var n=this._listeners;if(!n)return this;var s=!e&&!i;"object"==typeof e&&(i=this),t&&((n={})[t._listenerId]=t);for(var r in n)n[r].off(e,i,this),s&&delete this._listeners[r];return this}},h=/\s+/,d=function(t,e,i,n){if(!i)return!0;if("object"==typeof i){for(var s in i)t[e].apply(t,[s,i[s]].concat(n));return!1}if(h.test(i)){for(var r=i.split(h),o=0,a=r.length;a>o;o++)t[e].apply(t,[r[o]].concat(n));return!1}return!0},f=function(t,e){var i,n=-1,s=t.length,r=e[0],o=e[1],a=e[2];switch(e.length){case 0:for(;++n<s;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r);return;case 2:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r,o);return;case 3:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r,o,a);return;default:for(;++n<s;)(i=t[n]).callback.apply(i.ctx,e)}},p={listenTo:"on",listenToOnce:"once"};u.each(p,function(t,e){c[e]=function(e,i,n){var s=this._listeners||(this._listeners={}),r=e._listenerId||(e._listenerId=u.uniqueId("l"));return s[r]=e,"object"==typeof i&&(n=this),e[t](i,n,this),this}}),c.bind=c.on,c.unbind=c.off,u.extend(t,c);var m=t.Model=function(t,e){var i,n=t||{};e||(e={}),this.cid=u.uniqueId("c"),this.attributes={},u.extend(this,u.pick(e,g)),e.parse&&(n=this.parse(n,e)||{}),(i=u.result(this,"defaults"))&&(n=u.defaults({},n,i)),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)},g=["url","urlRoot","collection"];u.extend(m.prototype,c,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return u.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return u.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var n,s,r,o,a,l,c,h;if(null==t)return this;if("object"==typeof t?(s=t,i=e):(s={})[t]=e,i||(i={}),!this._validate(s,i))return!1;r=i.unset,a=i.silent,o=[],l=this._changing,this._changing=!0,l||(this._previousAttributes=u.clone(this.attributes),this.changed={}),h=this.attributes,c=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(n in s)e=s[n],u.isEqual(h[n],e)||o.push(n),u.isEqual(c[n],e)?delete this.changed[n]:this.changed[n]=e,r?delete h[n]:h[n]=e;if(!a){o.length&&(this._pending=!0);for(var d=0,f=o.length;f>d;d++)this.trigger("change:"+o[d],this,h[o[d]],i)}if(l)return this;if(!a)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,u.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,u.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!u.isEmpty(this.changed):u.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?u.clone(this.changed):!1;var e,i=!1,n=this._changing?this._previousAttributes:this.attributes;for(var s in t)u.isEqual(n[s],e=t[s])||((i||(i={}))[s]=e);return i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return u.clone(this._previousAttributes)},fetch:function(t){t=t?u.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,i=t.success;return t.success=function(n){return e.set(e.parse(n,t),t)?(i&&i(e,n,t),void e.trigger("sync",e,n,t)):!1},$(this,t),this.sync("read",this,t)},save:function(t,e,i){var n,s,r,o=this.attributes;if(null==t||"object"==typeof t?(n=t,i=e):(n={})[t]=e,!(!n||i&&i.wait||this.set(n,i)))return!1;if(i=u.extend({validate:!0},i),!this._validate(n,i))return!1;n&&i.wait&&(this.attributes=u.extend({},o,n)),void 0===i.parse&&(i.parse=!0);var a=this,l=i.success;return i.success=function(t){a.attributes=o;var e=a.parse(t,i);return i.wait&&(e=u.extend(n||{},e)),u.isObject(e)&&!a.set(e,i)?!1:(l&&l(a,t,i),void a.trigger("sync",a,t,i))},$(this,i),s=this.isNew()?"create":i.patch?"patch":"update","patch"===s&&(i.attrs=n),r=this.sync(s,this,i),n&&i.wait&&(this.attributes=o),r},destroy:function(t){t=t?u.clone(t):{};var e=this,i=t.success,n=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(s){(t.wait||e.isNew())&&n(),i&&i(e,s,t),e.isNew()||e.trigger("sync",e,s,t)},this.isNew())return t.success(),!1;$(this,t);var s=this.sync("delete",this,t);return t.wait||n(),s},url:function(){var t=u.result(this,"urlRoot")||u.result(this.collection,"url")||A();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return this._validate({},u.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=u.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return i?(this.trigger("invalid",this,i,u.extend(e||{},{validationError:i})),!1):!0}});var v=["keys","values","pairs","invert","pick","omit"];u.each(v,function(t){m.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.attributes),u[t].apply(u,e)}});var y=t.Collection=function(t,e){e||(e={}),e.url&&(this.url=e.url),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,u.extend({silent:!0},e))},b={add:!0,remove:!0,merge:!0},w={add:!0,merge:!1,remove:!1};u.extend(y.prototype,c,{model:m,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return t.sync.apply(this,arguments)},add:function(t,e){return this.set(t,u.defaults(e||{},w))},remove:function(t,e){t=u.isArray(t)?t.slice():[t],e||(e={});var i,n,s,r;for(i=0,n=t.length;n>i;i++)r=this.get(t[i]),r&&(delete this._byId[r.id],delete this._byId[r.cid],s=this.indexOf(r),this.models.splice(s,1),this.length--,e.silent||(e.index=s,r.trigger("remove",r,this,e)),this._removeReference(r));return this},set:function(t,e){e=u.defaults(e||{},b),e.parse&&(t=this.parse(t,e)),u.isArray(t)||(t=t?[t]:[]);var i,n,s,r,a,c=e.at,h=this.comparator&&null==c&&e.sort!==!1,d=u.isString(this.comparator)?this.comparator:null,f=[],p=[],m={};for(i=0,n=t.length;n>i;i++)(s=this._prepareModel(t[i],e))&&((r=this.get(s))?(e.remove&&(m[r.cid]=!0),e.merge&&(r.set(s.attributes,e),h&&!a&&r.hasChanged(d)&&(a=!0))):e.add&&(f.push(s),s.on("all",this._onModelEvent,this),this._byId[s.cid]=s,null!=s.id&&(this._byId[s.id]=s)));if(e.remove){for(i=0,n=this.length;n>i;++i)m[(s=this.models[i]).cid]||p.push(s);p.length&&this.remove(p,e)}if(f.length&&(h&&(a=!0),this.length+=f.length,null!=c?l.apply(this.models,[c,0].concat(f)):o.apply(this.models,f)),a&&this.sort({silent:!0}),e.silent)return this;for(i=0,n=f.length;n>i;i++)(s=f[i]).trigger("add",s,this,e);return a&&this.trigger("sort",this,e),this},reset:function(t,e){e||(e={});for(var i=0,n=this.models.length;n>i;i++)this._removeReference(this.models[i]);return e.previousModels=this.models,this._reset(),this.add(t,u.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),this},push:function(t,e){return t=this._prepareModel(t,e),this.add(t,u.extend({at:this.length},e)),t},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return t=this._prepareModel(t,e),this.add(t,u.extend({at:0},e)),t},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(t,e){return this.models.slice(t,e)},get:function(t){return null==t?void 0:this._byId[null!=t.id?t.id:t.cid||t]},at:function(t){return this.models[t]},where:function(t,e){return u.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");
return t||(t={}),u.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(u.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},sortedIndex:function(t,e,i){e||(e=this.comparator);var n=u.isFunction(e)?e:function(t){return t.get(e)};return u.sortedIndex(this.models,t,n,i)},pluck:function(t){return u.invoke(this.models,"get",t)},fetch:function(t){t=t?u.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,i=this;return t.success=function(n){var s=t.reset?"reset":"set";i[s](n,t),e&&e(i,n,t),i.trigger("sync",i,n,t)},$(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?u.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var i=this,n=e.success;return e.success=function(s){e.wait&&i.add(t,e),n&&n(t,s,e)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof m)return t.collection||(t.collection=this),t;e||(e={}),e.collection=this;var i=new this.model(t,e);return i._validate(t,e)?i:(this.trigger("invalid",this,t,e),!1)},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,n),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var _=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];u.each(_,function(t){y.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.models),u[t].apply(u,e)}});var x=["groupBy","countBy","sortBy"];u.each(x,function(t){y.prototype[t]=function(e,i){var n=u.isFunction(e)?e:function(t){return t.get(e)};return u[t](this.models,n,i)}});var k=t.View=function(t){this.cid=u.uniqueId("view"),this._configure(t||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},S=/^(\S+)\s*(.*)$/,T=["model","collection","el","id","attributes","className","tagName","events"];u.extend(k.prototype,c,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=u.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var i=t[e];if(u.isFunction(i)||(i=this[t[e]]),i){var n=e.match(S),s=n[1],r=n[2];i=u.bind(i,this),s+=".delegateEvents"+this.cid,""===r?this.$el.on(s,i):this.$el.on(s,r,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(t){this.options&&(t=u.extend({},u.result(this,"options"),t)),u.extend(this,u.pick(t,T)),this.options=t},_ensureElement:function(){if(this.el)this.setElement(u.result(this,"el"),!1);else{var e=u.extend({},u.result(this,"attributes"));this.id&&(e.id=u.result(this,"id")),this.className&&(e["class"]=u.result(this,"className"));var i=t.$("<"+u.result(this,"tagName")+">").attr(e);this.setElement(i,!1)}}}),t.sync=function(e,i,n){var s=C[e];u.defaults(n||(n={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var r={type:s,dataType:"json"};if(n.url||(r.url=u.result(i,"url")||A()),null!=n.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(r.contentType="application/json",r.data=JSON.stringify(n.attrs||i.toJSON(n))),n.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),n.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){r.type="POST",n.emulateJSON&&(r.data._method=s);var o=n.beforeSend;n.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",s),o?o.apply(this,arguments):void 0}}"GET"===r.type||n.emulateJSON||(r.processData=!1),"PATCH"!==r.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(r.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=n.xhr=t.ajax(u.extend(r,n));return i.trigger("request",i,a,n),a};var C={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var E=function(t,e){var i,n=this;i=t&&u.has(t,"constructor")?t.constructor:function(){return n.apply(this,arguments)},u.extend(i,n,e);var s=function(){this.constructor=i};return s.prototype=n.prototype,i.prototype=new s,t&&u.extend(i.prototype,t),i.__super__=n.prototype,i};m.extend=y.extend=k.extend=E;var A=function(){throw new Error('A "url" property or function must be specified')},$=function(t,e){var i=e.error;e.error=function(n){i&&i(t,n,e),t.trigger("error",t,n,e)}}}.call(s),s.Backbone}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(8),i(2)],s=function(t,e,i){return e.Events}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(2),i(11),i(12),i(15)],s=function(t,e,i,n,s){var r=function(){};return r.prototype={parsePath:function(t){var e=t.match(/^([a-z]+):\/\/\/?([^\/]+)([^#]+)/i);return 4==e.length?e[3]:void 0},fetchPath:function(){var t,s,r=this.parsePath(location.href),o=e('meta[property="og:url"]').attr("content");return o&&(s=o.match(/^([a-z]+):\/\/([^\/]+)([^#]+)/i),s&&s.length>=4?s=s[3]:(i.warn("og:url is invalid ("+o+")"),s=null)),t=decodeURIComponent(n.path||s||r||location.pathname)},fetchTitle:function(){var t=e("meta");return(t.filter('[property="vf:title"]').attr("content")||t.filter('[name="vf:title"]').attr("content")||t.filter('[property="og:title"]').attr("content")||t.filter('[name="og:title"]').attr("content")||t.filter('[property="twitter:title"]').attr("content")||t.filter('[name="twitter:title"]').attr("content")||e("title").first().text()||"").substring(0,500)},fetchImage:function(){var t=e("meta");return t.filter('[property="vf:image"]').attr("content")||t.filter('[name="vf:image"]').attr("content")||t.filter('[property="og:image"]').attr("content")||t.filter('[name="og:image"]').attr("content")||t.filter('[property="twitter:image"]').attr("content")||t.filter('[name="twitter:image"]').attr("content")||e("link").filter("[rel=image_src]").attr("href")||""},fetchDescription:function(){var t=e("meta");return(t.filter('[property="vf:description"]').attr("content")||t.filter('[name="vf:description"]').attr("content")||t.filter('[property="og:description"]').attr("content")||t.filter('[name="og:description"]').attr("content")||t.filter('[property="description"]').attr("content")||t.filter('[name="description"]').attr("content")||t.filter('[property="twitter:description"]').attr("content")||t.filter('[name="twitter:description"]').attr("content")||"").substring(0,500)},refresh:function(){var t=e("meta"),i=s.parseUri(location.href);this.domain=n.domain||i.host||location.hostname,this.path=this.fetchPath(),this.title=this.fetchTitle(),this.image=this.fetchImage(),this.description=this.fetchDescription(),this.unique_id=t.filter('[property="vf:unique_id"]').attr("content")||t.filter('[name="vf:unique_id"]').attr("content"),this.lang=t.filter('[property="vf:lang"]').attr("content")||t.filter('[name="vf:lang"]').attr("content"),this.section=t.filter('[property="vf:section"]').attr("content")||t.filter('[name="vf:section"]').attr("content")}},function(){var t=new r;return t.refresh(),t}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(12),i(13),i(2)],s=function(t,e,i){var n={enabled:function(){return t.debug||"true"==e.getItem("vf-debug")||window.viafoura&&window.viafoura.debug||this.debug},assert:function(t,e){if(!t&&this.enabled())throw"Assert Fail: "+e},log:function(){this.enabled()&&window.console&&"function"==typeof window.console.log&&console.log.apply(window.console,arguments)},warn:function(){window.console&&"function"==typeof window.console.warn&&console.warn.apply(window.console,arguments)}};return n}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n;n=function(){var t,e,n,s,r,o,a="8b654f4",l={"test.vf-staging.com":{endpoint:"prelive"},"gusmelo.com":{requiredParam:!0,endpoint:"prelive"},"victoranjos.com":{requiredParam:!0,endpoint:"prelive"}},u=!1;for(var c in l)if(window.location.hostname===c){var h=l[c];u=!0,h.requiredParam?-1!=window.location.search.indexOf("src=prelive")?r=h.endpoint:u=!1:r=h.endpoint;break}var d="https",f="wss",p=navigator.userAgent.toLowerCase().indexOf("windows nt 5.1")>0;return p&&!document.addEventListener&&(d="http",f="ws"),u?(t="https://"+r+".viafoura.com/v2/",n="https://"+r+".viafoura.com/api/1/",s="https://"+r+".viafoura.com",i.p=d+"://cdn-"+r+".viafoura.net/",e=i.p+a+"/",o=("https:"===window.location.protocol?"wss:":"ws:")+"//subsub.viafoura.net"):(t="https://api.viafoura.com/v2/",n="https://api.viafoura.com/api/1/",s="https://api.viafoura.com",i.p=d+"://cdn.viafoura.net/",e=i.p+a+"/",o=("https:"===window.location.protocol?"wss:":"ws:")+"//subsub.viafoura.net"),{loginradius_api_key:"fb763410-afd1-4646-8232-5a5a4f0d9bae",loginradius_url:"https://viafoura-login.hub.loginradius.com/RequestHandlor.aspx",asset_url:e,video_poll:!0,css_url:e+"viafoura.css",api_url:t,api_url_v1:n,api_url_root:s,realtime_socket:o}}.call(e,i,e,t),!(void 0!==n&&(t.exports=n))},function(t,e,i){var n,s;n=[i(14)],s=function(t){var e=function(){var t="test";try{window.sessionStorage.setItem(t,t),window.sessionStorage.removeItem(t)}catch(e){return!1}return!0};return e()?window.sessionStorage:t}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[],s=function(){var t={length:0,setItem:function(t,e){document.cookie=t+"="+e+"; path=/",this.length++},getItem:function(t){for(var e=t+"=",i=document.cookie.split(";"),n=0,s=i.length;s>n;n++){for(var r=i[n];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(e))return r.substring(e.length,r.length)}return null},removeItem:function(t){this.setItem(t,"",-1),this.length--},clear:function(){for(var t=document.cookie.split(";"),e=0,i=t.length;i>e;e++){for(var n=t[e];" "===n.charAt(0);)n=n.substring(1,n.length);var s=n.substring(0,n.indexOf("="));this.removeItem(s)}this.length=0},key:function(t){var e=document.cookie.split(";");if(t>=e.length||isNaN(parseFloat(t))||!isFinite(t))return null;for(var i=e[t];" "===i.charAt(0);)i=i.substring(1,i.length);return i.substring(0,i.indexOf("="))}};return t}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(2),i(12)],s=function(t,e,i){var n={isMobile:function(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)},isElementPartiallyInViewport:function(t){if("function"==typeof e&&t instanceof e&&(t=t[0]),"function"!=typeof t.getBoundingClientRect)return!0;var i=t.getBoundingClientRect();return(i.top>=0&&i.top<=e(window).height()||i.bottom>=0&&i.bottom<=e(window).height())&&(i.left>=0&&i.left<=e(window).width()||i.right>=0&&i.right<=e(window).width())},wrap:function(t,e){return function(){e&&e.apply(this,arguments),t&&t.apply(this,arguments)}},insideWebview:function(){return/CriOS\//.test(navigator.userAgent)},getIEVersion:function(){var t=0,e=/MSIE (\d+\.\d+);/.test(navigator.userAgent),i=!!navigator.userAgent.match(/Trident\/7.0/),n=navigator.userAgent.indexOf("rv:11.0");return e&&(t=new Number(RegExp.$1)),-1!=navigator.appVersion.indexOf("MSIE 10")&&(t=10),i&&-1!=n&&(t=11),t},supportCORS:function(){if(void 0!==this.supportCORSCache)return this.supportCORSCache;var t=new XMLHttpRequest;return this.supportCORSCache="withCredentials"in t,this.supportCORSCache},supportXDomain:function(){return"undefined"!=typeof XDomainRequest},guard:function(t,e){return t.__wrap||(t.__wrap=function(){try{t.apply(e||this,arguments)}catch(i){window.setTimeout(function(){throw i},0)}}),t.__wrap},getTimeLeft:function(t,e){e=e||new Date;var i=1e3*t-e;return 0>i&&(i=0),i},isFlashEnabled:function(){var t,e=!1;try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),e=!0}catch(i){"undefined"!=typeof navigator.mimeTypes["application/x-shockwave-flash"]&&(e=!0)}return e},parseUri:function(t){for(var e={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},i=e,n=i.parser[i.strictMode?"strict":"loose"].exec(t),s={},r=14;r--;)s[i.key[r]]=n[r]||"";return s[i.q.name]={},s[i.key[12]].replace(i.q.parser,function(t,e,n){e&&(s[i.q.name][e]=n)}),s},toUuid:function(t){if("number"!=typeof t){if(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t))return t;throw new Error("invalid argument: "+t)}if(0>t)throw new Error("invalid argument: "+t);var e=t.toString(16);return e=Array(17-e.length).join("0")+e,"00000000-0000-400"+e[0]+"-8"+e.substring(1,4)+"-"+e.substring(4,16)},toVfId:function(t){if("string"!=typeof t||"36"!=t.length)throw new Error("invalid argument");return parseInt(t[17]+t.substring(20,23)+t.substring(24,36),16)},isWebkitBrowser:function(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)||/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)?!0:void 0}};return n}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(9),i(11),i(17)],s=function(t,e,i,n){function s(s){var r,o,a=window.viafoura||{},l={onLoginSuccess:"/user/login/success",onLogoutSuccess:"/user/logout",onLoginFail:"/user/login/fail",onError:"widget/init/invalidID",onCommentingPageLoadMore:"/commenting/page/load-more",onCommentingPageRTLoad:"/commenting/page/rt-load-more",onCommentingCommentLoadReplies:"/commenting/comment/load-replies",onCommentingCommentRTLoad:"/commenting/comment/rt-load-replies",onCommentingCommentRender:"/commenting/comment/render",onCommentingThread:"/commenting/page/load-thread"};r={current:function(){var t=s.current.user.toJSON();return t.logged_in=s.current.user.isLoggedIn(),t},cookieLogin:function(){s.loginManager.cookieAutoLogin()},updateDisplayName:function(t){return n.can("updateName",s.current.user)?(s.current.user.save({name:t}),!0):!1}},o={current:function(){return{id:s.current.session.id}},logout:function(){e.trigger("/user/logout/click")},login:{social:function(t){return s.loginManager.socialLogin(t)},cookie:function(t){return"string"==typeof t?(s.loginManager.cookieLogin.login(t),!0):!1},session:function(t,e){if("function"!=typeof e)throw new TypeError("Invalid Callback. Callback has to be a function.");var i=function(){e(s.current.user.toJSON())};s.userManager.resetUser(t)?s.userManager.fetchUser({success:i,error:i}):i()}}},s.current.user.on("change",function(t){t.get("id")&&!t.changed.id&&e.trigger("onUserChange",t.changed)}),s.ready(function(){s.current.user.on("change",function(t){window.Viafoura.Data.user=t.isLoggedIn()})}),window.viafoura=t.defaults(a,{core:s,users:r,session:o,ready:function(t){return"function"==typeof t?s.ready(t):void i.warn("viafoura.ready only accepts a function")},poll:function(){var t=Array.prototype.slice.apply(arguments);s.ready(function(){s.poll.apply(s,t)})},reset:function(t){s.ready(function(){s.reset(function(){e.trigger("onReset"),"function"==typeof t&&t()})})},Data:{user:!1},ui:{login:{show:function(){e.trigger("/user/login/click")},hide:function(){e.trigger("/modal/close/click")}},signup:{show:function(){e.trigger("/user/signup/click")},hide:function(){e.trigger("/modal/close/click")}},profile:{show:function(){e.trigger("/user/account/click",s.current.user)},hide:function(){e.trigger("/modal/close/click")}}},publish:e.trigger.bind(e),subscribe:function(i,n,s){if("function"!=typeof n)return!1;switch(i){case"onLoginSuccess":case"onLogoutSuccess":case"onLoginFail":case"onError":e.on(l[i],n);break;case"onCommentPost":e.on("comment:created",function(t){t.get("thread_id")===t.get("id")&&n.call(this,t.toJSON())},s);break;case"onCommentReply":e.on("comment:created",function(t){t.get("thread_id")!==t.get("id")&&n.call(this,t.toJSON())},s);break;case"onCommentingPageLoadMore":case"onCommentingPageRTLoad":case"onCommentingCommentLoadReplies":case"onCommentingCommentRTLoad":case"onCommentingCommentRender":case"onCommentingThread":e.on(l[i],function(){var e=[];t.each(arguments,function(t){e.push(t.toJSON?t.toJSON():t)}),n.apply(this,e)},s);break;case"onReset":case"onWidgetLoad":e.on(i,n,s);break;default:e.on(i,n,s)}}}),window.Viafoura=window.viafoura}return s}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(9)],s=function(t,e){return{authorize:function(t,i){return this.can(t,i)?!0:(e.trigger("onLoginRequired"),!1)},isLoggedIn:function(){return this.currentUser.isLoggedIn()},can:function(t,e){return i(4).userManager.ability.check(t,e)}}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(2),i(19),i(20),i(9)],s=function(t,e,i,n,s){var r=function(t){var e=this;t=t||{},this.asset_url=t.asset_url,this.translation={},this.cache={},i.registerHelper("i18n",function(){return e.translate.apply(e,arguments)})};return t.extend(r.prototype,{languages:{en:"en_us.js",fr:"fr.js",nl:"nl.js",sr:"sr_rs.js",ar:"ar.js",es:"es.js"},url:function(){return this.asset_url+"languages/"+this.languages[this.language]},hasLanguage:function(e){return t.has(this.languages,e)},loadLanguage:function(t,i){this.hasLanguage(t)?this.language=t:i?this.language=i:this.language="en","ar"===this.language?e("body").addClass("vf-rtl"):e("body").removeClass("vf-rtl");var n=e.Deferred();return this.cache[this.language]?(this.translation=this.cache[this.language],n.resolve()):(s.once("language:load",function(t){this.cache[this.language]=t,this.translation=t,setTimeout(function(){n.resolve()},0)},this),e.ajax({dataType:"script",url:this.url(),cache:!0}).fail(function(){n.fail()})),n.promise()},translate:function(t){var e="",s="";return t&&!this.translation[t]?"No translation found.":("function"==typeof this.translation[t]?s=this.translation[t].apply(null,Array.prototype.slice.call(arguments,1)):"string"==typeof this.translation[t]&&(s=this.translation[t]),e=n.apply(null,[s].concat(Array.prototype.slice.call(arguments,1))),new i.SafeString(e))}}),new r}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n;n=function(){var t={};return function(t,e){t.VERSION="1.0.0",t.COMPILER_REVISION=4,t.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"},t.helpers={},t.partials={};var i=Object.prototype.toString,n="[object Function]",s="[object Object]";t.registerHelper=function(e,n,r){if(i.call(e)===s){if(r||n)throw new t.Exception("Arg not supported with multiple helpers");t.Utils.extend(this.helpers,e)}else r&&(n.not=r),this.helpers[e]=n},t.registerPartial=function(e,n){i.call(e)===s?t.Utils.extend(this.partials,e):this.partials[e]=n},t.registerHelper("helperMissing",function(t){if(2===arguments.length)return e;throw new Error("Missing helper: '"+t+"'")}),t.registerHelper("blockHelperMissing",function(e,s){var r=s.inverse||function(){},o=s.fn,a=i.call(e);return a===n&&(e=e.call(this)),e===!0?o(this):e===!1||null==e?r(this):"[object Array]"===a?e.length>0?t.helpers.each(e,s):r(this):o(e)}),t.K=function(){},t.createFrame=Object.create||function(e){t.K.prototype=e;var i=new t.K;return t.K.prototype=null,i},t.registerHelper("if",function(e,s){var r=i.call(e);return r===n&&(e=e.call(this)),!e||t.Utils.isEmpty(e)?s.inverse(this):s.fn(this)}),t.registerHelper("unless",function(e,i){return t.helpers["if"].call(this,e,{fn:i.inverse,inverse:i.fn})});var r=["description","fileName","lineNumber","message","name","number","stack"];t.Exception=function(t){for(var e=Error.prototype.constructor.apply(this,arguments),i=0;i<r.length;i++)this[r[i]]=e[r[i]]},t.Exception.prototype=new Error,t.SafeString=function(t){this.string=t},t.SafeString.prototype.toString=function(){return this.string.toString()};var o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},a=/[&<>"'`]/g,l=/[&<>"'`]/,u=function(t){return o[t]||"&amp;"};t.Utils={extend:function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},escapeExpression:function(e){return e instanceof t.SafeString?e.toString():null==e||e===!1?"":(e=e.toString(),l.test(e)?e.replace(a,u):e)},isEmpty:function(t){return t||0===t?"[object Array]"===i.call(t)&&0===t.length?!0:!1:!0}},t.VM={template:function(e){var i={escapeExpression:t.Utils.escapeExpression,invokePartial:t.VM.invokePartial,programs:[],program:function(e,i,n){var s=this.programs[e];return n?s=t.VM.program(e,i,n):s||(s=this.programs[e]=t.VM.program(e,i)),s},merge:function(e,i){var n=e||i;return e&&i&&(n={},t.Utils.extend(n,i),t.Utils.extend(n,e)),n},programWithDepth:t.VM.programWithDepth,noop:t.VM.noop,compilerInfo:null};return function(n,s){s=s||{};var r=e.call(i,t,n,s.helpers,s.partials,s.data),o=i.compilerInfo||[],a=o[0]||1,l=t.COMPILER_REVISION;if(a!==l){if(l>a){var u=t.REVISION_CHANGES[l],c=t.REVISION_CHANGES[a];throw"Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+u+") or downgrade your runtime to an older version ("+c+")."}throw"Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+o[1]+")."}return r}},programWithDepth:function(t,e,i){var n=Array.prototype.slice.call(arguments,3),s=function(t,s){return s=s||{},e.apply(this,[t,s.data||i].concat(n))};return s.program=t,s.depth=n.length,s},program:function(t,e,i){var n=function(t,n){return n=n||{},e(t,n.data||i)};return n.program=t,n.depth=0,n},noop:function(){return""},invokePartial:function(i,n,s,r,o,a){var l={helpers:r,partials:o,data:a};if(i===e)throw new t.Exception("The partial "+n+" could not be found");if(i instanceof Function)return i(s,l);if(t.compile)return o[n]=t.compile(i,{data:a!==e}),o[n](s,l);throw new t.Exception("The partial "+n+" could not be compiled when running in runtime-only mode")}},t.template=t.VM.template}(t),t}.call(e,i,e,t),!(void 0!==n&&(t.exports=n))},function(t,e,i){var n,s;n=[],s=function(){return function(t){var e=1,i=arguments;return t.replace(/%s/g,function(t){var n=i[e++];return void 0===n?t:n})}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(7),i(13),i(12)],s=function(t,e,i,n){var s=e.extend({initialize:function(t){e.prototype.initialize.apply(this,arguments),this.sessionKey=s.sessionKey,this.id=null,t&&this.set(t.session)},get:function(){return this.id?this.id:void 0},set:function(t){return i&&t&&t.length>=16&&t.length<=32&&t.match(/^[a-z0-9]+$/)?(i.setItem(this.sessionKey,t),this.id=t,!0):!1},destroy:function(){i&&(i.setItem(this.sessionKey,""),this.id=null)},hasSession:function(){return!!this.id}},{sessionKey:"_vf_sid"});return s}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(7),i(23),i(12)],s=function(t,e,n,s){var r=e.extend({url:function(){return"/users"},defaults:{username:"guest",name:"Guest",pic_small:s.asset_url+"img/defaultavatar.png"},initialize:function(){e.prototype.initialize.apply(this,arguments),t.bindAll(this,"updateFollow")},comments:function(e,n){var s=i(24),r=new s(n);return r.rootUrl="/users/"+this.id,t.extend(r.settings,{limit:10,show:""},e),r.user=this,r},parse:function(e){var i=e.result||e;return t.defaults(i,this.defaults)},toJSON:function(){var e=t.clone(this.attributes);return e},updateFollow:function(t,e,i){"delete"===e.verb?this.set("subscribed",!1):this.set("subscribed",!0)},isGuest:function(){return"guest"===this.get("user_privilege")||!!this.get("anonymous")},canAnonymouslyPost:function(){return!this.isLoggedIn()&&this.forceAnonymous},getRoute:function(t){var e="function"==typeof this.url?this.url():this.url;return t.current?e+="/current":t.login?e+="/login":t.logout?e+="/logout":this.attributes.id&&(e+="/"+this.attributes.id),e},hasSubscribed:function(){return!!this.get("subscribed")},toggleFollow:function(t){t=t||{},t.success=i(15).wrap(t.success,this.updateFollow);var e="put";this.hasSubscribed()&&(e="delete"),t.verb=e,this.restAPI.request(e,"follows/"+this.id,{},t)},isLoggedIn:function(){return!!this.id},isBanned:function(){var t=this.get("ban_level");return"posting"===t||"ghost"===t||"login"===t||"hide"===t},hasGhostBan:function(){return"ghost"===this.get("ban_level")},hasPostingBan:function(){return"posting"===this.get("ban_level")},hasLoginBan:function(){return"login"===this.get("ban_level")},hasHideBan:function(){return"hide"===this.get("ban_level")},isAdmin:function(){return"administrator"===this.get("user_privilege")},isModerator:function(){return"moderator"===this.get("user_privilege")},isModOrAdmin:function(){return"moderator"===this.get("user_privilege")||"administrator"===this.get("user_privilege")},isTrusted:function(){return!!this.get("badge_trusted")},isViafouraAccount:function(){return!this.isCustomAccount()&&!this.isSocialAccount()&&!this.isWordpressAccount()},isCustomAccount:function(){return"Viafoura Defined Cookie"===this.get("social_login_provider")},isSocialAccount:function(){return this.has("social_login_provider")&&null!==this.get("social_login_provider").match(/facebook|google|linkedin|twitter|live|yahoo|backplane/)},isSocialEmailAccount:function(){return this.isSocialAccount()&&this.has("email")},isWordpressAccount:function(){return"oauth"===this.get("social_login_provider")}});return r}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(2),i(18)],s=function(t,e,i){var n={minLength:function(t,e){return t&&t.length>=e},maxLength:function(t,e){return t&&t.length<=e},empty:function(t){return t&&t.length>0},modemail:function(t){return t&&t.length>0},email:function(t){return t&&t.length>0&&t.length<=250&&!!t.match(/^(?:[-\w!\#\$%\&\'*+~/^`|{}]+(?:\.[-\w!\#\$%\&\'*+~/^`|{}]+)*)@((?:[a-z0-9](?:[-a-z0-9]*[a-z0-9])?\.)*[a-z0-9](?:[-a-z0-9]*[a-z0-9])?)\.((?:([^- ])[-a-z]*[-a-z]))$/i)},required:function(t){return!("undefined"==typeof t||null===t||""===t)},name:function(t){return t&&t.length>0},digits:function(t){return t&&!!(t+"").match(/^\d+$/)},username:function(t){return t&&t.length>0},oldPassword:function(t){return t&&t.length>=1},password:function(t,e){return e=e||8,t&&t.length>=e},confirmPassword:function(t,e,i){return t===e},min:function(t,e){return t&&t>=e},max:function(t,e){return t&&e>=t},errorMessage:function(t,e){return e=e||[],e.unshift("verror_"+t),i.translate.apply(i,e)},check:function(e,i){var n,s,r,o={};for(var a in i)if(n=i[a],s=e[a],"undefined"!=typeof s)for(var l in n)r=n[l],t.isArray(r)||(r=[r]),r.unshift(s),this[l].apply(this,r)||(o[a]||(o[a]=[]),o[a].push(this.errorMessage(l,r)));return t.keys(o).length?o:void 0}};return n}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(25),i(27),i(9),i(22)],s=function(t,e,i,n,s){var r=e.extend({model:i,url:function(){var t="/comments";return this.page&&(t="/pages/"+this.page.getRouteId()+t),t},initialize:function(e,i){i&&(this.page=i.page),this.settings={limit:5},i&&i.settings&&t.extend(this.settings,i.settings)}});return r}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(6),i(8),i(9),i(26)],s=function(t,e,i,n,s){var r=i.Collection.extend({initialize:function(t,e){this.after_count=0,this.before_count=0,this.total_count=0,this.settings={},e&&e.rootUrl&&(this.rootUrl=e.rootUrl),e&&e.error&&(this.error=e.error),i.Collection.prototype.initialize.apply(this,[t,e])},sync_event:function(){return"/services"+("function"==typeof this.url?this.url():this.url)},getUrl:function(){var t="function"==typeof this.url?this.url():this.url;return this.rootUrl&&(t=this.rootUrl+t),t},sync:function(t,e,i){var s,r=this.getUrl(i),o=this.settings;"read"===t?s="get":"create"===t?s="post":"delete"===t?s="delete":"update"===t&&(s="put"),n.trigger(this.sync_event(),s,r,o,i)},parse:function(t,e){var i=t.result;return e.setCounts!==!1&&this.setCounts(i),e.setBeforeAfterIDs!==!1&&this.setBeforeAfterIDs(i),"prepend"===e.insert_method&&(e.at=0),e.reverse===!0&&i.results.reverse(),i.actual_list&&this.parseActualList(i.actual_list),i.results},parseActualList:function(t){var e=t.split("_"),i=e.length;this.window=e[i-2],this.page_age=e[i-1]},setCounts:function(t){(void 0===this.settings.after_id||0===this.length)&&(this.before_count=t.before_count),(void 0===this.settings.before_id||0===this.length)&&(this.after_count=t.after_count),this.total_count=t.total_count},setBeforeAfterIDs:function(t){this.before_id=this.before_id||e.result(e.first(t.results),"id"),this.after_id=this.after_id||e.result(e.last(t.results),"id")},save:function(){this.each(function(t){})},refresh:function(t,e){this.id===e&&this.reset(t.result.results)},addMany:function(t,e){this.id===e&&this.add(t)},fetchBeginning:function(t){t=t||{},t.reset=!0,this.clearAfter(),this.clearBefore(),this.fetch(t)},fetchPageBefore:function(t){this.fetchBeforeId(this.before_id,t)},fetchPageAfter:function(t){this.fetchAfterId(this.after_id,t)},fetchBeforeId:function(t,e){delete this.settings.after_id,delete this.before_id,this.settings.before_id=t,e=e||{},"undefined"==typeof e.add&&(e.add=!0),e.remove=!1,this.fetch(e)},fetchAfterId:function(t,e){delete this.settings.before_id,delete this.after_id,this.settings.after_id=t,e=e||{},"undefined"==typeof e.add&&(e.add=!0),e.remove=!1,e.append=!0,this.fetch(e)},clearAfter:function(){delete this.after_id,delete this.settings.after_id},clearBefore:function(){delete this.before_id,delete this.settings.before_id},multiFetch:function(t){return new s(this,t)}});return r}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(6)],s=function(t,e){function i(t,i,n){return this.collection=t,this.Model=t.model,this.count=0,this.parsedResults=[],this.models=[],this.errors=[],this.defaultOptions=e.defaults({},i,{silent:!0,success:function(){},error:function(){}}),this.fetchFunc=n||"fetch",this.hasSuccess=!1,this.hasError=!1,this.successFunc=s.bind(this),this}function n(t,i){return e.isArray(i)||(i=[i]),Array.prototype.push.apply(t,i),t}var s=function(t,e){this.collection.add(t),this.collection.trigger("sync")};return i.prototype.processAddition=function(i,n,s){if(n=e.clone(n||{}),e.isString(i)&&void 0!==this.collection[i]&&e.isFunction(this.collection[i]))return s=i,n.add=n.add||!1,n.remove=n.remove||!1,[this.collection,n,s];if(t.isNumeric(i)){var r=parseInt(i);if(r%1===0)return[new this.Model({id:i}),n,s]}return i instanceof this.Model?[i,n,s]:void 0},i.prototype.add=function(t,i,s){return t=n([],t),t.length<1?this:(e.each(t,function(t){this.addSingle.apply(this,this.processAddition(t,i,s))}.bind(this)),this)},i.prototype.addSingle=function(t,i,n){if(void 0===t)return this;e.defaults(i,this.defaultOptions),n=n||this.fetchFunc,this.count+=1;var s=i.success,r=i.error;return i.success=this.getSuccessFunc(t,s,i),i.error=this.getErrorFunc(t,r),t[n](i),this},i.prototype.getSuccessFunc=function(t,e){return function(i,n,s){this.hasSuccess=!0,this.updateResults(t,n,s),this.updateModels(t,n,s),e.apply(t,arguments),this.complete()}.bind(this)},i.prototype.getErrorFunc=function(t,e){return function(i,n){this.hasError=!0,this.errors.push(n),e.apply(t,arguments),this.complete()}.bind(this)},i.prototype.complete=function(){return this.count-=1,0===this.count&&(this.hasSuccess?this.successFunc(this.models,this.parsedResults,this.errors):this.hasError&&this.errorFunc(this.models,this.parsedResults,this.errors)),
this},i.prototype.updateResults=function(t,e,i){var s=t.parse(e,i);return n(this.parsedResults,s),s},i.prototype.updateModels=function(t,i,s){t instanceof this.Model&&this.models.push(t),e.each(n([],t.parse(i,s)),function(t){this.models.push(new this.Model(t,s))}.bind(this))},i.prototype.success=function(t){return this.successFunc=t,this},i.prototype.error=function(t){return this.errorFunc=t,this},i}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(7),i(23),i(22),i(15),i(9)],s=function(t,e,n,s,r,o){var a=null,l=e.extend({defaults:{num_likes:0,num_dislikes:0,liked:0,disliked:0},url:function(){return"/comments"},initialize:function(n,s){if(e.prototype.initialize.apply(this,arguments),s=s||{},t.bindAll(this,"updateLikes"),t.bindAll(this,"updateDislikes"),n){this.setUser(n.user);var r=i(28);this.page=new r(n.page||{}),this.setThread(n.thread),this.setRealtimeNew(s.realtimeNewComment)}},getThreadsAsc:function(){return this.thread.models.reverse()},updateCounts:function(t,e,i){var n,s="liked"==t?"disliked":"liked",r="liked"==t?"num_likes":"num_dislikes",o="disliked"==t?"num_likes":"num_dislikes",a={};"delete"===i.verb?(n=this.get(r),a[t]=0,a[r]=0===n?0:n-1):(a[t]=1,a[r]=this.get(r)+1,a[o]=1===this.get(s)?this.get(o)-1:this.get(o),a[o]=a[o]<0?0:a[o],a[s]=0),this.set(a)},updateLikes:function(t,e){this.updateCounts("liked",t,e)},updateDislikes:function(t,e){this.updateCounts("disliked",t,e)},getThread:function(t){t=t||{};var e=i(29),n=new e([],{page:this.page}),s=n.url;return n.url="/comments/"+this.id+"/context",n.fetch(t),n.url=s,n},replies:function(t){t=t||{};var e=i(29),n=new e;return n.pageId=this.get("parent_id"),n.id=this.get("thread_id"),n},shareLink:function(){return window.location.protocol+"//"+window.location.host+this.page.get("path")+encodeURIComponent("#")+"vf-"+this.id},parse:function(t,e){return t=t.result||t,this.setUser(t.user),this.setRealtimeNew(e.realtimeNewComment),t},setUser:function(t){t=t||{},a=i(4),this.user=t.id===a.current.user.id?a.current.user:new s(t)},setThread:function(t){t&&(this.thread||(this.thread=this.replies()),this.thread.add(t.results),this.thread.after_count=t.after_count,this.thread.before_count=t.before_count,this.thread.total_count=t.total_count)},setRealtimeNew:function(t){t=!!t,this.set("realtimeNewComment",t),this.thread&&this.thread.each(function(e){e.setRealtimeNew(t)})},toJSON:function(){var e=t.clone(this.attributes);return e.video&&e.video.thumbs&&(e.video_placeholder=this.attributes.video.thumbs.medium),this.user&&(e.user=this.user.toJSON()),e.picture&&(e.imageURL=this.largestImage().url,e.thumbURL=this.largestImageBelow("s").url),e.comment_url=this.getPageUrl()+"#vf-"+this.id,e.page_url=this.getPageUrl(),e},getPageUrl:function(){var t="",e=this.attributes.page;return e&&(t=location.host+e.path),t},hasLiked:function(){return 1!==this.get("liked")},hasDisliked:function(){return 1!==this.get("disliked")},toggleLike:function(t){t=t||{},t.success=i(15).wrap(t.success,this.updateLikes);var e="delete";this.hasLiked()&&(e="put"),t.verb=e,this.restAPI.request(e,"likes/"+this.id,{},t)},toggleDislike:function(t){t=t||{},t.success=i(15).wrap(t.success,this.updateDislikes);var e="delete";this.hasDisliked()&&(e="put"),t.verb=e,this.restAPI.request(e,"dislikes/"+this.id,{},t)},largestImage:function(){var t=this.attributes;return t.picture.l||t.picture.m||t.picture.s||t.picture.t},largestImageBelow:function(t){for(var e=this.attributes,i=["x","l","m","s","t"],n=!0,s=0;s<i.length;s++)if(n&&(n=i[s]!=t),!n&&e.picture[i[s]])return e.picture[i[s]];return e.picture[i.pop()]},isVideoProcessing:function(){return this.has("video")&&"in_progress"==this.attributes.video.processing_status},isVideoComplete:function(){return this.has("video")&&"completed"==this.attributes.video.processing_status},isRemoved:function(){return"removed"==this.get("processing_status")},isSpam:function(){return"spam"==this.get("processing_status")},isDisabled:function(){return"disabled"==this.get("processing_status")},hasMedia:function(){return this.has("picture")||this.has("video")||this.has("media_id")},getEditTimeLeft:function(){return Math.min(this.get("date_created")+this.domainSettings.get("user_comment_edit_timeout"),this.get("date_locked"))},hasEditTimeLeft:function(){return r.getTimeLeft(this.getEditTimeLeft(),this.domainSettings.currentTime())>0},hasEditTimeLimit:function(){return this.hasEditTimeLeft()&&!(this.get("date_locked")===this.domainSettings.foreverTimeout&&this.domainSettings.hasForeverTimeout())}});return l}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(7),i(24),i(29)],s=function(t,e,n,s){var r=e.extend({url:"/pages",initialize:function(){e.prototype.initialize.apply(this,arguments),t.bindAll(this,"updateFollow")},toJSON:function(){var e=t.clone(this.attributes);return e.host=window.location.host,e.rating&&e.rating.toFixed&&(e.rating=e.rating.toFixed(1)),e},updateFollow:function(t,e){"delete"===e.verb?this.set({subscribed:!1}):this.set({subscribed:!0})},rate:function(t){var e=this.get("rating"),i=this.get("num_ratings")+1;this.set({num_ratings:i,rating:e+(t-e)/i})},comments:function(){var t=new n;return t.url="/pages/"+this.getRouteId()+"/comments",t},threads:function(t){var e=new s([],t);return e.page=this,e},hasSubscribed:function(){return!!this.get("subscribed")},toggleFollow:function(t){t=t||{},t.success=i(15).wrap(t.success,this.updateFollow);var e="put";this.hasSubscribed()&&(e="delete"),t.verb=e,this.restAPI.request(e,"follows/"+this.id,{},t)},isOpenTopic:function(){return"opentalk"==this.attributes.original_parent_type},getRouteId:function(){return this.id?this.id:encodeURIComponent(this.get("path"))},getPage:function(e,i){this.unset("id",{silent:!0}),this.save(e,t.extend({},i,{batch:!0}))},isHidden:function(){return"hidden"===this.attributes.status},isClosed:function(){return"closed"===this.get("status")},canComment:function(){return"closed"!==this.attributes.status&&"hidden"!==this.attributes.status}});return r}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(9),i(25),i(8),i(27)],s=function(t,e,n,s,r){var o=n.extend({model:r,defaultSort:"newest",url:function(){var t="/threads";return this.page&&(t="/pages/"+this.page.getRouteId()+t),this.id&&(t="/threads/"+this.id+"/comments"),this.editor&&(t="/pages/"+this.page.getRouteId()+"/comments"),this.context&&(t="/comments/"+this.context+"/context"),t},setOptions:function(t){},sortBy:function(t){switch(t){case"likes":case"activity":case"newest":case"oldest":case"replies":case"editor-picks":return delete this.settings.show,delete this.settings.sort,"editor-picks"==t?(this.settings.show=t,this.editor=!0):(this.editor=!1,this.settings.sort=t),!0}return!1},sync_event:function(){return"/services/threads"},initialize:function(n,s){t.bindAll("cleanRealtimeNew"),this.model=i(27),s&&(this.page=s.page),this.settings={sort:this.defaultSort,limit:10,original_parent_id:this.page&&this.page.id},s&&s.settings&&t.extend(this.settings,s.settings),this.listenTo(e,"threads:cleanRealtimeNew",this.cleanRealtimeNew)},fetchItem:function(e,i){var n=t.clone(this.settings);delete this.settings.limit,t.extend(this.settings,{item_id:e,max_before:4,max_after:4}),this.fetch(i),this.settings=n},fetchBeginning:function(t){this.setPage(),n.prototype.fetchBeginning.apply(this,arguments)},fetchPageBefore:function(t){this.setPage(),t=t||{},t.remove=!1,t.reverse=!0,n.prototype.fetchPageBefore.call(this,t)},fetchPageAfter:function(t){this.setPage(),t=t||{},t.remove=!1,t.append=!0,n.prototype.fetchPageAfter.call(this,t)},setPage:function(){this.page&&this.pageId&&this.settings.original_parent_id||!(this.models.length>0)?!this.settings.original_parent_id&&this.pageId&&(this.settings.original_parent_id=this.pageId):(this.page=this.models[0].page,this.pageId=this.page.id,this.settings.original_parent_id=this.page.id)},isLoadedThread:function(t){return this.some(function(e){return e.id===t?!0:!1})},fetchMissing:function(e){var i=this;t.each(e.ids,function(t){if(!i.isLoadedThread(t)){var n=new r({id:t});n.fetch({success:function(t){i.add(t)},error:e.error})}})},cleanRealtimeNew:function(t){this.each(function(e){(void 0===t||t===e.get("thread_id"))&&e.set("realtimeNewComment",!1)})}});return o}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(7),i(15)],s=function(t,e){var i=t.extend({url:"/settings",foreverTimeout:4294967295,isEnabled:function(t){return 1===this.get(t)},isDisabled:function(t){return 0===this.get(t)},currentTime:function(){var t=new Date;return t.getTime()+this.timeOffset},hasEditTimeLimit:function(){return this.get("user_comment_edit_timeout")!==this.foreverTimeout},hasForeverTimeout:function(){return this.get("user_comment_edit_timeout")===this.foreverTimeout},parse:function(t,i){var n=e.getIEVersion();if((!e.supportCORS()&&!e.supportXDomain()||0!=n&&9>=n)&&t.result.comment_max_length>1400&&(t.result.comment_max_length=1400),void 0!==t.result.server_time){this.serverTime=new Date(1e3*t.result.server_time);var s=i.computerTime||new Date;this.timeOffset=this.serverTime.getTime()-s.getTime()+this.restAPI.batchDelay}else this.timeOffset=0;return t.result}});return i}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(8),i(6),i(32),i(33),i(34),i(35),i(36),i(12)],s=function(t,e,i,n,s,r,o,a){var l=function(t,e,l){this.restAPI=t,this.session=e,this.settings=l,this.oAuthLogin=new i(e),this.cookieLogin=new n(e,l),this.backplaneLogin=new s(t),this.gigyaLogin=new r(e),this.loginRadiusLogin=new o(t,a.loginradius_api_key,a.loginradius_url),this.listenTo(this.settings,"change:authprovider_oauth_enabled",this.onOAuthChange),this.listenTo(this.settings,"change:authprovider_custom_cookie_name",this.onCookieChange),this.listenTo(this.settings,"change:authprovider_backplane_v2_enabled",this.onBackplaneChange),this.listenTo(this.settings,"change:authprovider_backplane_v1_2_enabled",this.onBackplaneChange),this.listenTo(this.settings,"change:authprovider_gigya_poll",this.onGigyaPollChange),this.listenTo(this.oAuthLogin,"login",this.onLogin),this.listenTo(this.oAuthLogin,"login:fail",this.onLoginFail),this.listenTo(this.backplaneLogin,"login",this.onLogin),this.listenTo(this.backplaneLogin,"login:fail",this.onLoginFail),this.listenTo(this.gigyaLogin,"login",this.onLogin),this.listenTo(this.gigyaLogin,"login:fail",this.onLoginFail),this.listenTo(this.gigyaLogin,"logout",this.onLogout),this.listenTo(this.cookieLogin,"login",this.onLogin),this.listenTo(this.cookieLogin,"login:fail",this.onLoginFail),this.listenTo(this.loginRadiusLogin,"login",this.onLogin),this.listenTo(this.loginRadiusLogin,"login:fail",this.onLoginFail),this.loginRadiusLogin.setup()};return e.extend(l.prototype,t.Events,{socialLogin:function(t){return this.loginRadiusLogin.login(t)},cookieAutoLogin:function(){this.cookieLogin.autoLogin()},autoLogin:function(){return this.cookieLogin.autoLogin()?!0:this.oAuthLogin.autoLogin()},onOAuthChange:function(t){t.isEnabled("authprovider_oauth_enabled")?this.oAuthLogin.setup(t.get("authprovider_oauth_key")):this.oAuthLogin.teardown()},onCookieChange:function(t){this.cookieLogin.setup(t.get("authprovider_custom_cookie_name"))},onBackplaneChange:function(t){t.isEnabled("authprovider_backplane_v2_enabled")?this.backplaneLogin.setup("2"):t.isEnabled("authprovider_backplane_v1_2_enabled")?this.backplaneLogin.setup("1.2"):this.backplaneLogin.teardown()},onLogin:function(t,e){this.trigger("login",t,e)},onLogout:function(){this.trigger("logout")},onLoginFail:function(t){this.trigger("login:fail",t)},onGigyaPollChange:function(t){t.isEnabled("authprovider_gigya_poll")?this.gigyaLogin.setup():this.gigyaLogin.teardown()}}),l}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(8),i(6),i(9),i(14),i(12)],s=function(t,e,i,n,s,r){var o=function(e){this.session=e,this.popup={width:780,height:492},this.wordPressKey="VFWPAuth",i.bindAll(this,"onSuccess","isWindowClosed","onError"),this.windowDelay=250,this.endpoint=r.api_url_v1,this.popup.top=(t(window).height()-this.popup.height)/2,this.popup.left=(t(window).width()-this.popup.width)/2};return i.extend(o.prototype,e.Events,{setup:function(t){this.active=!0,this.cookieKey="oauth_login_"+t},teardown:function(){this.active=!1},isWindowClosed:function(){this.window&&this.window.closed&&(clearInterval(this.timer),this.login())},openWindow:function(){this.window=window.open(this.getUrl(),"vf_login_window","location=1,scrollbars=0,height="+this.popup.height+",width="+this.popup.width+",top="+this.popup.top+",left="+this.popup.left),this.timer=setInterval(this.isWindowClosed,this.windowDelay)},getToken:function(){var t=s.getItem(this.cookieKey);return t?decodeURIComponent(t):null},isLoggedIntoWordpress:function(){var t=window[this.wordPressKey];return t&&"true"===t.isLoggedin&&this.getToken()},autoLogin:function(){return this.active&&this.isLoggedIntoWordpress()?(this.request({mode:"jsonp",mode_data:this.getToken()}),!0):!1},login:function(){this.request({step:"login"})},getParams:function(t){t=t||{},i.extend(t,{provider:"oauth",callback_base:this.endpoint});var e={json:JSON.stringify({requests:[{api:"user",type:"loginOAuth",params:t}]})};return e.host=location.hostname,e.s=this.session.get(),e.u="login",e},getUrl:function(e){return this.endpoint+"?"+t.param(this.getParams(e))},request:function(e){var i=this.getParams(e);t.ajax({url:this.endpoint,dataType:"jsonp",data:i,success:this.onSuccess,error:this.onError})},onSuccess:function(t){if(t.error)n.trigger("/user/login/fail","OAuth login failed."),this.trigger("login:fail","OAuth login failed.");else{var e=t.requests[0];if(e.error)n.trigger("/user/login/fail",e.error.text),this.trigger("login:fail",e.error.text);else{var s=e.data[0],r=t.users[s];if(i.isArray(r.badges)){for(var o={videostar:0,authoritative:0,active:0,connected:0,engaged:0},a=r.badges.length;a--;)o[r.badges[a]]=1;r.badges=o}r.id=+r.id,""===r.pic_small&&delete r.pic_small,this.trigger("login",t.sid,r)}}},onError:function(){n.trigger("/user/login/fail","OAuth login failed."),this.trigger("login:fail","OAuth login failed.")}}),o}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(8),i(6),i(9),i(14),i(12),i(10)],s=function(t,e,i,n,s,r,o){var a=function(t){i.bindAll(this,"autoLogin","onSuccess","onError"),this.session=t};return i.extend(a.prototype,e.Events,{setup:function(t){this.cookieKey=t,this.listenTo(n,"user.custom_login",this.onCookieLogin)},teardown:function(){this.stopListening()},autoLogin:function(){var t=this.getCookie();return t?this.login(t):!1},login:function(t){return this.loginWithData({site:"viafouraDefinedCookie",cookie:t})},getCookie:function(){return this.cookieKey?s.getItem(this.cookieKey):void 0},onCookieLogin:function(t){this.loginWithData(t)},loginWithData:function(e){var i={json:JSON.stringify({requests:[{api:"user",type:"loginCustom",params:e}]}),u:"login",host:o().domain,s:this.session.get()};return t.ajax({url:r.api_url_v1,data:i,dataType:"jsonp",success:this.onSuccess,error:this.onError}),!0},onSuccess:function(t){var e;t.requests&&t.requests[0].error?e=t.requests[0].error.text:t.error&&(e=t.error.text),e?(n.trigger("/user/login/fail",e),this.trigger("login:fail",e)):this.trigger("login",t.sid)},onError:function(){var t="Cookie login timed out.";n.trigger("/user/login/fail",t),this.trigger("login:fail",t)}}),a}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(8),i(6),i(9),i(12)],s=function(t,e,i,n){var s=function(t){e.bindAll(this,"poll","onSuccess","onError","onBackplaneMessage"),this.restAPI=t,this.loaded=!1,this.active=!1,this.pollDelay=100};return e.extend(s.prototype,t.Events,{setup:function(t){this.active=!0,this.backplaneVersion=t,this.loaded||this.poll()},teardown:function(){this.active=!1,this.backplaneVersion=null},poll:function(){window.Backplane&&("2"===this.backplaneVersion||window.janrain)?this.onBackplaneReady():setTimeout(this.poll,this.pollDelay)},onBackplaneReady:function(){this.loaded=!0,window.Backplane.getChannelID()!==!1&&(window.escSubscription=Backplane.subscribe(this.onBackplaneMessage)),"2"!==this.backplaneVersion&&window.janrain.events.onCaptureSessionEnded.addHandler(this.onJanrainLogout)},onBackplaneMessage:function(t){return this.active?"identity/login"==t.type?("2"===this.backplaneVersion?this.restAPI.request("post","/users/backplane",{messageChannel:t.channel,messageid:t.messageURL},{success:this.onSuccess,error:this.onError}):this.restAPI.request("post","/users/backplane_v1_2",{backplane_id:t.payload.identities.entry.id},{success:this.onSuccess,error:this.onError}),!1):void("identity/logout"==t.type&&this.onJanrainLogout()):void 0},onJanrainLogout:function(){i.trigger("/user/logout/click"),this.trigger("logout")},onSuccess:function(t){this.trigger("login",t.session,t.result)},onError:function(t){i.trigger("/user/login/fail",t.error),this.trigger("login:fail",t.error)}}),s}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(6),i(8),i(9),i(12),i(10)],s=function(t,e,i,n,s,r){var o=function(t){e.bindAll(this,"timer","gigyaLoginHandler","gigyaLogoutHandler","onSuccess","onError","onGetUserInfo"),this.loaded=!1,this.session=t,this.totalTime=6e4};return e.extend(o.prototype,i.Events,{setup:function(){this.active=!0,this.loaded||this.pollForScript()},teardown:function(){this.active=!1},pollForScript:function(){this.timeout=0,this.elapsedTime=0,this.timer()},timer:function(){this.loaded||(window.gigya?(this.loaded=!0,this.addEvents()):this.elapsedTime<this.totalTime&&(this.timeout+=1e3,this.elapsedTime+=this.timeout,setTimeout(this.timer,this.timeout)))},addEvents:function(){window.gigya.socialize.addEventHandlers({onLogin:this.gigyaLoginHandler,onLogout:this.gigyaLogoutHandler}),window.gigya.accounts&&window.gigya.accounts.addEventHandlers({onlogin:this.gigyaLoginHandler,onlogout:this.gigyaLogoutHandler}),window.viafoura.core.current.user.isLoggedIn()||window.gigya.socialize.getUserInfo({callback:this.onGetUserInfo})},onGetUserInfo:function(t){t&&t.user&&t.user.isLoggedIn&&window.gigya.accounts.getAccountInfo({callback:this.gigyaLoginHandler})},gigyaLogoutHandler:function(){this.active&&this.trigger("logout")},gigyaLoginHandler:function(e){if(this.active){var i={json:JSON.stringify({requests:[{api:"user",type:"loginGigya",params:{uid:e.UID,uid_signature:e.UIDSignature,uid_timestamp:e.signatureTimestamp,step:"login"}}]})};i.host=r().domain,i.s=this.session.get(),i.u="login",t.ajax({url:s.api_url_v1,dataType:"jsonp",data:i,success:this.onSuccess,error:this.onError})}},onSuccess:function(t){if(t.requests[0].error)return n.trigger("/user/login/fail",t.requests[0].error.text),void this.trigger("login:fail",t.requests[0].error.text);var e=t.requests[0],i=e.data[0],s=t.users[i];this.trigger("login",t.sid,s)},onError:function(){n.trigger("/user/login/fail","Social login failed."),this.trigger("login:fail","Social login failed.")}}),o}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(8),i(9),i(2),i(12),i(11),i(15)],s=function(t,e,i,n,s,r,o){var a=function(e,i,n){t.bindAll(this),this.api_key=i,this.storageKey="vf_social_token",this.loginRadiusUrl=n,this.restAPI=e,this.loaded=!1,this.loginId=null,this.popup=null,this.loginRadiusReceived=!1,this.listeningMode=null};return t.extend(a.prototype,e.Events,{setup:function(){return this.loaded?!1:(this.loaded=!0,void this.onload())},teardown:function(){this.loaded=!1,window.removeEventListener?window.removeEventListener("message",this.onLoginRadiusEvent,!1):window.detachEvent("onmessage",this.onLoginRadiusEvent)},login:function(t){if(!this.loaded)return!1;switch(t){case"facebook":case"google":case"twitter":case"linkedin":case"yahoo":case"paypal":return this.triggerFlow(t),!0;case"live_id":return this.triggerFlow("live"),!0;case"aol":return this.triggerFlow("http://openid.aol.com"),!0;case"vkontakte":case"amazon":case"disqus":case"foursquare":case"github":case"hyves":case"instagram":case"kaixin":case"livejournal":case"mixi":case"odnoklassniki":case"openid":case"orange":case"persona":case"qq":case"renren":case"salesforce":case"sinaweibo":case"stackexchange":case"steamcommunity":case"verisign":case"virgilio":case"wordpress":default:return!1}},triggerFlow:function(t){this.loginId=this.restAPI.session;var e=(s.api_url_root+"/callback.php?site="+this.restAPI.site+"&id="+this.loginId).replace("&","%26");this.launchWindow(this.loginRadiusUrl+"?apikey="+this.api_key+"&provider="+t+"&same_window=1&callback="+encodeURIComponent(e))},launchWindow:function(t){var e=this;"poll"===this.listeningMode&&this.startPolling(),this.popup=this.openWindow(t,"Window","menubar=0,resizable=1,width=450,height=500");var i=setInterval(function(){e.popup&&e.popup.closed&&(e.loginRadiusReceived===!1&&e.onLoginRadiusLoginCancel(),e.loginRadiusReceived=!1,clearInterval(i))},500);return!1},openWindow:function(t,e,i){return window.open(t,e,i)},fetchUserWithToken:function(t){this.restAPI.request("post","/users/sociallogin",{token:t},{success:this.onLoginSuccess,error:this.onLoginError})},onLoginRadiusLoginToken:function(t){this.fetchUserWithToken(t)},onLoginRadiusLoginCancel:function(){i.trigger("/user/login/social/cancel")},onLoginRadiusLoginError:function(t){i.trigger("/user/login/social/error",t.err.msg)},onLoginSuccess:function(t){this.trigger("login",t.session,t.result)},onLoginError:function(t){if(t.message&&"Token not found"===t.message)return!1;var e="Error logging into social account.";t.error&&(e=t.error),this.trigger("login:fail",e),i.trigger("/user/login/social/fail",e),i.trigger("/user/login/fail",e)},onLoginRadiusEvent:function(t){switch(this.listeningMode){case"poll":this.fetchUserWithToken(t.token),this.loginRadiusReceived=!0;break;case"post":(t.origin==s.api_url_root||t.origin==location.origin)&&null!=t.data&&t.data.match(/^\{?[A-Z0-9]{8}-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{12}\}?$/i)&&(this.fetchUserWithToken(t.data),this.loginRadiusReceived=!0,this.popup&&(this.popup.focus(),this.popup.close()));break;default:r.assert(!1,"Listening mode undefined")}},poll:function(){this.loginId&&this.popup.closed&&(this.restAPI.request("get","/users/logincache/get",{id:this.loginId},{success:this.onLoginRadiusEvent,error:this.onLoginError}),clearInterval(this.intId),this.loginId=null)},startPolling:function(){this.intId=setInterval(this.poll,100)},startListening:function(){window.addEventListener?window.addEventListener("message",this.onLoginRadiusEvent,!1):window.attachEvent("onmessage",this.onLoginRadiusEvent)},onload:function(){var t=o.getIEVersion(),e=o.insideWebview();0!=t&&9>=t||11==t||e?this.listeningMode="poll":(this.listeningMode="post",this.startListening())}}),a}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(6),i(15),i(38)],s=function(t,e,i,n){var s=function(){this.widgetCount=0,this.widgets={},this.elements={},this.modules={},this.dom_ready=!1};return e.extend(s.prototype,{register:function(t){if(!(t&&t.name&&t.create&&t.loadDeps))throw"Could not register widget";this.widgets[t.name]=t},addWidget:function(t,e,i){this.modules[i]=this.widgets[t].create.call(viafoura.core,e)},unregister:function(t){if(!this.widgets[t])throw"Could not find widget "+t;delete this.widgets[t]},poll:function(n){function s(){t(".vf-widget").each(function(n,s){var o=t(s),a=o.data().widget;if(!e.contains(r.elements,s)&&r.widgets[a]){var o=t(s),l=++r.widgetCount;o.attr("data-widget-id",l),o.toggleClass("vf-mobile",i.isMobile()),r.elements[l]=s,r.widgets[a].loadDeps(function(){r.addWidget(a,s,l)})}}),r.dom_ready?n&&n():setTimeout(s,50)}var r=this;s(),t(document).ready(function(){r.dom_ready=!0})},removeAll:function(){var i=this;e.each(this.elements,function(t,e){delete i.elements[e]}),e.each(i.modules,function(e,n){if(e.remove&&"function"==typeof e.remove){var s=t(document.createElement("div")),r=e.$el,o=r.children();r.append(s),e.setElement(s),o.detach(),s.append(o),e.remove()}delete i.modules[n]})}}),s}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(19),i(2),i(6)],s=function(t,e,n){return function(){function s(t){var e=this;return this._defaultFn=t,function(t,i){return e._defaultFn(t,i)}}var r={},o=function(e){if(e instanceof Array)for(var i=e.length;i--;)r[e[i]]&&t.registerPartial(e[i],r[e[i]]);else if("object"==typeof e)for(var n in e)e.hasOwnProperty(n)&&r[e[n]]&&t.registerPartial(n,r[e[n]])},a=new s(function(t,e){return e&&o(e),r[t]});a.loadDefaultTemplates=function(){i.e(1,function(t){var e=[t(39)];(function(t){this.loadTemplates(t)}).apply(null,e)})},a.loadTemplates=function(t){n.extend(r,t)},a.format=function(e){e=t.Utils.escapeExpression(e);var i=(e+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1 <br> $2");return i};var l=function(t,e,i,n){n=n||"";for(var s=1;3>s;s++){var r=i.length-s;if("("===t[0]&&")"===i[r]){n=i.substr(r)+n,i=i.substr(0,r);break}}return t+'<a href="'+i+'" target="_blank">'+e+"</a>"+n};return a.formatLinks=function(t){var e,i,n,s=a.format(t);return e=/(^|.)((https?|ftp):\/\/[\-A-Z0-9+&@#\/%?=~_|!:,.;\(\)]*[\(\)\-A-Z0-9+&@#\/%=~_|])/gim,s=s.replace(e,function(t,e,i){return l(e,i,i)}),i=/(^|[^\/])(www\.[\S]+(\b|$))/gim,s=s.replace(i,function(t,e,i,n){return l(e,i,"http://"+i,n)}),n=/(\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,6})/gim,s=s.replace(n,'<a href="mailto:$1">$1</a>')},t.registerHelper("withFirstDefined",function(){var t,i,n=e.makeArray(arguments),s=n.pop(),r=n;for(t=0,i=r.length;i>t;t++)if("undefined"!=typeof r[t])return s.fn(r[t])}),t.registerHelper("format",a.format),t.registerHelper("formatLinks",a.formatLinks),t.registerHelper("isEqual",function(t,e,i){return t===e?i.fn(this):i.inverse(this)}),t.registerHelper("anyEqual",function(t){var e=[].slice.call(arguments,1),i=n(arguments).last();for(var s in e)if(t===e[s])return i.fn(this);return i.inverse(this)}),t.registerHelper("isNot",function(t,e,i){return t!==e?i.fn(this):i.inverse(this)}),a}()}.apply(e,n),!(void 0!==s&&(t.exports=s))},,function(t,e,i){var n,s;n=[i(2),i(6),i(8),i(21),i(22),i(9),i(13),i(12),i(41),i(15)],s=function(t,e,i,n,s,r,o,a,l,u){var c=function(t,i,n){this.session=t,this.user=i,this.ability=new l(n),e.bindAll(this,"onLogin","onLogout","onUserLoaded"),this.listenTo(r,"/user/login",this.login),this.listenTo(r,"/user/logout/click",this.logout),this.listenTo(r,"/user/create",this.signup),this.listenTo(r,"/user/edit",this.editUser),this.listenTo(r,"/session/found",this.setSession),this.listenTo(r,"user.logout",this.logout)};return e.extend(c.prototype,i.Events,{detectSession:function(){var e,i=t("#viafoura-platform").data();return e=i&&i.sid?i.sid:o.getItem(n.sessionKey),this.setSession(e)},fetchUser:function(t){this.user.reset({silent:!0}),t=e.extend({current:!0,wait:!0,batch:!0},t),t.success=u.wrap(t.success,this.onUserLoaded),this.user.fetch(t)},login:function(t,i,n){n=n||{},this.user.reset({silent:!0}),n.success=u.wrap(n.success,this.onLogin),n=e.extend({},n,{login:!0,wait:!0}),this.user.save({email:t,password:i,fingerprint:""},n)},logout:function(){this.user.destroy({logout:!0,batch:!1}),this.clear(),this.fetchUser({success:this.onLogout})},signup:function(t,i){i=i||{},t.login=!0,this.user.reset({silent:!0}),i.success=u.wrap(i.success,this.onLogin),this.user.save(t,e.extend({},i,{wait:!0}))},editUser:function(t,e){this.user.save(t,e)},setSession:function(t){return this.session.set(t)?(this.trigger("session:change",t),!0):!1},resetUser:function(t,e){return this.setSession(t)?(e?(this.user.clear({silent:!0}),this.user.set(e)):this.user.reset(),this.ability.loadPermissions(this.user),!0):!1},clear:function(){this.session.destroy(),this.user.reset()},isLoggedIn:function(){return this.user.isLoggedIn()},onUserLoaded:function(){this.ability.loadPermissions(this.user)},onLogout:function(){r.trigger("/user/logout"),this.trigger("logout")},onLogin:function(t){this.onUserLoaded(),r.trigger("/user/login/success",this.user)}}),c}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(27),i(22),i(28),i(15)],s=function(t,e,i,n,s){var r=function(t){this.settings=t,this.permissions=[],this.type="none"};return r.prototype={loadPermissions:function(t){this.permissions=[],this.type="none",t.isLoggedIn()?(this.type="user",t.isAdmin()?(this.type="admin",this.can("moderate",e)):t.isModerator()&&(this.type="mod",this.can("moderate",e)),this.can("create",e),this.can("like",e),this.settings.get("enable_dislikes")&&this.can("dislike",e),this.can("update",e,function(e){return e.page.isClosed()?!1:e.isSpam()||e.isDisabled()||e.isRemoved()?!1:0===this.settings.get("enable_user_comment_editing")?!1:e.hasEditTimeLeft()?e.get("user_id")==t.id&&0===e.get("editor_pick"):!1}),this.can("remove",e,function(e){return 0===this.settings.get("enable_user_comment_remove")?!1:e.isSpam()||e.isDisabled()||e.isRemoved()?!1:e.page.isClosed()?!1:e.hasEditTimeLeft()?e.get("user_id")==t.id:!1}),this.can("flag",e,function(t){return!t.user.isModOrAdmin()}),this.can("update",i,function(e){return e.id===t.id}),this.can("updateAvatar",i,function(e){return e.id===t.id&&!e.isSocialAccount()&&this.settings.isDisabled("disable_cookie_avatars")}),this.can("updatePassword",i,function(e){return e.id===t.id&&e.isViafouraAccount()&&this.settings.isDisabled("disable_widget_logins")}),this.can("updateName",i,function(e){return e.id===t.id&&(e.isCustomAccount()||e.isViafouraAccount())&&this.settings.isDisabled("disable_cookie_displayname")}),this.can("updateEmail",i,function(e){return e.id===t.id&&e.isViafouraAccount()}),this.can("updateNotifications",i,function(e){return e.id===t.id&&this.settings.isDisabled("disable_email_notifications")&&e.has("email")}),this.can("record"),this.can("uploadVideo"),this.can("uploadImage"),this.can("follow",n),this.can("follow",i,function(e){return e.id!==t.id}),this.can("rate",n)):t.isBanned()?this.type="banned":t.isGuest()&&(this.type="guest",this.can("create",e,function(t){return this.settings.isEnabled("enable_anonymous_comments")&&"string"==typeof t.get("anonymous_name")&&t.get("anonymous_name").length>0}))},typeIs:function(t){return this.type===t},check:function(t,e){for(var i=0;i<this.permissions.length;i++){var n=this.permissions[i];if(void 0===n.type||e instanceof n.type){if("manage"===n.action)return!0;if(n.action===t)return n.condition?n.condition.call(this,e):!0}}return!1},has:function(e,i,n){return!!t.find(this.permissions,function(t){return t.action===e&&t.type===i&&t.condition===n})},can:function(t,e,i){i||this.cannot(t,e),this.permissions.push({action:t,type:e,condition:i})},cannot:function(e,i){this.permissions=t.filter(this.permissions,function(t){return!(t.action===e&&t.type===i)})}},r}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(8),i(6),i(2),i(9),i(43),i(11),i(44),i(15),i(12),i(45)],s=function(t,e,i,n,s,r,o,a,l){var u=function(t,i,r){e.bindAll(this,"onTimeoutFinish","onSuccess"),this.batchDelay=250,this.requestLengthLimit=1900,this.progressKey="X-Progress-ID",this.batch=new s,this.waitingBatch=new s,this.forceBatchOff=!1,this.setAPIUrl(t),this.setSite(i),this.setSection(r),this.listenTo(n,{"/services/request":this.request,"/services/settings":this.request,"/services/pages":this.request,"/services/bans":this.request,"/services/users":this.request,"/services/comments":this.request,"/services/threads":this.request,"/services/media":this.request,"/services/sections":this.request,"/services/section_tree":this.request,"/user/forgot_password/submit":this.password})};return e.extend(u.prototype,t.Events,{destroy:function(){this.stopListening()},ajax:function(t,e,n,s){n=n||{},n.xhr&&r.assert(a.supportXDomain()||a.supportCORS(),"ajaxXHR not supported");var o={type:n.xhr?"POST":"GET",dataType:n.xhr?"json":"jsonp",url:t,data:this.JSONPWrap(e),success:s};return n.xhr&&a.supportXDomain()&&(o.xDomain=!0,o.url=this.matchHostProtocol(window.location.protocol,o.url)),i.ajax(o)},matchHostProtocol:function(t,e){return"https:"===t&&null!==e.match(/^http:/)?e.replace(/^http/,"https"):"http:"===t&&null!==e.match(/^https:/)?e.replace(/^https/,"http"):e},add:function(t){return this.batch.add(t);
},checkRequestLength:function(){for(var t=[];this.getTotalLength()>this.requestLengthLimit&&this.batch.length();){var e=this.batch.pop();this.getSingleRequestLength(e)>this.requestLengthLimit&&(a.supportXDomain()||a.supportCORS())&&(e.options.xhr=!0,e.options.batch=!1),t.push(e)}return t.length?(0===this.batch.length()&&1===t.length?a.supportXDomain()||a.supportCORS()?this.batch.requests=this.batch.requests.concat(t):this.failAll(t):(this.run(),this.batch.requests=this.batch.requests.concat(t)),!0):!1},startTimer:function(){return this.timer?!1:(this.timer=setTimeout(this.onTimeoutFinish,this.batchDelay),!0)},onTimeoutFinish:function(){this.timer=!1,this.run()},createRequest:function(t,i,n,s){var r=e.clone(n);return void 0!==r&&(void 0===r.section&&void 0!==this.section&&(r.section=this.section),null===r.section&&delete r.section),s.section===!1&&delete r.section,"/"!==i.charAt(0)&&(i="/"+i),new o(t,i,r,s)},prepareRequests:function(){this.waitingBatch.add(this.batch.requests),this.batch.reset()},run:function(){if(!this.batch.isEmpty()){var t=this.batch.toData(),e=this.batch.canUseXHR(),i=this.apiUrl;r.enabled()&&(i+=this.getDebugURL()),this.prepareRequests(),this.ajax(i,{requests:t},{xhr:e&&(a.supportCORS()||a.supportXDomain())},this.onSuccess)}return this},failAll:function(t){setTimeout(function(){for(;t.length;){var e=t.pop();e.handle({http_status:403,error:"Request too long"})}},50)},onSuccess:function(t){var e=t.responses;for(var i in e)this.handleRequestResponse(e[i],i)},handleRequestResponse:function(t,e){t.session&&n.trigger("/session/found",t.session);var i=this.waitingBatch.find(e);r.assert(i,"Request could not be found "+e),i&&(l.APIMiddleware&&(t=l.APIMiddleware(i,t)),i.handle(t),this.waitingBatch.remove(i.id))},getDebugURL:function(){for(var t="",e=this.batch.requests,i=[],n=0;n<e.length;n++){var s=e[n];i.push(s.route+"="+s.verb)}return t+=-1!==t.indexOf("?")?"&":"?",i.push("debug=true"),t+=i.join("&")},toJSON:function(){return this.JSONPWrap({requests:this.batch.toData()})},getTotalLength:function(){return encodeURIComponent(this.toJSON().json).length},getSingleRequestLength:function(t){var e={};return e[t.id]=t.toData(),encodeURIComponent(this.JSONPWrap({requests:e}).json).length},addParams:function(t){var i=e.extend({site:this.site},t);return this.session&&(i.session=this.session),i},JSONPWrap:function(t){var e=this.addParams(t);return{json:JSON.stringify(e)}},setSession:function(t){this.session=t},setSite:function(t){this.site=t},setAPIUrl:function(t){this.apiUrl=t},setSection:function(t){this.section=t},request:function(t,e,i,n){"object"==typeof t&&(e=t.route,i=t.data,n=t,t=n.verb||"get",delete n.verb,delete n.route,delete n.data),n=n||{};var s=this.createRequest(t,e,i,n);this.add(s)?(n.xhr||this.checkRequestLength(),n.batch&&!this.forceBatchOff?this.startTimer():this.run()):r.assert(!1,"Duplicate request "+s.id)},getTrackUploadPath:function(t){var e=l.api_url.split("v2")[0]+"track_upload?"+this.progressKey+"="+t+"&session="+this.session;return e},trackUpload:function(t,e){var n=this.getTrackUploadPath(t);i.ajax({url:n,dataType:"jsonp",success:a.wrap(e.success,l.APITrackUpload)})},password:function(t,e,i){this.request("post","/account/password",{email:t},{success:e,error:i})}}),u}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(44)],s=function(t,e){var i=function(){this.requests=[],this.removed=[]};return i.prototype={add:function(e){t.isArray(e)||(e=[e]);for(var i,n=0;n<e.length;n++)if(i=e[n],this.has(i))return!1;for(var s=0;s<e.length;s++)i=e[s],this.requests.push(i);return!0},canUseXHR:function(){return 1==this.length()&&this.requests[0].options.xhr===!0},has:function(t){return!!this.find(t)},length:function(){return this.requests.length},find:function(e){return e.id&&(e=e.id),t.find(this.requests,function(t){return t.id===(0|e)})},findByRoute:function(e,i){return t.find(this.requests,function(t){return t.verb===e&&t.route===i})},pop:function(){return this.requests.pop()},remove:function(t){t.id&&(t=t.id);for(var e=0;e<this.requests.length;e++){var i=this.requests[e];if(i.id===(0|t)){var n=this.requests.splice(e,1)[0];return this.removed.push(n),n}}},reset:function(){this.requests=[]},isEmpty:function(){return t.isEmpty(this.requests)},toData:function(){var e={};return t.each(this.requests,function(t){e[t.id]=t.toData()}),e}},i}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(9)],s=function(t,e){var i=function(e,n,s,r){t.bindAll(this,"success","error","XHRError"),this.id=++i._id,this.verb=e,this.route=n,this.data=s,this.options=r||{},this.options.data={},this.options.data.verb=this.verb,this.options.data.route=this.route,this.handled=!1};return i._id=0,i.prototype={handle:function(t){this.isSuccessful(t.http_status)?this.success(t):this.error(t)},success:function(t){this.options.success&&this.options.success(t,this.options,t.http_status),this.handled=!0},error:function(t){this.options.error&&this.options.error(t,this.options,t.http_status),this.handled=!0},XHRError:function(t){var e;try{e=JSON.parse(t.responseText)}catch(i){e={api_code:0,http_status:500}}this.error(e,this.options,t.status),this.handled=!0},isSuccessful:function(t){return t>=200&&299>=t},toData:function(){var e=t.extend({},this.data);return t.extend(e,{verb:this.verb,route:this.route})}},i}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2)],s=function(t){window.XDomainRequest&&t.ajaxTransport(function(e){if(e.xDomain&&e.async){e.timeout&&(e.xdrTimeout=e.timeout,delete e.timeout);var i;return{send:function(n,s){function r(e,n,r,o){i.onload=i.onerror=i.ontimeout=i.onprogress=t.noop,i=void 0,s(e,n,r,o)}i=new XDomainRequest,i.open(e.type,e.url),i.onload=function(){r(200,"OK",{text:i.responseText},"Content-Type: "+i.contentType)},i.onerror=function(){r(403,"Server error")},i.onprogress=function(){},e.xdrTimeout&&(i.ontimeout=function(){r(0,"timeout")},i.timeout=e.xdrTimeout),i.send(e.hasContent&&e.data||null)},abort:function(){i&&(i.onerror=t.noop(),i.abort())}}}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(12),i(6),i(9),i(15)],s=function(t,e,i,n){function s(t){this.socket=null,this.pingTimer=null,this.lastPing=[],this.sendQueue=[],this.subscriptions={},this.manualClose=!1,this.options=e.defaults(t||{},{maxPingList:3,strictPing:!1,retries:5,pingTimeoutMs:3e4,connectingTimeoutMs:5e3}),this.retries=this.options.retries}return e.extend(s.prototype,i,{connect:function(){if(!("WebSocket"in window))return this.trigger("status","unsupported"),this;if(this.socket)switch(this.socket.readyState){case WebSocket.OPEN:case WebSocket.CONNECTING:return this;case WebSocket.CLOSING:case WebSocket.CLOSED:this.close()}return this.trigger("status","connecting"),this.socket=new WebSocket(t.realtime_socket),this.socket.onopen=this.onOpen.bind(this),this.socket.onclose=this.onClose.bind(this),this.socket.onmessage=this.onMessage.bind(this),this.socket.onerror=function(e){t.debug&&console.log(e),this.trigger("status","disconnected"),this.close()}.bind(this),this},ping:function(){this.pingTimer||(this.pingTimer=setInterval(function(){var t=(new Date).getTime();this.lastPing.push(t),this.lastPing.length>this.options.maxPingList&&this.lastPing.shift(),this.send({action:"ping",time:t})}.bind(this),this.options.pingTimeoutMs))},send:function(t){this.sendQueue.push(t),this.flushQueue()},flushQueue:function(){if(this.socket)switch(this.socket.readyState){case WebSocket.OPEN:for(var t=null;t=this.sendQueue.shift();)this.socket.send(JSON.stringify(t));break;case WebSocket.CONNECTING:}},subscribe:function(t,i){var n={},s=i||e.uniqueId("s");return n[s]=this.subscriptions[s]=t,this.connect().send({action:"subscribe",filters:n}),s},subscribePage:function(t){return this.subscribe({page_uuid:[n.toUuid(t)]})},unsubscribe:function(t){var i=e.clone(this.subscriptions,!0);e.each(this.subscriptions,function(n,s){if("string"==typeof t&&s===t||e.isEqual(t,n)){var r={};r[s]=n,this.connect().send({action:"unsubscribe",filters:r}),delete i[s]}},this),this.subscriptions=i,e.size(this.subscriptions)||this.close(!0)},unsubscribePage:function(t){this.unsubscribe({page_uuid:[n.toUuid(t)]})},unsubscribeAll:function(){this.subscriptions={},this.close(!0)},close:function(e){t.debug&&console.log("close: ",arguments),this.manualClose=!!e,this.socket&&this.socket.close(),this.pingTimer&&(clearInterval(this.pingTimer),this.pingTimer=null)},onClose:function(i){this.trigger("status","disconnected"),!this.manualClose&&this.retries>0&&(t.debug&&console.log("connection unexpectedly closed, retrying: ",i),this.retries--,e.each(this.subscriptions,function(t,e){this.connect().subscribe(t,e)}.bind(this))),this.manualClose=!1},onMessage:function(t){var e=[];if(t&&t.data){if("string"==typeof t.data)try{e=JSON.parse(t.data)}catch(i){}else"object"==typeof t.data&&(e=t.data);!e||e instanceof Array||(e=[e])}for(var n=null;n=e.shift();)if(n.action)switch(n.action){case"subscribe":this.subscribeCallback(n);break;case"pong":this.pongCallback(n)}else n.event_type?this.trigger("content",n):n.filters&&this.subscribeCallback(n)},onOpen:function(){this.ping(),this.trigger("status","connected"),this.flushQueue()},subscribeCallback:function(i){this.trigger("subscribe",i),i.filters&&e.each(i.filters,function(e,i){if(!e.status||"OK"!==e.status){if(t.debug){var n=e.message?" ("+e.message+")":"",s=e.code?"[Error "+e.code+"] ":"";console.log(s+"Subscription failed, removing. "+i+n)}delete this.subscriptions[i]}}.bind(this))},pongCallback:function(i){-1===e.indexOf(this.lastPing,i.time)?(t.debug&&console.log("expired or unknown pong: "+i.time),this.options.strictPing&&this.close()):t.debug&&console.log("ping latency: "+(Date.now()-i.time)+"ms")}}),new s}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6)],s=function(t){var e=function(t){this.app=t,this.modules={}};return t.extend(e.prototype,{hasModule:function(t){return"string"==typeof t&&!!this.modules[t]},add:function(t,e){return"string"!=typeof t||"function"!=typeof e?!1:(this.modules[t]=new e(this.app),!0)},remove:function(t){return this.hasModule(t)?(delete this.modules[t],!0):!1},start:function(t){return this.hasModule(t)?(this.modules[t].start(this.app),!0):!1},stop:function(t){return this.hasModule(t)?(this.modules[t].stop(this.app),!0):!1},startAll:function(){var e=this;t.each(this.modules,function(t,i){e.start(i)})},stopAll:function(){var e=this;t.each(this.modules,function(t,i){e.stop(i)})}}),e}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(49)],s=function(t){return t.extend({initialize:function(){},start:function(t){this.app=t,this.listenTo(t.current.settings,"change:enable_google_analytics",this.trackPageview)},stop:function(t){this.stopListening()},loadGaq:function(){var t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js",t.parentNode.insertBefore(e,t)},trackPageview:function(){if(this.app.current.settings.isEnabled("enable_google_analytics")){window._gaq||(this.loadGaq(),window._gaq=[]),window._gaq.push(["viafoura._setAccount","UA-6452517-6"]),window._gaq.push(["viafoura._setDomainName",(location.hostname.indexOf(".")>-1?".":"")+location.hostname]),window._gaq.push(["viafoura._trackPageview"]);var t=this.app.locations.section;void 0!==t&&"root"!==t&&window._gaq.push(["viafoura._setCustomVar",1,"Section",t,3])}}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(8)],s=function(t,e){var i=function(e){t.isFunction(this.initialize)&&this.initialize.apply(this,arguments)};return i.extend=e.Model.extend,t.extend(i.prototype,e.Events,{start:function(t){},stop:function(){}}),i}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(51),i(2),i(6),i(52),i(15),i(19)],s=function(t,e,i,n,s,r){var o=n.extend({initialize:function(t){this.settings=t,i.bindAll(this,"renderTooltip","tipTemplate"),e.fn.tipsy.defaults.templateMethod=this.renderTooltip,e.fn.tipsy.defaults.tipTemplate=this.tipTemplate},start:function(){s.isMobile()||e(".viafoura .vf-tip").tipsy({gravity:e.fn.tipsy.autoSEW,live:!0})},refresh:function(){var t=this.settings.toJSON();this.tooltipDatas={login:{content:{description:this.i18n("tooltip_login_desc")}},facebook:{content:{description:this.i18n("share_facebook")}},twitter:{content:{description:this.i18n("share_twitter")}},email:{content:{description:this.i18n("share_email")}},viafoura_login_info:{content:{title:"Viafoura",description:this.i18n("viafoura_about")}},trusted:{content:{title:this.i18n("title_trusted"),description:this.i18n("title_trusted_desc")}},connected:{content:{title:this.i18n("badge_connected_hdr"),description:this.i18n("badge_connected_desc",t.badging_connected_repliesmade,t.badging_connected_days)}},engaged:{content:{title:this.i18n("badge_engaged_hdr"),description:this.i18n("badge_engaged_desc",t.badging_engaged_commentsmade,t.badging_engaged_likesmade,t.badging_engaged_days)}},authoritative:{content:{title:this.i18n("badge_authoritative_hdr"),description:this.i18n("badge_authoritative_desc",t.badging_authoritative_likesreceived,t.badging_authoritative_repliesreceived,t.badging_authoritative_days)}},videostar:{content:{title:this.i18n("badge_video_star_hdr"),description:this.i18n("badge_video_star_desc",t.badging_videostar_videosmade,t.badging_videostar_days)}},active:{content:{title:this.i18n("badge_active_hdr"),description:this.i18n("badge_active_desc",t.badging_active_commentsmade,t.badging_active_days)}},"subscribe-page":{content:{description:this.i18n("subscribe_page_desc")}},"unsubscribe-page":{content:{description:this.i18n("unsubscribe_page_desc")}},"subscribe-user":{content:{description:this.i18n("subscribe_user_desc")}},"unsubscribe-user":{content:{description:this.i18n("unsubscribe_user_desc")}},"over-char-limit":{content:{limit:t.comment_max_length}},"realtime-toggle-on":{content:{description:this.i18n("realtime_toggle_on")}},"realtime-toggle-off":{content:{description:this.i18n("realtime_toggle_off")}},"smartmod-toggle-enable":{content:{description:this.i18n("smartmod_toggle_enable")}},"smartmod-toggle-disable":{content:{description:this.i18n("smartmod_toggle_disable")}},"page-settings-disabled":{content:{description:this.i18n("page_settings_disabled")}}}},renderTooltip:function(t,i){var n=this.tooltipDatas[t];return n||(n={content:{description:this.i18n(t)}}),e(this.template(n,i))},tipTemplate:function(){return e(this.template({},"tooltip"))}});return o}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(6)],s=function(t,e){function i(t,e){return"function"==typeof t?t.call(e):t}function n(t){for(;t==t.parentNode;)if(t==document)return!0;return!1}function s(i,n,s){e.bindAll(this,"clearCloseTimer"),this.leave=n,this.$element=t(i),this.timeoutId=0,this.options=s,this.enabled=!0,this.fixTitle()}s.prototype={show:function(){var i=this.getTitle();if(i&&this.enabled){var n=this.tip();if(n.is(":visible"))return;n.find(".vf-tipsy-inner")[this.options.html?"html":"text"](i),n[0].className="viafoura vf-tipsy",n.remove().css({top:0,left:0,visibility:"hidden",display:"block"});var s=t(".vf-tipsy").filter(":last");void 0!==s[0]?n.insertAfter(s):n.prependTo(document.body),this.positionTip(),this.positionTip();var r=this;this.options.fade?n.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity},300,function(){r.options.onOpen(r)}):(n.css({visibility:"visible",opacity:this.options.opacity}).addClass("vf-tip-animate"),this.options.onOpen(this)),this.options.interactive&&(this.$tip.on("mouseenter.tip",this.clearCloseTimer),this.$tip.on("mouseleave.tip",e.bind(this.leave,this.$element[0])))}},positionTip:function(){var e,n=this.$tip,s=t.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),r=n[0].offsetWidth,o=n[0].offsetHeight,a=i(this.options.gravity,this.$element[0]);switch(a.charAt(0)){case"n":e={top:s.top+s.height+this.options.offset,left:s.left+s.width/2-r/2};break;case"s":e={top:s.top-o-this.options.offset,left:s.left+s.width/2-r/2};break;case"e":e={top:s.top+s.height/2-o/2,left:s.left-r-this.options.offset};break;case"w":e={top:s.top+s.height/2-o/2,left:s.left+s.width+this.options.offset}}var l=n.find(".vf-tipsy-arrow").outerWidth(),u=Math.round(s.left+this.$element.outerWidth()/2),c=Math.round(t(window).width()-(s.left+this.$element.outerWidth()/2)),h=(n.outerWidth()-n.width())/2,d=this.options.styleTipOffsetWE+l/2;if(2==a.length)if("w"==a.charAt(1)){if(e.left=s.left+s.width/2-30,d>u){var f=u-l/2>=h?u-l/2:h;n.find(".vf-tipsy-arrow, .vf-tipsy-arrow-border").css("left",f)}}else if(e.left=s.left+s.width/2-r+30,d>c){var f=c-l/2>=h?c-l/2:h;n.find(".vf-tipsy-arrow, .vf-tipsy-arrow-border").css("right",f)}e.left<0&&(e.left=0),n.css(e).addClass("vf-tipsy-"+a),n.find(".vf-tipsy-arrow")[0].className="vf-tipsy-arrow vf-tipsy-arrow-"+a.charAt(0),n.find(".vf-tipsy-arrow-border")[0].className="vf-tipsy-arrow-border vf-tipsy-arrow-border-"+a.charAt(0),this.options.className&&this.$tip.addClass(i(this.options.className,this.$element[0]))},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){t(this).remove()}):this.tip().remove()},setTitle:function(t){t&&(this.options.title=t)},fixTitle:function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-title"))&&t.attr("data-title",t.attr("title")||"").removeAttr("title")},getTitle:function(){var t,e=this.$element,i=this.options;this.fixTitle();var t,i=this.options;"string"==typeof i.title?t="data-title"==i.title||"title"==i.title?e.attr("title"==i.title?"data-title":i.title):i.title:"function"==typeof i.title&&(t=i.title.call(e[0]));var n=i.templateMethod(t||i.fallback,e.attr("data-template")||i.template);return this.options.onCreate(n),n},tip:function(){return this.$tip||(this.$tip=this.options.tipTemplate(),this.$tip.data("vf-tipsy-pointee",this.$element[0])),this.$tip},validate:function(){this.$element[0].parentNode||this.remove()},remove:function(){this.hide(),this.$element.removeData("tipsy"),this.$element.off(".tip"),this.$element=null,this.options.onClose(this),this.options=null},clearCloseTimer:function(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=0)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled}},t.fn.tipsy=function(i){function n(e){var n=t.data(e,"tipsy");return n||(n=new s(e,o,t.fn.tipsy.elementOptions(e,i)),t.data(e,"tipsy",n)),n}function r(){var t=n(this);t.hoverState="in",0==i.delayIn?t.show():(t.fixTitle(),setTimeout(function(){"in"==t.hoverState&&t.show()},i.delayIn))}function o(){var t=n(this);t.hoverState="out",0==i.delayOut?t.hide():(t.clearCloseTimer(),t.timeoutId=setTimeout(function(){"out"==t.hoverState&&t.hide()},i.delayOut))}if(i===!0)return this.data("tipsy");if("string"==typeof i){var a=this.data("tipsy");return a&&a[i].apply(a,e.rest(arguments)),this}if(i=t.extend({},t.fn.tipsy.defaults,i),i.live||this.each(function(){n(this)}),"manual"!=i.trigger){var l="hover"==i.trigger?"mouseenter":"focus",u="hover"==i.trigger?"mouseleave":"blur";i.live?(t(this.context).on(l+".tip",this.selector,r),i.stayOpen||t(this.context).on(u+".tip",this.selector,o)):(this.on(l+".tip",r),i.stayOpen||this.on(u+".tip",o))}return this},t.fn.tipsy.elementOptions=function(e,i){return t.metadata?t.extend({},i,t(e).metadata()):i},t.fn.tipsy.autoNS=function(){return t(this).offset().top>t(document).scrollTop()+t(window).height()/2?"s":"n"},t.fn.tipsy.autoWE=function(){return t(this).offset().left>t(document).scrollLeft()+t(window).width()/2?"e":"w"},t.fn.tipsy.autoSEW=function(){var e=t(this),i=e.offset().left>t(document).scrollLeft()+t(window).width()/2?"e":"w";return"s"+i},t.fn.tipsy.defaults={className:null,delayIn:0,delayOut:0,fade:!1,fallback:"",gravity:t.fn.tipsy.autoSEW,html:!0,live:!1,stayOpen:!1,offset:6,opacity:1,title:"title",trigger:"hover",templateMethod:null,template:"title",tipTemplate:null,styleTipOffsetWE:22,onCreate:function(){},onOpen:function(){},onClose:function(){},interactive:!1},t.fn.tipsy.revalidate=function(){t(".vf-tipsy").each(function(){var e=t.data(this,"vf-tipsy-pointee");e&&n(e)||t(this).remove()})},t.fn.tipsy.autoBounds=function(e,i){return function(){var n={},s=t(document).scrollTop()+e,r=t(document).scrollLeft()+e,o=t(this);return i.length>1?(n.ns=i[0],n.ew=i[1]):"e"==i[0]||"w"==i[0]?n.ew=i[0]:n.ns=i[0],o.offset().top<s&&(n.ns="n"),o.offset().left<r&&(n.ew="w"),t(window).width()+t(document).scrollLeft()-(o.offset().left+o.width())<e&&(n.ew="e"),t(window).height()+t(document).scrollTop()-(o.offset().top+o.height())<e&&(n.ns="s"),n.ns?n.ns+(n.ew?n.ew:""):n.ew}}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(8),i(2),i(38),i(23),i(17),i(53),i(54)],s=function(t,e,i,n,s,r,o,a){var l=e.View.extend(t.extend(o,r,a,{_configure:function(i){if(e.View.prototype._configure.apply(this,arguments),this.restAPI=this.options.restAPI||l.core.restAPI,this.domainSettings=this.options.domainSettings||l.core.current.settings,this.currentPage=this.options.currentPage||l.core.current.page,this.currentUser=this.options.currentUser||l.core.current.user,this._i18n=this.options.i18n||l.core.i18n,this.loginManager=this.options.loginManager||l.core.loginManager,this.userManager=this.options.userManager||l.core.userManager,this.locations=this.options.locations||l.core.locations,this.mixins)for(var n=0;n<this.mixins.length;n++)t.extend(this,this.mixins[n])},$body:i("body"),template:function(e,s,r){var o=n(s||t.result(this,"templateName"),r)(e);return i.parseHTML(i.trim(o))},inlineError:function(t){return n("inline_error")({message:t})},inlineSuccess:function(t){return n("inline_success")({message:t})},i18n:function(){return this._i18n.translate.apply(this._i18n,arguments).string},cacheSave:function(t,e){this.cacheHash||(this.cacheHash={});var n={};return e=e||0,t=t||this.$(":input"),t.each(function(){n[i(this).attr("name")]=i(this).val()}),this.cacheHash[e]=n,this},cacheRestore:function(t){if(this.cacheHash){t=t||0;var e=this.cacheHash[t];if(e)for(var i in e)this.$(":input[name="+i+"]").val(e[i]);return this}},cacheClear:function(t){return this.cacheHash?(t=t||0,this.cacheHash[t]=null,this):void 0},renderView:function(e,i){var n=e;return i&&(n={},n[e]=i),t.each(n,function(t,e){t.setElement(this.$(e)).render()},this),this},validateForm:function(e,n){var r,o=e.find("input").filter(function(t){return!i(t).data("validate")});this.formErrors=[],e.find(".vf-error-message").remove(),e.find(".vf-error").removeClass("vf-error");var a=this,l=function(e,i){var n=t.rest(arguments,2);if("password"==i&&n.push(8),s[i]&&!s[i].apply(s,n)){n.shift();var o=s.errorMessage(i,n);a.formErrors.push(o),e.after(a.inlineError(o)).addClass("vf-error"),r=!0}},u=e.find("[data-validate=oldPassword]"),c=e.find("[data-validate=email]");n&&c.length&&l(u,"modemail",u.val());var h=e.find("[data-validate=confirmPassword]"),d=e.find("[data-validate=newPassword]");return h.length&&""!==h.val()||d.length&&""!==d.val()||!n&&u.length&&""!==u.val()&&h.length&&d.length?(l(h,"confirmPassword",h.val(),d.val()),h.attr("data-validate","password"),d.attr("data-validate","password")):(o=o.filter(function(){return this!=h[0]&&this!=d[0]}),n===!1&&(o=o.filter(function(){return this!=u[0]}))),o.each(function(){var t=i(this),e=t.val(),n=t.data("validate");n&&l(t,n,e)}),h.length&&(h.attr("data-validate","confirmPassword"),d.attr("data-validate","newPassword")),!r},parsePath:function(t){var e=(t+"").match(/^(?:[0-9a-z_\-]+:\/\/)?[^\/]+([^#]+)(?:#|$)/);return e&&e.length?decodeURIComponent(e[e.length-1]):t},removeMessages:function(){this.$el.find(".vf-error-message, .vf-success-message").remove()},showServerErrors:function(e){var i=this;this.$el.find(".vf-error-message").remove(),e&&t.each(e,function(t,e){i.$('[name="vf_'+e+'"]').after(i.inlineError(t))})},subStringLastWord:function(t,e,i){if(i=i||15,t.length<e)return t;for(var n=e,s=0;n>1&&" "!=t[n]&&s++<i;)n--;return s>=i&&(n=e),t.substring(0,n)},insertSubViews:function(t){return t=t||{},this.$("div").each(function(e,n){var s=i(n),r=s.data();t[r.view]&&(s.replaceWith(t[r.view].el),t[r.view].render())}),this},templateOnly:function(){var e=i(n(t.result(this,"templateName")).apply(this,arguments));this.$el.replaceWith(e),this.setElement(e),"object"==typeof this.subviews&&this.insertSubViews.call(this,this.subviews)},remove:function(){i.fn.tipsy.revalidate(),this.undelegateEvents(),this.$el.removeData().unbind(),t.each(this.views,function(t,e){t.remove()}),e.View.prototype.remove.call(this)}}));return l}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(15)],s=function(t){var e={getTimeLeftWords:function(e,i){var n,s=t.getTimeLeft(e,i),r=1e3,o=6e4,a=36e5;if(0>s)return"0 "+this.i18n("seconds");if(10*r>=s)return n=Math.ceil(s/r),n+" "+this.i18n("second_s",n);if(50*r>=s)return 10*Math.ceil(s/(10*r))+" "+this.i18n("seconds");if(15*o>=s)return n=Math.ceil(s/o),n+" "+this.i18n("minute_s",n);if(55*o>=s)return 5*Math.ceil(s/5/o)+" "+this.i18n("minutes");if(12*a>=s){var l=Math.floor(s/a),u=15*Math.round(s%a/15/o);return 60==u?(l++,u=0,l+" "+this.i18n("hour_s",l)):l+" "+this.i18n("hour_s",l)+" and "+u+" "+this.i18n("minutes")}return 23*a>=s?Math.round(s/a)+" "+this.i18n("hours"):s>23*a?(n=Math.round(s/(24*a)),n+" "+this.i18n("day_s",n)):void 0},getRelativeTime:function(t,e){e=e||new Date;var i=e-1e3*t,n=6e4;if(n>i)return this.i18n("time_now");var s=null,r={millisecond:1,second:1e3,minute:60,hour:60,day:24,month:30,year:12};for(var o in r){if(i<r[o])break;s=o,i/=r[o]}return i=Math.floor(i),1!==i&&(s+="s"),this.i18n("relative_date",i,this.i18n(s))}};return e}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[],s=function(){return{socialLogin:function(t,e){return i(4).loginManager.socialLogin(t,e)},oAuthLogin:function(){return i(4).loginManager.oAuthLogin.openWindow()}}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(2),i(52),i(9),i(57),i(59),i(60),i(56),i(61),i(90),i(91),i(15),i(38)],s=function(t,e,n,s,r,o,a,l,u,c,h,d,f){return n.extend({className:"vf-modal",templateName:"modal",events:{"click .vf-modal-close":"closeModal"},initialize:function(t){this.events=s,this.settings=this.domainSettings,this.listenTo(s,"/user/login/click",this.preloadTemplates("showLogin")),this.listenTo(s,"/user/signup/click",this.preloadTemplates("showSignup")),this.listenTo(s,"/user/signup/success",this.closeModal),this.listenTo(s,"/user/login/success",this.closeModal),this.listenTo(s,"/user/account/click",this.preloadTemplates("showAccount")),this.listenTo(s,"/user/forgot_password/click",this.preloadTemplates("showForgotPassword")),this.listenTo(s,"/video/recorder/click",this.preloadTemplates("showRecorder")),this.listenTo(s,"/recorder/save/click",this.closeModal),this.listenTo(s,"/modal/close/click",this.closeModal),this.listenTo(s,"/image/click",this.preloadTemplates("showPreview")),this.listenTo(s,"/user/logout/click",this.closeModal),this.listenTo(s,"/sharelink/show",this.closeModal),this.listenTo(s,"onLoginRequired",this.showLogin),e(window).resize(this.onWindowResize.bind(this)),this.active_view=""},render:function(){return this.$container||(this.$container=e(this.template()),this.$container.appendTo(this.el),this.$modal=this.$container.find(".vf-modal"),this.$modal.toggleClass("vf-mobile",d.isMobile()),this.$inner_modal=this.$modal.find(".vf-inner-modal"),this.$subview=this.$container.find(".vf-modal-subview"),this.$modal.click(function(t){t.stopPropagation()})),this.$body.on("keyup.modal",this.keyup.bind(this)),this.$(".vf-modal-close").click(this.closeModal.bind(this)),this.active_view&&this.$subview.html(this.active_view.render(this.settings.toJSON()).el),this},onWindowResize:function(){this.centerElement()},renderSubView:function(t){this.active_view=t,this.render().showModal().centerElement()},preloadTemplates:function(t){var e=this;return function(){var n=arguments;i.e(1,function(i){var s=[i(39)];(function(i){f.loadTemplates(i),e[t].apply(e,n)}).apply(null,s)})}},showLogin:function(){this.currentUser.id||0!==this.settings.attributes.disable_widget_logins||(1===this.settings.get("authprovider_viafoura_enabled")?this.renderSubView(new r):0===this.settings.get("authprovider_viafoura_enabled")&&this.renderSubView(new o))},showAccount:function(t){t.id==this.currentUser.id&&(t=this.currentUser),this.renderSubView(new u({model:t}))},showPreview:function(t){this.renderSubView(new h({model:t}))},showSignup:function(){0===this.settings.attributes.disable_widget_logins&&this.renderSubView(new a)},showForgotPassword:function(){this.renderSubView(new l)},showRecorder:function(t,e){t.isLoggedIn()?this.renderSubView(new c({model:t,target:e})):s.trigger("/user/login/click")},centerElement:function(){var t,i,n=e(window),s=this.$inner_modal;return s&&(t=(n.height()-s.outerHeight())/2+n.scrollTop(),i=(n.width()-s.outerWidth())/2+n.scrollLeft(),s.css({top:(0>t?0:t)+"px",left:(0>i?0:i)+"px"})),this},closeModal:function(t){t&&t.preventDefault&&t.preventDefault(),this.hideModal()},showModal:function(){return this.$modal.fadeIn(400,function(){this.$("input").filter("[tabindex=1]").focus(),e(document).one("click.modal",function(t){this.hideModal()}.bind(this))}.bind(this)),this},clickModal:function(){this.hideModal()},keyup:function(t){27===t.which&&this.hideModal()},removeModal:function(){this.active_view&&(this.active_view.remove(),this.active_view=null),s.trigger("/modal/close")},hideModal:function(t){this.$body.off(".modal"),e(document).off(".modal"),this.$modal&&(t?(this.$modal.hide(),this.removeModal()):this.$modal.fadeOut(this.removeModal.bind(this)))}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(2),i(52),i(23),i(22),i(4),i(9)],s=function(t,e,i,n,s,r,o){return i.extend({templateName:"forgot",events:{"click .vf-login":"showLogin","submit form":"submitForgotPassword"},render:function(){return this.$el.html(this.template(r.current.settings.toJSON())),t.bindAll(this,"showErrors","showSuccess"),this.delegateEvents(),this.$form=this.$el.find("form"),this.$email=this.$form.find(".vf-username-input"),this},showLogin:function(t){t.preventDefault(),o.trigger("/user/login/click")},submitForgotPassword:function(t){t&&t.preventDefault();var i=this.$form,n={};this.removeMessages(),this.validateForm(i)&&(e.each(i.serializeArray(),function(t,e){n[e.name.replace(/vf_/,"")]=e.value}),o.trigger("/user/forgot_password/submit",n.email,this.showSuccess,this.showErrors))},showErrors:function(t){this.showServerErrors(t.validation_errors)},showSuccess:function(){this.$(".vf-username-input").val(""),this.removeMessages(),this.$(".vf-form").prepend(this.inlineSuccess(this.i18n("forgot_success_msg")))}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(52),i(4),i(9),i(58)],s=function(t,e,i,n,s){var r=e.extend({templateName:"login",events:{"click .vf-forgot-password":"forgotPasswordClicked","click .vf-signup":"signupClicked"},initialize:function(e){t.bindAll(this,"onFormError","loginError","loginSuccess"),this.settings=i.current.settings,this.listenTo(n,"/user/login/social/fail",this.onSocialLoginFail),this.listenTo(n,"/user/login/social/cancel",this.onSocialCancel),this.listenTo(n,"/user/login/fail",this.onSocialCancel),this.listenTo(n,"/user/login/social/error",this.onSocialError)},render:function(){return this.lockSubmit=!1,this.$el.html(this.template(this.settings.toJSON(),"login",["login_options"])),this.$("form").submit(this.submitForm.bind(this)),this.delegateEvents(),this},forgotPasswordClicked:function(t){t.preventDefault(),n.trigger("/user/forgot_password/click")},signupClicked:function(t){t.preventDefault(),n.trigger("/user/signup/click")},submitForm:function(t){t&&t.preventDefault();var e=this.$("form");if(this.lockSubmit===!1)if(this.validateForm(e)){this.lockSubmit=!0;var i=e.serializeObject();
n.trigger("/user/login",i.vf_email,i.vf_password,{error:this.loginError,success:this.loginSuccess})}else for(var s=0;s<this.formErrors.length;s++)this.onFormError(this.formErrors[s]);return!1},onFormError:function(t){n.trigger("/user/login/fail",t)},loginError:function(t){this.lockSubmit=!1,this.$(".vf-password-input").after(this.inlineError(t.error)),n.trigger("/user/login/fail",t.error)},loginSuccess:function(){this.lockSubmit=!1},onSocialLoginFail:function(t){this.showServerErrors({password:t}),this.hideDisable()},onSocialError:function(t){this.hideDisable(),this.showServerErrors({password:t})},onSocialCancel:function(){this.hideDisable()}});return t.extend(r.prototype,s.methods),t.extend(r.prototype.events,s.events),r}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(8),i(2),i(12)],s=function(t,e,i){return{events:{"click .vf-oauth-login":"oauthLogin","click .vf-facebook-login":"facebookLogin","click .vf-google-login":"googleLogin","click .vf-linkedin-login":"linkedinLogin","click .vf-twitter-login":"twitterLogin","click .vf-windowslive-login":"windowsLiveLogin","click .vf-yahoo-login":"yahooLogin","click .vf-aol-login":"aolLogin","click .vf-paypal-login":"paypalLogin","click .vf-qq-login":"qqLogin"},methods:{oauthLogin:function(t){t.preventDefault(),this.isLoginEnabled(".vf-oauth-login")&&(this.showDisable(".vf-oauth-login"),this.oAuthLogin())},facebookLogin:function(t){t.preventDefault(),this.isLoginEnabled(".vf-facebook-login")&&(this.showDisable(".vf-facebook-login"),this.socialLogin("facebook"))},aolLogin:function(t){t.preventDefault(),this.isLoginEnabled(".vf-aol-login")&&(this.showDisable(".vf-aol-login"),this.socialLogin("aol"))},googleLogin:function(t){t.preventDefault(),this.isLoginEnabled(".vf-google-login")&&(this.showDisable(".vf-google-login"),this.socialLogin("google"))},linkedinLogin:function(t){t.preventDefault(),this.isLoginEnabled(".vf-linkedin-login")&&(this.showDisable(".vf-linkedin-login"),this.socialLogin("linkedin"))},twitterLogin:function(t){t.preventDefault(),this.isLoginEnabled(".vf-twitter-login")&&(this.showDisable(".vf-twitter-login"),this.socialLogin("twitter"))},windowsLiveLogin:function(t){t.preventDefault(),this.isLoginEnabled(".vf-windowslive-login")&&(this.showDisable(".vf-windowslive-login"),this.socialLogin("live_id"))},yahooLogin:function(t){t.preventDefault(),this.isLoginEnabled(".vf-yahoo-login")&&(this.showDisable(".vf-yahoo-login"),this.socialLogin("yahoo"))},paypalLogin:function(t){t.preventDefault(),this.isLoginEnabled(".vf-paypal-login")&&(this.showDisable(".vf-paypal-login"),this.socialLogin("paypal"))},qqLogin:function(t){t.preventDefault(),this.isLoginEnabled(".vf-qq-login")&&(this.showDisable(".vf-qq-login"),this.socialLogin("qq"))},isLoginEnabled:function(t){return!this.$(t).hasClass("vf-disabled")},showDisable:function(t){this.hideDisable(),this.$(".vf-social-button, .vf-social-logins a").not(".vf-viafoura-login").addClass("vf-disabled"),this.domainSettings.isEnabled("authprovider_viafoura_enabled")?this.$(t).loader("show",{position:"right",gifType:"gray"}):this.$el.find(".vf-social-login-modal")[0]?(this.$(t).addClass("vf-social-clicked"),this.$(".vf-extras-area").loader("show",{loaderSize:"large",inside:!0,gifType:"whitelarge"})):this.$(t).loader("show")},isDisabled:function(){return 0!==this.$(".vf-disabled").length},hideDisable:function(){this.$(".vf-social-button, .vf-social-logins a").removeClass("vf-disabled vf-social-clicked").each(function(){e(this).loader("hide")}),this.$(".vf-extras-area")[0]&&this.$(".vf-extras-area").html("<hr>").loader("hide")}}}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(52),i(4),i(9),i(58)],s=function(t,e,i,n,s){var r=e.extend({templateName:"social_login",events:{},initialize:function(e){t.bindAll(this,"loginError"),this.settings=i.current.settings,this.listenTo(n,"/user/login/social/fail",this.loginError),this.listenTo(n,"/user/login/social/cancel",this.onSocialCancel),this.listenTo(n,"/user/login/fail",this.loginError),this.listenTo(n,"/user/login/social/error",this.loginError)},render:function(){return this.$el.html(this.template(this.settings.toJSON(),"social_login")),this},loginError:function(t){this.hideDisable(),this.$(".vf-extras-area").empty().html(this.inlineError(t))},onSocialCancel:function(){this.hideDisable()}});return t.extend(r.prototype,s.methods),t.extend(r.prototype.events,s.events),r}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(2),i(52),i(22),i(4),i(9),i(58)],s=function(t,e,i,n,s,r,o){var a=i.extend({templateName:"signup",events:{"click .vf-login":"showLogin"},initialize:function(){this.listenTo(r,"/user/login/social/fail",this.onSocialLoginFail),this.listenTo(r,"/user/login/social/cancel",this.onSocialCancel),this.listenTo(r,"/user/login/fail",this.onSocialCancel),this.listenTo(r,"/user/login/social/error",this.onSocialError)},render:function(){return this.pubsub=r,this.$el.html(this.template(s.current.settings.toJSON(),"signup",["login_options"])),this.delegateEvents(),this.$(".vf-signup-form").submit(this.signupSubmit.bind(this)),this},showLogin:function(t){t.preventDefault(),r.trigger("/user/login/click")},signupSubmit:function(t){t&&t.preventDefault();var i=this.$el.find(".vf-signup-form"),n={};this.validateForm(i)&&(e.each(i.serializeArray(),function(t,e){n[e.name.replace(/vf_/,"")]=e.value}),r.trigger("/user/create",n,{error:this.showErrors.bind(this)}))},showErrors:function(t){this.showServerErrors(t.validation_errors)},onSocialLoginFail:function(t){this.showServerErrors({password:t}),this.hideDisable()},onSocialError:function(t){this.hideDisable(),this.showServerErrors({password:t})},onSocialCancel:function(){this.hideDisable()}});return t.extend(a.prototype,o.methods),t.extend(a.prototype.events,o.events),a}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(6),i(52),i(64),i(4),i(9),i(65),i(62),i(22),i(66),i(78)],s=function(t,e,n,s,r,o,a,l,u,c,h){return n.extend({templateName:"account",events:{"click .vf-account-options li":"selectTab","click .vf-subscribe":"follow","submit form":"submitAccountEdit","mouseup input":"hideSuccess","change .vf-avatar-picker":"setAvatar","click .vf-set-default-avatar":"resetAvatar"},initialize:function(){e.bindAll(this,"onFollowSuccess","onFollowError"),this.model.toJSON||(this.model=new u(this.model)),this.text_collection=this.model.comments({type:"text",section:null}),this.image_collection=this.model.comments({type:"image",section:null}),this.video_collection=this.model.comments({type:"video",section:null}),e.bindAll(this,"canView");var t=i(66);this.text_commenting=new t({collection:this.text_collection,canView:this.canView}),this.image_commenting=new t({collection:this.image_collection,canView:this.canView}),this.video_commenting=new t({collection:this.video_collection,canView:this.canView}),this.listenTo(this.model,"change:subscribed",this.renderFollow),this.listenTo(this.model,"change:pic_small change:name",this.renderUser)},canView:function(t,e){return t.has("user")&&t.get("user").id===this.model.id||this.model.isModOrAdmin()||"completed"===t.get("processing_status")},render:function(){this.text_commenting.fetch(),this.image_commenting.fetch(),this.video_commenting.fetch();var t=r.current.settings,e=this.can("updateAvatar",this.model),i=this.can("updatePassword",this.model),n=this.can("updateName",this.model),s=this.can("updateEmail",this.model),o=this.can("updateNotifications",this.model),a=s||o||e||n||i,l=e||n||s;return this.$el.html(this.template({user:this.model.toJSON(),settings:t.toJSON(),showSettings:a,canUpdateAvatar:e,canUpdatePassword:i,canUpdateName:n,canUpdateEmail:s,canUpdateNotifications:o,hasOptionsOrAvatar:l},"account",["settings"])),this.successMessage=this.$(".vf-success-message"),this.errorMessage=this.$(".vf-error-message"),this.$tabs=this.$el.find(".vf-account-options"),this.$el.find(".vf-text-container").html(this.text_commenting.render().$el),this.$el.find(".vf-video-container").html(this.video_commenting.render().$el),this.$el.find(".vf-images-container").html(this.image_commenting.render().$el),this.renderFollow(),this.$(".vf-avatar").attr("onerror","this.src='"+this.model.defaults.pic_small+"'"),this},renderFollow:function(){if(r.current.settings.get("disable_email_notifications"))return void this.$(".vf-subscribe").hide();var t=this.model.get("subscribed"),e=this.$(".vf-subscribe");e.toggleClass("hidden",this.model.id==r.current.user.id),t?(e.text(this.i18n("unsubscribe_btn")),e.attr("data-d","unsubscribe-user")):(e.text(this.i18n("subscribe_btn")),e.attr("data-d","subscribe-user"))},emailChanged:function(){return this.$("form [data-validate=email]").val()!=this.model.get("email")},selectTab:function(e){e.preventDefault();var i=t(e.target);this.$tabs.children("li").removeClass("vf-current"),i.parent().addClass("vf-current"),this.$el.find(".vf-is-content").removeClass("vf-current"),this.$el.find("."+i.data("container")).addClass("vf-current")},submitAccountEdit:function(e){e.preventDefault();var i=this.$("form"),n={},s=this.emailChanged();this.validateForm(i,s)&&(t.each(i.serializeArray(),function(t,e){n[e.name.replace(/vf_/,"")]=e.value}),delete n.avatar,this.hideSuccess(),o.trigger("/user/edit",n,{error:this.validateErrors.bind(this),success:this.showSuccess.bind(this)}))},showAPICodeErrors:function(t){if(t){var e,i=h.codeToI18n(t);switch(i=i.length>0?i[0]:""){case"user_update_email_in_use":e="vf_email";break;case"user_update_password_required":e="vf_old_password";break;case"user_update_picture_not_found":case"user_update_unrecognized_picture_format":e="avatar"}e&&this.$('[name="'+e+'"]').after(this.inlineError(this.i18n(i)))}},validateErrors:function(t){this.hideSuccess(),this.showServerErrors(t.validation_errors),this.showAPICodeErrors(t.api_code),this.errorMessage.show()},follow:function(e){e.preventDefault(),this.authorize("follow",this.model)?(t.fn.loader.hideErrors(),t(".vf-user-info .vf-subscribe").loader("show",{gifType:"blue"}).addClass("vf-loader-inverted vf-follow-loader"),this.model.toggleFollow({success:this.onFollowSuccess,error:this.onFollowError})):t.fn.tipsy.revalidate()},onFollowSuccess:function(){this.$(".vf-user-info .vf-subscribe").loader("hide")},onFollowError:function(){this.$(".vf-user-info .vf-subscribe").loader("error").addClass("vf-error-inverted").tipsy({title:"something_went_wrong",interactive:!0})},showSuccess:function(t,e){this.successMessage.show(),this.model.set(t.result),this.$(":password").val("")},hideSuccess:function(t){this.successMessage.hide(),this.$(".vf-error-message").remove(),this.$(".vf-error").removeClass("vf-error")},setAvatar:function(e){return this.upload=new l({restAPI:this.restAPI,file:t(e.target),type:"avatar",session:r.current.session.id}),this.listenTo(this.upload,"done",this.updateUser),this.listenTo(this.upload,"error",this.uploadError),this.upload.upload(),this},uploadError:function(){this.stopListening(this.upload),this.$(".vf-user-options").loader("error").addClass("vf-error-message").html(this.i18n("user_update_unrecognized_picture_format")),delete this.upload},updateUser:function(){this.model.fetch(),this.stopListening(this.upload),delete this.upload},renderUser:function(t){this.$(".vf-avatar").attr("src",t.get("pic_small")),this.$(".vf-username").text(t.get("name"))},resetAvatar:function(t){t.preventDefault(),this.model.save({avatar:""}),this.model.set("pic_small",this.model.defaults.pic_small)},remove:function(){this.text_comments&&(this.text_comments.remove(),this.text_comments=null),this.video_comments&&(this.video_comments.remove(),this.video_comments=null),this.image_comments&&(this.image_comments.remove(),this.image_comments=null),n.prototype.remove.call(this)}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(6),i(8),i(38),i(4),i(63),i(10),i(12)],s=function(t,e,i,n,s,r,o,a){var l=function(){this.setup.apply(this,arguments)};return e.extend(l.prototype,i.Events,{setup:function(e){this.restAPI=e.restAPI,this.paths={media:a.api_url+s.locations.domain+"/media",avatar:a.api_url+s.locations.domain+"/users/"+s.current.user.id},e&&"object"==typeof e&&(this.file=e.file,t(e.file).replaceWith(t(e.file).clone()),this.type=e.type||"media",this.section=e.section,this.session=e.session||s.current.session.id,this.domain=e.domain||s.locations.domain),this.progressKey="X-Progress-ID",this.progressId=this.generateUID(),this.progress=0,this.state="init",this.delay=500},generateUID:function(){return("1"+Math.random()).replace(".","0")},getUploadUrl:function(t){var e=this.paths[t]+"?"+this.progressKey+"="+this.progressId+"&session="+this.session+"&mime=text%2Fhtml";return"avatar"===this.type&&(e+="&verb=patch"),this.section&&(e+="&section="+this.section),e},upload:function(){var e,i,s=this;this._cancel=!1,e=t(n("iframe_upload")({url:this.getUploadUrl(this.type),target:"vf"+t.now()})),i=e.find("iframe"),i.on("load",function(){i.off("load"),s._cancel||e.submit()}),e.append(this.file),t("body").append(e),this.poll()},poll:function(){var t=this;this.restAPI.trackUpload(this.progressId,{success:function(e){if(t._cancel)return t.state="cancel",void t.trigger(this.state);if(e.id=t.progressId,"error"===e.state||"undefined"==typeof e.state)return t.state="error",void t.trigger("error",e);if("done"===e.state){t.state="done",t.trigger("done",e);var i=r;i.fetch(e.id,function(e,i){t.trigger("media",e,i)},function(e){t.trigger("error",e)})}else"uploading"===e.state&&(t.state="uploading",t.trigger("progress",e));"done"!==t.state&&setTimeout(function(){t.poll()},t.delay)}})},cancel:function(){this._cancel=!0},getProgress:function(){return this.progress}}),l}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(7)],s=function(t){var e=t.extend({url:"/media",isImage:function(){return this.has("m")||this.has("t")||this.has("s")},isVideo:function(){return this.has("mp4_status")}},{fetch:function(t,i,n,s){var r=new e({xpid:t});return r.fetch({params:!0,success:function(t,e){"OK"==e.message?i&&i.call(s,r,e):n&&n.call(s,e)},error:function(t,e){n&&n.call(s,e)}}),r}});return e}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(2),i(52),i(9)],s=function(t,e,i,n){var s=i.extend({tagName:"ul",className:"vf-list",initialize:function(e){this.canView=e.canView,this.itemView=e.itemView,this.views=[],this.settings=e.settings||{},this.index=0,t.bindAll(this,"appendItem","prependItem","render"),this.listenTo(this.collection,"reset",this.render),this.listenTo(this.collection,"add",this.add),this.listenTo(this.collection,"sync",this.resetIndex)},render:function(){return this.views=[],this.$el&&this.collection.length>=0&&(this.$el.empty(),this.collection.each(this.appendItem)),this},add:function(t,e,i){var n={prepend:this.prependItem,append:this.appendItem},s=n[i.insert_method||"append"](t);s&&i.animate&&s.hide().slideDown()},appendItem:function(t){if(!this.canView||this.canView(t)){var e=new this.itemView({model:t,settings:this.settings});return this.views.push(e),e.render().$el.appendTo(this.el)}},prependItem:function(t){if(!this.canView||this.canView(t)){var e=new this.itemView({model:t,settings:this.settings}),i=this.$el.children().eq(this.index);return this.views.splice(this.index,0,e),this.index+=1,e.render().$el.insertBefore(i)}},resetIndex:function(){this.index=0}});return s}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(52)],s=function(t){var e=t.extend({templateName:"user_header_view",render:function(){this.$el.html(this.template({name:this.model.get("name")}))}});return e}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(2),i(52),i(64),i(67)],s=function(t,e,i,n,s){var r=i.extend({events:{"click .vf-load-more":"onShowMore"},initialize:function(e){t.bindAll(this,"onFetchError","onFetchSuccess","loadMoreSuccess","loadMoreError"),this.comments=new n({tagName:"div",itemView:s,collection:this.collection,canView:e.canView}),this.listenTo(this.collection,"add",this.toggleShowMore)},fetch:function(){this.collection.fetch({batch:!0,error:this.onFetchError,success:this.onFetchSuccess})},onFetchError:function(){var t=this.i18n("something_went_wrong");this.$el.html("<div class='vf-error-message'>"+t+"<div>")},onFetchSuccess:function(){if(this.collection.isEmpty()){var t=this.i18n("profile_no_comments");this.currentUser==this.collection.user&&(t=this.i18n("profile_you_no_comments")),this.$el.html("<div class='vf-no-messages'>"+t+"</div>")}},onShowMore:function(t){t.preventDefault(),this.$show_more_btn.children(".vf-error-message").remove(),this.$show_more_btn.hide(),this.$show_more_btn.loader("show",{loaderSize:"large",block:!0}),this.collection.fetchPageAfter({success:this.loadMoreSuccess,error:this.loadMoreError})},loadMoreSuccess:function(){this.$show_more_btn.loader("hide")},loadMoreError:function(){this.$show_more_btn.show().loader("hide"),this.$show_more_btn.children(".vf-error-message").remove();var t=this.i18n("something_went_wrong");this.$show_more_btn.append("<div class='vf-error-message'>"+t+"</div>")},render:function(){return this.$el.empty(),this.$el.append(this.comments.$el),this.$show_more=e(this.template({},"load_more")).hide(),this.$el.append(this.$show_more),this.$show_more_btn=this.$(".vf-load-more-con"),this.delegateEvents(),this},toggleShowMore:function(){this.$show_more.toggle(!!this.collection.after_count)},remove:function(){this.comments.remove(),this.$show_more=null,this.collection=null,i.prototype.remove.call(this)}});return r}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(68)],s=function(t){var e=t.extend({profileView:!0});return e}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(2),i(9),i(69),i(52),i(70),i(79),i(64),i(80),i(4),i(82),i(84),i(38),i(71),i(85),i(11),i(12),i(86),i(78),i(88),i(15),i(89),i(46)],s=function(t,e,i,n,s,r,o,a,l,u,c,h,d,f,p,m,g,v,y,b,w,_,x){var k={};i.on("/commenting/reply/save",function(t,e){k[e]=t});var S=s.extend({templateName:"comment",mixins:[_,n],likeLocked:!1,wasEdited:!1,events:{"click .vf-username":"openProfile","click .vf-like-btn":"like","click .vf-new-like-btn":"like","click .vf-dislike-btn":"dislike","click .vf-reply-btn":"reply","click .vf-flag":"flag","click .vf-show-more":"showMoreorLess","click .vf-rt-has-edit-link":"reload","click .vf-photo":"showImagePreview","click .vf-inline-video":"playVideo","click .vf-share-btn":"shareClick","mouseover .vf-share-btn":"openShareOptions","mouseover .vf-date":"initDateTooltip"},initialize:function(){t.bindAll(this,"onFlagSuccess","onFlagError","onLikeError","onLikeSuccess","addShareEvents","trackTwitterTweet","trackFacebookLike","trackEmailShare","onCloseShares","onRefreshSuccess","realtimeNewCommentChange"),this.views={avatar:new f({user:this.model.user}),processing_status:new p({comment:this.model})},this.rollCounters={num_likes:{el:".vf-count-likes span",prop:"num_likes"},num_dislikes:{el:".vf-count-dislikes span",prop:"num_dislikes"}},this.closeDelay=500,this.show_more=!0,this.listenTo(this.model,"change:processing_status",this.statusChanged),this.listenTo(this.model,"change:num_likes",this.likesChanged),this.listenTo(this.model,"change:num_dislikes",this.likesChanged),this.listenTo(this.model,"change:editor_pick",this.render),this.listenTo(this.model,"change:processing_status",this.render),this.listenTo(this.model,"change:content",this.contentChange),this.listenTo(this.model,"change:realtimeNewComment",this.realtimeNewCommentChange),this.listenTo(this.model.user,"change",this.render),this.listenTo(u.current.user,"change:id",this.render),this.options.hasRealtime&&this.listenTo(x,"content",this.realtimeUpdate)},render:function(){var t=this.templateJSON(),e=this.domainSettings.get("show_more_character_limit");this.profileView||this.renderUserActions(),this.templateOnly(t),this.insertSubViews(this.views),this.model.user.isGuest()&&(this.$el.addClass("vf-is-anonymous"),this.$el.undelegate(".vf-username","click"));var n=k[this.model.id];if(void 0!==n&&this.renderReplyBox(n),"administrator"===t.user_privilege&&(t.user_privilege="moderator"),this.model.isRemoved()&&(this.renderRemoved(),!this.currentUser.isModOrAdmin()))return this;this.renderTime(this.liveRenderTime()),this.model.isVideoComplete()?t.video_placeholder=t.video.thumbs.medium:this.model.isVideoProcessing()&&this.videoPoll();var s=t.content.replace(/&#?[a-zA-Z0-9]+;/g,"#");s.length>e&&this.subStringLastWord(s,e).length!=s.length&&this.showMoreorLess(),this.can("moderate",this.model)&&this.showModeration();var r=this.$(".vf-ajax-loader-wrap");return r[0]&&r.loader("show",{inside:!0,gifType:"bluegray"}),this.initTipsy(),this.initDateTooltip(),this.initializeAnimation(),i.trigger("/commenting/comment/render",this.model,this.$el[0]),this},initTipsy:function(){var t=1===this.model.get("liked")?"unlike_tip":"like_tip",e=1===this.model.get("disliked")?"undislike_tip":"dislike_tip";w.isMobile()||(this.$el.find(".vf-new-like-btn").tipsy({title:t,delayIn:1e3}),this.$el.find(".vf-dislike-btn").tipsy({title:e,delayIn:1e3}))},updateTipsyTitles:function(){var t=1===this.model.get("liked")?"unlike_tip":"like_tip",e=1===this.model.get("disliked")?"undislike_tip":"dislike_tip";this.$el.find(".vf-new-like-btn").tipsy("hide").tipsy("setTitle",t),this.$el.find(".vf-dislike-btn").tipsy("hide").tipsy("setTitle",e)},renderRemoved:function(){this.currentUser.isModOrAdmin()?this.$(".vf-comment-actions, .vf-flag").remove():(this.$(".vf-comment-html").empty(),this.$(".vf-user-meta, .vf-comment-meta, .vf-comment-actions, .vf-flag, .vf-ajax-loader, .vf-media-container").remove(),this.$(".vf-avatar").attr("src",this.currentUser.defaults.pic_small)),this.views.user_actions&&this.removeUserActions()},renderUserActions:function(){this.can("update",this.model)||this.can("remove",this.model)?void 0===this.views.user_actions&&(this.views.user_actions=new b({comment:this.model,parent:this}),this.listenTo(this.views.user_actions,"edit",this.startEdit),this.listenTo(this.views.user_actions,"lock",this.removeUserActions),this.listenTo(this.views.user_actions,"remove",this.onRemoved)):this.views.user_actions&&this.removeUserActions()},templateJSON:function(){var t=this.model.toJSON();t.profileView=this.profileView;var e=this.model.get("page");return t.profileView&&(e?t.page_title=e.title:t.page_title=""),t.hideReply=!1,e&&("closed"===e.status||e.statusDisplayOnly)&&(t.hideReply=!0),this.domainSettings.get("disableReply")&&(t.hideReply=!0),t.showFlag=!u.current.user.isBanned()&&!this.model.user.isModOrAdmin(),t.showTrusted=this.domainSettings.get("badging_trusted_display"),t.showMod=this.domainSettings.get("badging_moderator_display"),t.enableDislikes=1===this.domainSettings.get("enable_dislikes")?!0:!1,t.likeClass=1===this.model.get("liked")?"active":"",t.dislikeClass=1===this.model.get("disliked")?"active":"",t.wasEdited=this.wasEdited,t},renderTime:function(){var t=this.getRelativeTime(this.model.get("date_created"),this.domainSettings.currentTime());this.model.get("date_edited")&&(t+=this.domainSettings.currentTime()-1e3*this.model.get("date_edited")<=36e5?" "+this.i18n("post_edited_recently"):" "+this.i18n("post_edited")),this.$(".vf-date").text(t)},liveRenderTime:function(){var t=this,e=3e4;setInterval(function(){return t.renderTime()},e)},initDateTooltip:function(){var t=1e3;this.$(".vf-date").css({cursor:"pointer"}).tipsy({template:"datetooltip",gravity:"nw",interactive:!0,delayIn:t,delayOut:100,offset:0});var i=new Date(1e3*this.model.get("date_created")),n=i.toLocaleDateString(window.navigator.language,{month:"long",day:"numeric"}),s=i.toLocaleTimeString(window.navigator.language,{hour:"numeric",minute:"numeric",timeZoneName:"short"});window.setTimeout(function(){e(".vf-date-posted").text(n),e(".vf-time-posted").text(s)},t)},like:function(t){t.preventDefault(),this.likeAction(this.model.toggleLike.bind(this.model))},dislike:function(t){t.preventDefault(),this.likeAction(this.model.toggleDislike.bind(this.model))},likeAction:function(t){!this.likeLocked&&this.authorize("like",this.model)&&(this.likeLocked=!0,e.fn.loader.hideErrors(),this.$(".vf-like-btn,.vf-new-like-btn").loader("show"),t({success:this.onLikeSuccess,error:this.onLikeError}))},onLikeSuccess:function(){this.likeLocked=!1,this.$(".vf-like-btn,.vf-new-like-btn").loader("hide"),this.updateTipsyTitles()},onLikeError:function(t){this.likeLocked=!1,this.$(".vf-like-btn,.vf-new-like-btn").loader("error").tipsy({title:y.codeToI18n(t.api_code)[0],interactive:!0,delayOut:300})},likesChanged:function(){var t=this.$el.find(".vf-like-btn:first"),e=this.model.get("liked");this.model.get("num_likes");if(t.text(0===e?this.i18n("like_lnk"):this.i18n("unlike_lnk")),this.domainSettings.get("enable_dislikes")){var i=this.model.get("disliked"),n=this.$el.find(".vf-dislike-text:first");n.text(0===i?this.i18n("dislike_lnk"):this.i18n("undislike_lnk")),this.$el.find(".vf-new-like-btn").toggleClass("active",1===e),this.$el.find(".vf-dislike-btn").toggleClass("active",1===i)}},statusChanged:function(){},reply:function(t){t.preventDefault(),this.renderReplyBox()},renderReplyBox:function(t){if(!this.profileView)if(!this.replybox||t){this.$(".vf-reply-btn").addClass("vf-cancel-reply").text(this.i18n("cancel_btn_lnk"));var e={comment:this.model,user:u.current.user,prefix:"@"+this.model.user.get("name")+" ",text:t,settings:this.domainSettings};this.replybox=new r(e),this.listenTo(this.replybox,"comment:submitted",this.closeReplyBox),this.$(this.$(".vf-rt-new-circle")?".vf-rt-new-circle":".vf-comment-meta").before(this.replybox.render().el);var i=this.$(".vf-content")[0];i.selectionStart=i.selectionEnd=i.value.length,i.focus()}else this.closeReplyBox()},closeReplyBox:function(){this.replybox&&(this.$(".vf-reply-btn").removeClass("vf-cancel-reply").text(this.i18n("reply_lnk")),delete k[this.model.id],this.replybox.remove(),delete this.replybox)},flag:function(t){t.preventDefault(),!this.flagged&&this.authorize("flag",this.model)&&(this.flagged=!0,this.restAPI.request("put","flags/"+this.model.id,{},{success:this.onFlagSuccess,error:this.onFlagError}),e.fn.loader.hideErrors(),this.$(".vf-flag").loader("show"))},onFlagSuccess:function(){this.$(".vf-flag").text(this.i18n("flagged_lnk")).css({color:"#aaa"}),this.$(".vf-flag").loader("hide")},onFlagError:function(t){this.flagged=!1,this.$(".vf-flag").loader("error").tipsy({title:y.codeToI18n(t.api_code)[0],interactive:!0,delayOut:300})},showModeration:function(){this.moderation=new l({model:this.model}),this.$el.append(this.moderation.render().el),this.listenTo(this.moderation,"change:user",this.render),this.listenTo(this.moderation,"error",this.onModError),this.listenTo(this.moderation,"click",this.hideError)},startEdit:function(){void 0===this.commentEditForm&&(this.closeReplyBox(),this.commentEditForm=new v({holder:this.$(".vf-comment-html"),model:this.model}),this.commentEditForm.replaceHolder(),this.listenTo(this.commentEditForm,"finish",this.onEditFinish),this.$(".vf-comment-meta, .vf-comment-actions, .vf-comment-edit-links, .vf-comment-user-actions, .vf-was-edited").hide(),this.commentEditForm.render())},removeUserActions:function(){this.stopListening(this.views.user_actions),this.views.user_actions.remove(),delete this.views.user_actions},onRemoved:function(){this.renderRemoved()},onEditFinish:function(){this.commentEditForm.revertHolder(),this.commentEditForm.remove(),this.$(".vf-comment-meta, .vf-comment-actions, .vf-comment-edit-links, .vf-comment-user-actions, .vf-was-edited").show();var t=d.formatLinks(this.model.get("content"));this.$(".vf-comment-html").html(t),this.renderTime(),this.stopListening(this.commentEditForm),delete this.commentEditForm},showMoreorLess:function(t){var i,n,s=this.model.toJSON();if(this.profileView?(n="format",i=this.$el.find(".vf-comment-html a")):(n="formatLinks",i=this.$el.find(".vf-comment-html")),t&&t.preventDefault){t.preventDefault();var r=e(t.target),o=r.data().action;"more"===o?this.show_more=!1:this.show_more=!0,i=r.parent()}var a,l=this.domainSettings.get("show_more_character_limit");a=this.show_more?this.subStringLastWord(s.content,l):s.content,a=d[n](a),i.html(a),this.$show_more=this.template({isShowMore:this.show_more},"show_more"),i.append(this.$show_more)},contentChange:function(t,e){this.$(".vf-comment-html").text(e)},playVideo:function(t){t.preventDefault();var e=this.model.toJSON();e.video&&(this.video=new h(e.video),this.player=new c({model:this.video}),this.$el.find(".vf-inline-video:first").replaceWith(this.player.$el),this.player.render())},videoPoll:function(){if(this.model.isVideoProcessing()&&!this.stopPolling&&g.video_poll){var t=this;this.model.fetch({success:function(){t.model.isVideoComplete()?t.displayVideo():setTimeout(t.videoPoll.bind(t),5e3)},error:function(){setTimeout(t.videoPoll.bind(t),1e4)}})}},displayVideo:function(){this.render()},openProfile:function(t){t.preventDefault(),t.stopPropagation(),this.model.user.get("id")&&i.trigger("/user/account/click",this.model.user)},showImagePreview:function(t){t.preventDefault(),i.trigger("/image/click",this.model)},trackEmailShare:function(t){t.preventDefault();var e="mailto:?subject=Check%20out%20this%20comment&body=Check%20out%20this%20comment:%20"+this.model.shareLink(),i=function(){window.location.href=e};this.restAPI.request("post","analytics/shares",{provider:"email",id:this.model.id},{success:i,error:i}),this.$(".vf-share-options").tipsy("hide")},trackFacebookLike:function(t){t.preventDefault(),t.stopPropagation();var e=this.model.shareLink();this.openShareLink("http://www.facebook.com/sharer/sharer.php?u="+e,"Facebook"),this.restAPI.request("post","analytics/shares",{provider:"facebook",id:this.model.id}),this.$(".vf-share-options").tipsy("hide")},shareClick:function(t){t.preventDefault()},trackTwitterTweet:function(t){t.stopPropagation(),t.preventDefault();var e=this.model.shareLink();this.openShareLink("http://twitter.com/home?status=Check out this comment: "+e,"Twitter"),this.restAPI.request("post","analytics/shares",{provider:"twitter",id:this.model.id}),this.$(".vf-share-options").tipsy("hide")},openShareLink:function(t,e){window.open(t,e,"status = 1, height = 350, width = 550, resizable = 0")},onCloseShares:function(){this.closeTimer=0,this.$(".vf-share-btn").show(),this.$(".vf-social-icon").hide()},openShareOptions:function(){this.$(".vf-share-options").show().tipsy({title:"share-menu",template:"sharemenu",gravity:"ne",interactive:!0,delayOut:300,offset:0,onOpen:this.addShareEvents}).tipsy("show")},addShareEvents:function(t){t.$tip.on("click",function(t){t.stopPropagation()}),t.$tip.find(".vf-facebook-like").on("click",this.trackFacebookLike),t.$tip.find(".vf-twitter-tweet").on("click",this.trackTwitterTweet),t.$tip.find(".vf-email-icon").on("click",this.trackEmailShare)},remove:function(){this.stopPolling=!0,s.prototype.remove.call(this)},showError:function(t){this.hideError(),this.$el.addClass("has-top-banner").prepend("<div class='vf-mod-error'>"+t+"</div>")},hideError:function(){this.$el.removeClass("has-top-banner"),this.$(".vf-mod-error").remove()},onModError:function(t){var e;65554==t.api_code?(e=this.i18n("outdated_content"),this.model.fetch({success:this.onRefreshSuccess})):e=t.error||this.i18n("something_went_wrong"),this.showError(e)},onRefreshSuccess:function(){this.showError(this.i18n("outdated_content_updated"))},realtimeUpdate:function(t){if(t&&this.filter_id&&this.filter_id===t.filter_id&&t.comment_uuid&&t.comment_uuid===w.toUuid(this.model.id))if("comment.enable"===t.event_type)this.model.set("processing_status","completed"),this.render();else if(!this.isSelf(t,u.current.user))switch(t.event_type){case"comment.liked":this.model.set("num_likes",this.model.get("num_likes")+1);break;case"comment.disliked":this.model.set("num_dislikes",this.model.get("num_dislikes")+1);break;case"comment.unliked":this.model.set("num_likes",this.model.get("num_likes")-1);break;case"comment.undisliked":this.model.set("num_dislikes",this.model.get("num_dislikes")-1);break;case"comment.edit":
this.wasEdited=!0,this.render();break;default:return}},realtimeNewCommentChange:function(t){this.$el.toggleClass("vf-rt-new",t.get("realtimeNewComment"))},reload:function(t){t.preventDefault(),this.listenToOnce(this.model,"sync",function(){this.wasEdited=!1,this.render()}.bind(this)),this.model.fetch()}});return S}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2)],s=function(t){var e='<div class="vf-rolling-child"><div class="raw-number"></div><div class="roller-number roller-prev"></div><div class="roller-number roller-current"></div><div class="roller-number roller-next"></div>',i={initializeAnimation:function(){t.each(this.rollCounters,function(t,e){e.$elCounter=this.$el.find(e.el),this.counterResetDOM(e.prop),e.animation_complete=!0,this.listenTo(this.model,"change:"+e.prop,this.counterUpdate.bind(this,e.prop))}.bind(this))},counterUpdate:function(e){if(this.rollCounters[e].animation_complete===!0){this.rollCounters[e].animation_complete=!1;var i=this.model.previous(e),n=this.model.get(e),s=this.rollCounters[e].$elCounter;0>n&&(n=0);var r=i.toString(10),o=n.toString(10),a=null,l=n>i?".roller-next":".roller-prev";if(r.length!==o.length)if(r.length<o.length)for(;r.length<o.length;){var u=o[o.length-r.length-1];s.find(".raw-number, .roller-number").prepend("<span>"+u+"</span>"),s.find(".roller-current:first").addClass("transitionable invisible").css({transform:"translateY(0)"}),s.find(l).find("span:first").addClass("transitionable").css({transform:"translateY(0)",opacity:.25}).css("opacity"),r="0"+r}else r.length>o.length;for(var c=0;c<r.length;c++)if(r[c]!==o[c]){a=c;break}s.find(l).find("span").each(function(e){t(this).html(o[e])}),null!==a?s.find(".roller-number").each(function(r,o){var l=t(o).find("span").slice(a).css({transform:n>i?"translateY(-100%)":"translateY(100%)",opacity:t(o).hasClass("roller-current")?.25:1});l.on("transitionend webkitTransitionEnd",function(){l.off("transitionend webkitTransitionEnd"),this.counterResetDOM(e,s,n)}.bind(this))}.bind(this)):this.counterResetDOM(e,s,n)}},counterResetDOM:function(i,n,s){this.rollCounters[i].animation_complete=!0;var r=this.model.get(i),n=this.rollCounters[i].$elCounter;if(void 0!==r&&void 0!==n){for(var o=r.toString(10),a=t("<div>").addClass("vf-rolling-child"),l=0;l<o.length;l++)a.append('<span class="transitionable">'+o[l]+"</span>");n.empty().addClass("vf-rolling").append(e),n.find(".roller-number").empty().append(a.html()),n.find(".roller-prev span, .roller-next span").css({transform:"translateY(0)",opacity:.25});var u=void 0!==s?s:r;n.find(".raw-number").empty().html(u),void 0!==s&&s!==r&&n.find(".roller-prev").on("transitionend webkitTransitionEnd",function(){this.counterUpdate(i)}.bind(this))}}};return i}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(2),i(52),i(9),i(71),i(72)],s=function(t,e,i,n,s,r){var o=i.extend({templateName:"reply_box",events:{"keyup .vf-content":"cacheComment"},initialize:function(t){this.section=t.section,this.user=t.user,this.page=t.page,this.comment=t.comment,this.settings=t.settings,this.prefix=t.prefix||"",this.text=t.text,this.views={avatar:new s({user:this.user}),comment_form:new r({section:this.section,model:this.page||this.comment,settings:this.settings,text:this.prefix,loginDashboard:t.loginDashboard})},this.listenTo(this.views.comment_form,"comment:submitted",this.commentSubmitted)},commentSubmitted:function(t){this.trigger("comment:submitted",t)},isCommentReply:function(){return!!this.comment},render:function(t){return this.cacheSave(this.$("textarea")),this.templateOnly(),this.insertSubViews(this.views),this.text&&(this.$(".vf-content").val(this.text),this.text=!1,this.views.comment_form.revalidateTextarea()),this.cacheRestore(),this},cacheComment:function(t){this.comment&&n.trigger("/commenting/reply/save",this.$("textarea").val(),this.comment.id),this.cacheSave(this.$("textarea"))}});return o}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(6),i(8),i(52),i(9),i(4)],s=function(t,e,i,n,s,r){return n.extend({templateName:"avatar",events:{"click .vf-avatar":"showAccountProfile"},initialize:function(t){this.model=t.user,this.listenTo(this.model,"change:pic_small",this.render)},render:function(){this.templateOnly(this.model.toJSON());var t=r.current.user;(this.model!=t&&this.model.isGuest()||this.model===t&&this.model.canAnonymouslyPost())&&(this.$el.addClass("vf-is-anonymous"),this.$el.undelegate(".vf-avatar","click")),this.$(".vf-avatar").attr("onerror","this.src='"+this.model.defaults.pic_small+"'")},showAccountProfile:function(t){t.preventDefault(),t.stopPropagation(),this.model.id?s.trigger("/user/account/click",this.model):s.trigger("onLoginRequired")}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(6),i(8),i(52),i(62),i(4),i(9),i(27),i(73),i(15),i(74),i(75),i(76),i(77),i(78),i(11)],s=function(t,e,i,n,s,r,o,a,l,u,c,h,d,f,p,m){var g=n.extend({mixins:[f,c,d],templateName:"comment_form",events:{"click .vf-record-video":"showRecorder","click .vf-progress-cancel":"cancelUpload","click .vf-comment-submit":"submitForm","click .vf-upload-image":"onUploadImage","click .vf-upload-video":"onUploadVideo","change .vf-video-file":"uploadFile","change .vf-image-file":"uploadFile","keydown .vf-comment-textarea":"onTextChange","change .vf-comment-textarea":"onTextChange","input .vf-comment-textarea":"onTextChange","keyup .vf-comment-textarea":"onKeyUp","paste .vf-comment-textarea":"onPaste","textInput .vf-comment-textarea":"onTextChange"},initialize:function(t){e.bindAll(this,"onStreamError","onStreamSuccess"),this.forceEncodeCount=u.getIEVersion()&&u.getIEVersion()<=9,this.user=r.current.user,this.settings=t.settings,this.forcedDisabled=!1,this.original_text=t.text||"",this.section=t.section,this.maxCharacters=this.settings.get("comment_max_length"),this.showCharacterCount=this.maxCharacters-100,this.views={login_dashboard:new l({user:this.user,settings:this.settings})},this.loginDashboard=t.loginDashboard||this.views.login_dashboard,this.listenTo(this.loginDashboard,"login:error",this.loginError),this.listenTo(this.user,"change:id",this.onUserLogin)},render:function(){return this.templateOnly({enable_video_record:r.current.settings.get("enable_comment_video")&&r.util.isFlashEnabled(),enable_video_upload:r.current.settings.get("enable_comment_video"),enable_image_upload:r.current.settings.get("enable_comment_images"),enable_anonymous_comments:r.current.settings.get("enable_anonymous_comments")}),this.insertSubViews(this.views),this.$progressBar=this.$(".vf-progress-bar"),this.$progress=this.$progressBar.find(".vf-progress"),this.$filename=this.$progressBar.find(".vf-progress-filename"),this.$submitButton=this.$(".vf-comment-submit"),this.$textarea=this.$("textarea"),this.$textarea.val(this.original_text),this.onUserLogin(),this.clearUpload(),this},revalidateTextarea:function(){this.$(".vf-content").keyup()},onPaste:function(t){var e=this;setTimeout(function(){e.onTextChange(t)},0),this.onCharacterChange(t)},onUserLogin:function(){var t=r.current.user.isLoggedIn();this.$(".vf-anonymous-menu").toggle(!t),this.$(".vf-image-file, .vf-video-file").toggle(t),this.removeMessages(),t||this.clearUpload()},clear:function(){this.$("textarea").val(""),this.$("textarea").css("height",""),this.$("textarea").parent().css("height",""),this.clearUpload()},clearUpload:function(){if(this.enableSubmit(),this.$progressBar){this.$progressBar.hide(),delete this.mediaId,delete this.uploading;var t=this.$(".vf-image-file"),e=this.$(".vf-video-file");t.replaceWith(t.clone(!0)),e.replaceWith(e.clone(!0))}},onTextChange:function(e){e&&e.ctrlKey&&13===e.keyCode&&"keydown"===e.type&&this.submitForm(e);var i=t(e.target);this.cacheSave(this.$("textarea")),this.resizeTextarea(i)},onKeyUp:function(t){this.onTextChange(t),this.onCharacterChange(t)},onCharacterChange:function(e){if(!this.submittingComment){var i=t(e.target).val();this.countCharacters(i,this.showCharacterCount,this.maxCharacters,this.$(".vf-char-count"),this.$(".vf-tipsy-mask"))?this.disableSubmit(!0):this.enableSubmit(!0)}},getFormData:function(){var t={};return t.content=this.$(".vf-content").val(),t.anonymous_name=this.$("[name=vf_anonymous_name]").val(),this.mediaId&&(t.media_id=this.mediaId),t.parent_id=this.model.id,t},submitForm:function(e){e.preventDefault();var i=this.getFormData();i.content=h.cleanString(i.content);var n=new a(i);if(this.$(".vf-error-box").empty(),this.authorize("create",n)){if(this.validateComment(n,this.maxCharacters,this.original_text)){this.$(".vf-error-message, .vf-char-count").empty(),r.current.user.isLoggedIn()?delete i.anonymous_name:r.current.user.set("name",i.anonymous_name);var s=this;t.fn.loader.hideErrors(),this.$(".vf-comment-submit-wrap").loader("show",{gifType:"gray"}),this.disableSubmit(),n.save(i,{success:function(t){s.clear(),s.enableSubmit();var e=new a(t.result);o.trigger("comment:created",e),s.trigger("comment:submitted",e),s.submittingComment=!1,s.$(".vf-comment-submit-wrap").loader("hide")},error:function(t){s.enableSubmit(),s.submittingComment=!1,s.$(".vf-comment-submit-wrap").loader("hide"),s.displayError(s.i18n.apply(s,p.codeToI18n(t.api_code,t.api_code_data)))},xhr:!this.forceEncodeCount}),this.submittingComment=!0}else this.displayError(this.commentError);return this}},loginError:function(t){this.displayError(t)},uploadFile:function(e){this.clearUpload(),this.disableSubmit(),this.upload=new s({restAPI:this.restAPI,file:t(e.target),type:"media",session:r.current.session.id,section:this.section}),this.listenTo(this.upload,"progress",this.updateProgress),this.listenTo(this.upload,"done",this.updateProgress),this.listenTo(this.upload,"media",this.attachMedia),this.listenTo(this.upload,"error",this.uploadError),this.upload.upload()},cancelUpload:function(t){t&&t.preventDefault(),this.$(".vf-error-box").empty(),this.upload&&(this.upload.cancel(),this.stopListening(this.upload),delete this.upload),this.clearUpload()},attachMedia:function(t,e){this.mediaId=t.id||t.attributes.t&&t.attributes.t.id,m.assert(void 0!==this.upload,"Upload undefined"),this.stopListening(this.upload),delete this.upload,this.enableSubmit(),this.updateProgressBar("100%",100,!0),t.isVideo()?this.displaySuccess(this.i18n("video_uploaded_successfully")):t.isImage()&&this.displaySuccess(this.i18n("image_uploaded_successfully"))},uploadError:function(t){this.displayError(this.i18n(p.uploadStatusToI18n(t.status||t.http_status))),m.assert(void 0!==this.upload,"Upload undefined"),this.stopListening(this.upload),delete this.upload,this.clearUpload()},updateProgress:function(t){var e=t.state,i=0;"uploading"===e?(this.uploading=!0,i=Math.min(Math.floor(t.received/t.size*100),99)):"done"===e&&(delete this.uploading,i=99),this.updateProgressBar(i+"%",i,!!i)},updateProgressBar:function(t,e,i){this.$progressBar.toggle(i),this.$filename.text(t),this.$progress.css("width",e+"%")},showRecorder:function(t){t.preventDefault(),this.authorize("record")&&(this.listenTo(o,"/recorder/save",this.addStreamName),this.listenTo(o,"/recorder/redo/click",this.removeStreamName),this.listenTo(o,"/recorder/start/click",this.disableSubmit),this.listenTo(o,"/recorder/stop/click",this.enableSubmit),this.listenTo(o,"/modal/close",this.stopRecordListening),o.trigger("/video/recorder/click",r.current.user,this.model))},stopRecordListening:function(){this.stopListening(o,"/modal/close"),this.stopListening(o,"/recorder/save"),this.stopListening(o,"/recorder/redo/click"),this.stopListening(o,"/recorder/start/click"),this.stopListening(o,"/recorder/stop/click")},addStreamName:function(t){this.stream_name=t,this.restAPI.request({verb:"post",route:"/media/streams",data:{filename:t},success:this.onStreamSuccess,error:this.onStreamError}),this.disableSubmit()},onStreamSuccess:function(t){this.mediaId=t.result.id,this.enableSubmit(),this.updateProgressBar("100%",100,!0),this.displaySuccess(this.i18n("video_uploaded_successfully"))},onStreamError:function(t){t.error&&-1!=t.error.indexOf("S3::copyObject")||this.displayError(this.i18n(p.uploadStatusToI18n(t.http_status)))},removeStreamName:function(){this.enableSubmit(),this.stream_name=null,this.mediaId=null,this.updateProgressBar(0,0,!1),this.$(".vf-error-box").empty()},displayError:function(t){this.$(".vf-error-box").html(this.inlineError(t))},displaySuccess:function(t){this.$(".vf-error-box").html(this.inlineSuccess(t))},disableSubmit:function(t){!this.$submitButton||this.forcedDisabled!==!1&&t!==!0||(this.submit=!1,this.$submitButton.attr("disabled",!0),this.$(".vf-tipsy-mask").show(),this.forcedDisabled=!!t)},enableSubmit:function(t){!this.$submitButton||this.forcedDisabled!==!1&&t!==!0||(this.submit=!0,this.forcedDisabled=!1,this.$submitButton.removeAttr("disabled"),this.$(".vf-tipsy-mask").hide())},selectImageFile:function(t){t.preventDefault(),this.authorize("uploadImage")&&this.$(".vf-image-file").trigger("click")},selectVideoFile:function(t){t.preventDefault(),this.authorize("uploadVideo")&&this.$(".vf-video-file").trigger("click")},onUploadImage:function(){this.authorize("uploadImage")},onUploadVideo:function(){this.authorize("uploadVideo")}});return g}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(52),i(9),i(4),i(58)],s=function(t,e,i,n,s){var r=e.extend({templateName:"login_dashboard",tagName:"div",className:"vf-login-widget vf-clearfix",events:{"click .vf-login-button":"login","click .vf-logout":"logout","click .vf-logout-disable":"onDisableLogout","click .vf-signup-button":"register","click .vf-username":"userClick"},initialize:function(t){this.model=t.user,this.settings=t.settings,this.listenTo(this.model,"change:id change:name",this.render),this.listenTo(i,"/user/login/social/fail",this.loginError),this.listenTo(i,"/user/login/social/error",this.loginError),this.listenTo(i,"/user/login/social/cancel",this.hideDisable)},render:function(){var t;return this.model.isLoggedIn()||0!==this.settings.get("authprovider_viafoura_enabled")?(this.templateName="login_dashboard",t=this.model.toJSON(),this.templateOnly(t)):(this.templateName="social_logins",t=this.settings.toJSON(),this.templateOnly(t)),this},loginError:function(t){this.isDisabled()&&(this.hideDisable(),this.trigger("login:error",t))},login:function(t){t.preventDefault(),t.stopPropagation(),i.trigger("/user/login/click")},logout:function(t){t.preventDefault(),t.stopPropagation(),i.trigger("/user/logout/click")},register:function(t){t.preventDefault(),t.stopPropagation(),i.trigger("/user/signup/click")},userClick:function(t){t.preventDefault(),t.stopPropagation(),i.trigger("/user/account/click",this.model)},onDisableLogout:function(t){t.preventDefault()}});return t.extend(r.prototype,s.methods),t.extend(r.prototype.events,s.events),r}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(75)],s=function(t){var e={validateComment:function(e,i,n){delete this.commentError;var s=t.cleanString(e.get("content").replace(n,""));return""!==s||e.hasMedia()?s.length>i?(this.commentError=this.i18n("verror_maxLength",i),!1):!0:(this.commentError=this.i18n("verror_empty"),!1)}};return e}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2)],s=function(t){return{cleanString:function(t){return t&&"string"==typeof t?this.condense(this.trim(t)):""},trim:function(e){return t.trim(e)},condense:function(t){return t.replace(/\n\s*\n/g,"\n\n")}}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[],s=function(){var t={resizeTextarea:function(t){var e=t.outerHeight(),i=t[0].scrollHeight;i>e&&(t.parent().css({height:i+"px"}),t.css({height:i+"px"}))},resizeWithLimit:function(t,e,i){var n=t[0].scrollHeight;n>i?t.css({height:i+"px",overflow:"auto"}):(t.height(0),n=t[0].scrollHeight,e>n?t.css({height:e+"px",overflow:"hidden"}):t.css({height:n+"px",overflow:"hidden"}))}};return t}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(15)],s=function(t){var e={countCharacters:function(e,i,n,s,r){var o;if(o=t.supportCORS()||t.supportXDomain()&&!this.forceEncodeCount?e.length:encodeURIComponent(e).length,o>=i){if(s.text(n-o).show(),o>n)return s.removeClass("char-near-limit").addClass("char-over-limit"),r.tipsy({template:"charcounter",title:"over-char-limit",gravity:"ne"}),!0;r.tipsy("remove"),o>=n-50?s.removeClass("char-over-limit").addClass("char-near-limit"):s.removeClass("char-near-limit char-over-limit")}else s.empty().hide(),r.tipsy("remove");return!1}};return e}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n;n=function(){var t={defaultError:"something_went_wrong",codes:{65540:"banned_from_posting",65541:"page_is_closed",65542:"anonymous_not_enabled",131073:"flag_not_found",131074:"flag_login",131075:"flag_login_moderator",196609:"like_not_found",196610:"like_login",196611:"unlike_login",65555:"comment_content_same",65554:"reload_comment",327681:"user_update_email_in_use",327682:"user_update_password_required",327683:"user_update_picture_not_found",327684:"user_update_unrecognized_picture_format"},uploadCodes:{500:"something_went_wrong",400:"problem_uploading",401:"logged_in_to_upload",403:"your_account_banned",415:"cannot_process_upload"},codeToI18n:function(t,e){var i=[];if(this.codes.hasOwnProperty(t))switch(i.push(this.codes[t]),this.codes[t]){case"banned_from_posting":i.push(e&&e.reason||"")}else i.push(this.defaultError);return i},uploadStatusToI18n:function(t){return this.uploadCodes.hasOwnProperty(t)?this.uploadCodes[t]:this.defaultError}};return t}.call(e,i,e,t),!(void 0!==n&&(t.exports=n))},function(t,e,i){var n,s;n=[i(9),i(52)],s=function(t,e){var i=e.extend({tagName:"ul",className:"vf-user-meta vf-hlist vf-clearfix",templateName:"comment_user",events:{"click .vf-username":"showUser"},initialize:function(t){this.listenTo(this.model,"change",this.render),this.render()},render:function(){return this.$el.empty().append(this.template(this.model.toJSON())),this},showUser:function(e){e.prefentDefault(),t.trigger("/user/clicked",this.model)}});return i}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(9),i(52),i(22),i(81)],s=function(t,e,i,n,s){var r=i.extend({className:"vf-moderator-menu",templateName:"moderation",events:{"click .vf-spam-btn":"spamComment","click .vf-unspam-btn":"approveComment","click .vf-disable-btn":"disableComment","click .vf-approve-btn":"approveComment","click .vf-pick-btn":"pickComment","click .vf-unpick-btn":"unpickComment","click .vf-trust-btn":"trustUser","click .vf-untrust-btn":"untrustUser","click .vf-ban-btn":"banUser","click .vf-moderator-options":"onClick"},initialize:function(){t.bindAll(this,"onSuccess","onError"),this.user=this.model.user},render:function(){return this.$el.html(this.template({comment:this.model.toJSON(),user:this.user.toJSON()})),(this.user.isModOrAdmin()||this.user.isGuest())&&this.$(".vf-trust-btn, .vf-untrust-btn").remove(),this},onClick:function(){this.trigger("click")},spamComment:function(t){t.preventDefault(),this.model.save({status:"spam"},{error:this.onError})},approveComment:function(t){t.preventDefault(),this.model.save({status:"approved",date_edited:this.model.get("date_edited")},{error:this.onError})},disableComment:function(t){t.preventDefault(),this.model.save({status:"disabled"},{error:this.onError})},pickComment:function(t){t.preventDefault(),this.model.save({editor_pick:!0,date_edited:this.model.get("date_edited")},{error:this.onError})},unpickComment:function(t){t.preventDefault(),this.model.save({editor_pick:!1},{error:this.onError})},trustUser:function(t){t.preventDefault(),this.user.save({badge_trusted:!0},{success:this.onSuccess,error:this.onError})},onSuccess:function(){this.user.fetch({section:!1})},onError:function(t){this.trigger("error",t)},untrustUser:function(t){t.preventDefault(),this.user.save({badge_trusted:!1},{success:this.onSuccess,error:this.onError})},banUser:function(t){t.preventDefault();var e=this.user,i=new s;i.save({user_id:e.attributes.id,type:"hide"},{success:this.onSuccess,error:this.onError})}});return r}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(7)],s=function(t){var e=t.extend({url:"/bans"});return e}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(52),i(83),i(12)],s=function(t,e,i){var n=t.extend({attributes:{"class":"vf-player"},initialize:function(t){this.startPaused=t.startPaused||!1},templateName:"player",render:function(){var t=this.model,n=t.attributes.mp4,s=t.attributes.webm,r=t.id;this.id=r||1;var o=this.$el.parent().width()||400,a=o/16*9|0;o*=.75,a*=.75,n&&s&&(n=n.replace("https:",location.protocol),s=s.replace("https:",location.protocol)),this.$el.append(this.template({mp4:n,webm:s,id:r,height:a,width:o}));var l="http://get.adobe.com/flashplayer";return this.mejs=new e(this.$("video")[0],{features:["playpause","progress","current","duration","volume"],startVolume:.5,plugins:["flash"],errorHtml:this.i18n("download_flash",l),pluginPath:i.asset_url+"swf/",success:function(t){this.startPaused||t.play()}.bind(this)}),this},videoRendered:function(){return!!this.mejs},play:function(){return this.videoRendered()&&this.mejs.play&&this.mejs.play(),this},pause:function(){return this.videoRendered()&&this.mejs.pause&&this.mejs.pause(),this}});return n}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,n){var s;s=function(){return window.mejs=window.mejs||{},mejs.version="2.11.0",mejs.meIndex=0,mejs.plugins={silverlight:[{version:[3,0],types:["video/mp4","video/m4v","video/mov","video/wmv","audio/wma","audio/m4a","audio/mp3","audio/wav","audio/mpeg"]}],flash:[{version:[9,0,124],types:["video/mp4","video/m4v","video/mov","video/flv","video/rtmp","video/x-flv","audio/flv","audio/x-flv","audio/mp3","audio/m4a","audio/mpeg","video/youtube","video/x-youtube"]}],youtube:[{version:null,types:["video/youtube","video/x-youtube","audio/youtube","audio/x-youtube"]}],vimeo:[{version:null,types:["video/vimeo","video/x-vimeo"]}]},mejs.Utility={encodeUrl:function(t){return encodeURIComponent(t)},escapeHTML:function(t){return t.toString().split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")},absolutizeUrl:function(t){var e=document.createElement("div");return e.innerHTML='<a href="'+this.escapeHTML(t)+'">x</a>',e.firstChild.href},getScriptPath:function(t){for(var e,i,n=0,s="",r="",o=document.getElementsByTagName("script"),a=o.length,l=t.length;a>n;n++){for(i=o[n].src,e=0;l>e;e++)if(r=t[e],i.indexOf(r)>-1){s=i.substring(0,i.indexOf(r));break}if(""!==s)break}return s},secondsToTimeCode:function(t,e,i,n){"undefined"==typeof i?i=!1:"undefined"==typeof n&&(n=25);var s=Math.floor(t/3600)%24,r=Math.floor(t/60)%60,o=Math.floor(t%60),a=Math.floor((t%1*n).toFixed(3)),l=(e||s>0?(10>s?"0"+s:s)+":":"")+(10>r?"0"+r:r)+":"+(10>o?"0"+o:o)+(i?":"+(10>a?"0"+a:a):"");return l},timeCodeToSeconds:function(t,e,i,n){"undefined"==typeof i?i=!1:"undefined"==typeof n&&(n=25);var s=t.split(":"),r=parseInt(s[0],10),o=parseInt(s[1],10),a=parseInt(s[2],10),l=0,u=0;return i&&(l=parseInt(s[3])/n),u=3600*r+60*o+a+l},convertSMPTEtoSeconds:function(t){if("string"!=typeof t)return!1;t=t.replace(",",".");var e=0,i=-1!=t.indexOf(".")?t.split(".")[1].length:0,n=1;t=t.split(":").reverse();for(var s=0;s<t.length;s++)n=1,s>0&&(n=Math.pow(60,s)),e+=Number(t[s])*n;return Number(e.toFixed(i))},removeSwf:function(t){var e=document.getElementById(t);e&&/object|embed/i.test(e.nodeName)&&(mejs.MediaFeatures.isIE?(e.style.display="none",function(){4==e.readyState?mejs.Utility.removeObjectInIE(t):setTimeout(arguments.callee,10)}()):e.parentNode.removeChild(e))},removeObjectInIE:function(t){var e=document.getElementById(t);if(e){for(var i in e)"function"==typeof e[i]&&(e[i]=null);e.parentNode.removeChild(e)}}},mejs.PluginDetector={hasPluginVersion:function(t,e){var i=this.plugins[t];return e[1]=e[1]||0,e[2]=e[2]||0,i[0]>e[0]||i[0]==e[0]&&i[1]>e[1]||i[0]==e[0]&&i[1]==e[1]&&i[2]>=e[2]?!0:!1},nav:window.navigator,ua:window.navigator.userAgent.toLowerCase(),plugins:[],addPlugin:function(t,e,i,n,s){this.plugins[t]=this.detectPlugin(e,i,n,s)},detectPlugin:function(t,e,i,n){var s,r,o,a=[0,0,0];if("undefined"!=typeof this.nav.plugins&&"object"==typeof this.nav.plugins[t]){if(s=this.nav.plugins[t].description,s&&("undefined"==typeof this.nav.mimeTypes||!this.nav.mimeTypes[e]||this.nav.mimeTypes[e].enabledPlugin))for(a=s.replace(t,"").replace(/^\s+/,"").replace(/\sr/gi,".").split("."),r=0;r<a.length;r++)a[r]=parseInt(a[r].match(/\d+/),10)}else if("undefined"!=typeof window.ActiveXObject)try{o=new ActiveXObject(i),o&&(a=n(o))}catch(l){}return a}},mejs.PluginDetector.addPlugin("flash","Shockwave Flash","application/x-shockwave-flash","ShockwaveFlash.ShockwaveFlash",function(t){var e=[],i=t.GetVariable("$version");return i&&(i=i.split(" ")[1].split(","),e=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]),e}),mejs.PluginDetector.addPlugin("silverlight","Silverlight Plug-In","application/x-silverlight-2","AgControl.AgControl",function(t){var e=[0,0,0,0],i=function(t,e,i,n){for(;t.isVersionSupported(e[0]+"."+e[1]+"."+e[2]+"."+e[3]);)e[i]+=n;e[i]-=n};return i(t,e,0,1),i(t,e,1,1),i(t,e,2,1e4),i(t,e,2,1e3),i(t,e,2,100),i(t,e,2,10),i(t,e,2,1),i(t,e,3,1),e}),mejs.MediaFeatures={init:function(){var t,e,i=this,n=document,s=mejs.PluginDetector.nav,r=mejs.PluginDetector.ua.toLowerCase(),o=["source","track","audio","video"];i.isiPad=null!==r.match(/ipad/i),i.isiPhone=null!==r.match(/iphone/i),i.isiOS=i.isiPhone||i.isiPad,i.isAndroid=null!==r.match(/android/i),i.isBustedAndroid=null!==r.match(/android 2\.[12]/),i.isIE=-1!=s.appName.toLowerCase().indexOf("microsoft"),i.isChrome=null!==r.match(/chrome/gi),i.isFirefox=null!==r.match(/firefox/gi),i.isWebkit=null!==r.match(/webkit/gi),i.isGecko=null!==r.match(/gecko/gi)&&!i.isWebkit,i.isOpera=null!==r.match(/opera/gi),i.hasTouch="ontouchstart"in window,i.svg=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect;for(t=0;t<o.length;t++)e=document.createElement(o[t]);i.supportsMediaTag="undefined"!=typeof e.canPlayType||i.isBustedAndroid,i.hasSemiNativeFullScreen="undefined"!=typeof e.webkitEnterFullscreen,i.hasWebkitNativeFullScreen="undefined"!=typeof e.webkitRequestFullScreen,i.hasMozNativeFullScreen="undefined"!=typeof e.mozRequestFullScreen,i.hasTrueNativeFullScreen=i.hasWebkitNativeFullScreen||i.hasMozNativeFullScreen,i.nativeFullScreenEnabled=i.hasTrueNativeFullScreen,i.hasMozNativeFullScreen&&(i.nativeFullScreenEnabled=e.mozFullScreenEnabled),this.isChrome&&(i.hasSemiNativeFullScreen=!1),i.hasTrueNativeFullScreen&&(i.fullScreenEventName=i.hasWebkitNativeFullScreen?"webkitfullscreenchange":"mozfullscreenchange",i.isFullScreen=function(){return e.mozRequestFullScreen?n.mozFullScreen:e.webkitRequestFullScreen?n.webkitIsFullScreen:void 0},i.requestFullScreen=function(t){i.hasWebkitNativeFullScreen?t.webkitRequestFullScreen():i.hasMozNativeFullScreen&&t.mozRequestFullScreen()},i.cancelFullScreen=function(){i.hasWebkitNativeFullScreen?document.webkitCancelFullScreen():i.hasMozNativeFullScreen&&document.mozCancelFullScreen()}),i.hasSemiNativeFullScreen&&r.match(/mac os x 10_5/i)&&(i.hasNativeFullScreen=!1,i.hasSemiNativeFullScreen=!1)}},mejs.MediaFeatures.init(),mejs.HtmlMediaElement={pluginType:"native",isFullScreen:!1,setCurrentTime:function(t){this.currentTime=t},setMuted:function(t){this.muted=t},setVolume:function(t){this.volume=t},stop:function(){this.pause()},setSrc:function(t){for(var e=this.getElementsByTagName("source");e.length>0;)this.removeChild(e[0]);if("string"==typeof t)this.src=t;else{var i,n;for(i=0;i<t.length;i++)if(n=t[i],this.canPlayType(n.type)){this.src=n.src;break}}},setVideoSize:function(t,e){this.width=t,this.height=e}},mejs.PluginMediaElement=function(t,e,i){this.id=t,this.pluginType=e,this.src=i,this.events={},this.attributes={}},mejs.PluginMediaElement.prototype={pluginElement:null,pluginType:"",isFullScreen:!1,playbackRate:-1,defaultPlaybackRate:-1,seekable:[],played:[],paused:!0,ended:!1,seeking:!1,duration:0,error:null,tagName:"",muted:!1,volume:1,currentTime:0,play:function(){null!=this.pluginApi&&("youtube"==this.pluginType?this.pluginApi.playVideo():this.pluginApi.playMedia(),this.paused=!1)},load:function(){null!=this.pluginApi&&("youtube"==this.pluginType||this.pluginApi.loadMedia(),this.paused=!1)},pause:function(){null!=this.pluginApi&&("youtube"==this.pluginType?this.pluginApi.pauseVideo():this.pluginApi.pauseMedia(),this.paused=!0)},stop:function(){null!=this.pluginApi&&("youtube"==this.pluginType?this.pluginApi.stopVideo():this.pluginApi.stopMedia(),this.paused=!0)},canPlayType:function(t){var e,i,n,s=mejs.plugins[this.pluginType];for(e=0;e<s.length;e++)if(n=s[e],mejs.PluginDetector.hasPluginVersion(this.pluginType,n.version))for(i=0;i<n.types.length;i++)if(t==n.types[i])return"probably";return""},positionFullscreenButton:function(t,e,i){null!=this.pluginApi&&this.pluginApi.positionFullscreenButton&&this.pluginApi.positionFullscreenButton(t,e,i)},hideFullscreenButton:function(){null!=this.pluginApi&&this.pluginApi.hideFullscreenButton&&this.pluginApi.hideFullscreenButton()},setSrc:function(t){if("string"==typeof t)this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(t)),this.src=mejs.Utility.absolutizeUrl(t);else{var e,i;for(e=0;e<t.length;e++)if(i=t[e],this.canPlayType(i.type)){this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(i.src)),this.src=mejs.Utility.absolutizeUrl(t);break}}},setCurrentTime:function(t){null!=this.pluginApi&&("youtube"==this.pluginType?this.pluginApi.seekTo(t):this.pluginApi.setCurrentTime(t),this.currentTime=t)},setVolume:function(t){null!=this.pluginApi&&("youtube"==this.pluginType?this.pluginApi.setVolume(100*t):this.pluginApi.setVolume(t),this.volume=t)},setMuted:function(t){null!=this.pluginApi&&("youtube"==this.pluginType?(t?this.pluginApi.mute():this.pluginApi.unMute(),this.muted=t,this.dispatchEvent("volumechange")):this.pluginApi.setMuted(t),this.muted=t)},setVideoSize:function(t,e){this.pluginElement.style&&(this.pluginElement.style.width=t+"px",this.pluginElement.style.height=e+"px"),null!=this.pluginApi&&this.pluginApi.setVideoSize&&this.pluginApi.setVideoSize(t,e)},setFullscreen:function(t){null!=this.pluginApi&&this.pluginApi.setFullscreen&&this.pluginApi.setFullscreen(t)},enterFullScreen:function(){null!=this.pluginApi&&this.pluginApi.setFullscreen&&this.setFullscreen(!0)},exitFullScreen:function(){null!=this.pluginApi&&this.pluginApi.setFullscreen&&this.setFullscreen(!1)},addEventListener:function(t,e,i){this.events[t]=this.events[t]||[],this.events[t].push(e)},removeEventListener:function(t,e){if(!t)return this.events={},!0;var n=this.events[t];if(!n)return!0;if(!e)return this.events[t]=[],!0;for(i=0;i<n.length;i++)if(n[i]===e)return this.events[t].splice(i,1),!0;return!1},dispatchEvent:function(t){var e,i,n=this.events[t];if(n)for(i=Array.prototype.slice.call(arguments,1),e=0;e<n.length;e++)n[e].apply(null,i)},hasAttribute:function(t){return t in this.attributes},removeAttribute:function(t){delete this.attributes[t]},getAttribute:function(t){return this.hasAttribute(t)?this.attributes[t]:""},setAttribute:function(t,e){this.attributes[t]=e},remove:function(){mejs.Utility.removeSwf(this.pluginElement.id),mejs.MediaPluginBridge.unregisterPluginElement(this.pluginElement.id)}},mejs.MediaPluginBridge={pluginMediaElements:{},htmlMediaElements:{},registerPluginElement:function(t,e,i){this.pluginMediaElements[t]=e,this.htmlMediaElements[t]=i},unregisterPluginElement:function(t){delete this.pluginMediaElements[t],delete this.htmlMediaElements[t]},initPlugin:function(t){var e=this.pluginMediaElements[t],i=this.htmlMediaElements[t];if(e){switch(e.pluginType){case"flash":e.pluginElement=e.pluginApi=document.getElementById(t);break;case"silverlight":e.pluginElement=document.getElementById(e.id),e.pluginApi=e.pluginElement.Content.MediaElementJS}null!=e.pluginApi&&e.success&&e.success(e,i)}},fireEvent:function(t,e,i){var n,s,r,o=this.pluginMediaElements[t];n={type:e,target:o};for(s in i)o[s]=i[s],n[s]=i[s];r=i.bufferedTime||0,
n.target.buffered=n.buffered={start:function(t){return 0},end:function(t){return r},length:1},o.dispatchEvent(n.type,n)}},mejs.MediaElementDefaults={mode:"auto",plugins:["flash","silverlight","youtube","vimeo"],enablePluginDebug:!1,type:"",pluginPath:mejs.Utility.getScriptPath(["mediaelement.js","mediaelement.min.js","mediaelement-and-player.js","mediaelement-and-player.min.js"]),flashName:"flashmediaelement.swf",flashStreamer:"",enablePluginSmoothing:!1,silverlightName:"silverlightmediaelement.xap",defaultVideoWidth:480,defaultVideoHeight:270,pluginWidth:-1,pluginHeight:-1,pluginVars:[],timerRate:250,startVolume:.8,success:function(){},error:function(){}},mejs.MediaElement=function(t,e){return mejs.HtmlMediaElementShim.create(t,e)},mejs.HtmlMediaElementShim={create:function(t,e){var i,n,s=mejs.MediaElementDefaults,r="string"==typeof t?document.getElementById(t):t,o=r.tagName.toLowerCase(),a="audio"===o||"video"===o,l=a?r.getAttribute("src"):r.getAttribute("href"),u=r.getAttribute("poster"),c=r.getAttribute("autoplay"),h=r.getAttribute("preload"),d=r.getAttribute("controls");for(n in e)s[n]=e[n];return l="undefined"==typeof l||null===l||""==l?null:l,u="undefined"==typeof u||null===u?"":u,h="undefined"==typeof h||null===h||"false"===h?"none":h,c=!("undefined"==typeof c||null===c||"false"===c),d=!("undefined"==typeof d||null===d||"false"===d),i=this.determinePlayback(r,s,mejs.MediaFeatures.supportsMediaTag,a,l),i.url=null!==i.url?mejs.Utility.absolutizeUrl(i.url):"","native"==i.method?(mejs.MediaFeatures.isBustedAndroid&&(r.src=i.url,r.addEventListener("click",function(){r.play()},!1)),this.updateNative(i,s,c,h)):""!==i.method?this.createPlugin(i,s,u,c,h,d):(this.createErrorMessage(i,s,u),this)},determinePlayback:function(t,e,i,n,s){var r,o,a,l,u,c,h,d,f,p,m,g=[],v={method:"",url:"",htmlMediaElement:t,isVideo:"audio"!=t.tagName.toLowerCase()};if("undefined"!=typeof e.type&&""!==e.type)if("string"==typeof e.type)g.push({type:e.type,url:s});else for(r=0;r<e.type.length;r++)g.push({type:e.type[r],url:s});else if(null!==s)c=this.formatType(s,t.getAttribute("type")),g.push({type:c,url:s});else for(r=0;r<t.childNodes.length;r++)u=t.childNodes[r],1==u.nodeType&&"source"==u.tagName.toLowerCase()&&(s=u.getAttribute("src"),c=this.formatType(s,u.getAttribute("type")),m=u.getAttribute("media"),(!m||!window.matchMedia||window.matchMedia&&window.matchMedia(m).matches)&&g.push({type:c,url:s}));if(!n&&g.length>0&&null!==g[0].url&&this.getTypeFromFile(g[0].url).indexOf("audio")>-1&&(v.isVideo=!1),mejs.MediaFeatures.isBustedAndroid&&(t.canPlayType=function(t){return null!==t.match(/video\/(mp4|m4v)/gi)?"maybe":""}),i&&("auto"===e.mode||"auto_plugin"===e.mode||"native"===e.mode)){for(n||(p=document.createElement(v.isVideo?"video":"audio"),t.parentNode.insertBefore(p,t),t.style.display="none",v.htmlMediaElement=t=p),r=0;r<g.length;r++)if(""!==t.canPlayType(g[r].type).replace(/no/,"")||""!==t.canPlayType(g[r].type.replace(/mp3/,"mpeg")).replace(/no/,"")){v.method="native",v.url=g[r].url;break}if("native"===v.method&&(null!==v.url&&(t.src=v.url),"auto_plugin"!==e.mode))return v}if("auto"===e.mode||"auto_plugin"===e.mode||"shim"===e.mode)for(r=0;r<g.length;r++)for(c=g[r].type,o=0;o<e.plugins.length;o++)for(h=e.plugins[o],d=mejs.plugins[h],a=0;a<d.length;a++)if(f=d[a],null==f.version||mejs.PluginDetector.hasPluginVersion(h,f.version))for(l=0;l<f.types.length;l++)if(c==f.types[l])return v.method=h,v.url=g[r].url,v;return"auto_plugin"===e.mode&&"native"===v.method?v:(""===v.method&&g.length>0&&(v.url=g[0].url),v)},formatType:function(t,e){return t&&!e?this.getTypeFromFile(t):e&&~e.indexOf(";")?e.substr(0,e.indexOf(";")):e},getTypeFromFile:function(t){t=t.split("?")[0];var e=t.substring(t.lastIndexOf(".")+1);return(/(mp4|m4v|ogg|ogv|webm|webmv|flv|wmv|mpeg|mov)/gi.test(e)?"video":"audio")+"/"+this.getTypeFromExtension(e)},getTypeFromExtension:function(t){switch(t){case"mp4":case"m4v":return"mp4";case"webm":case"webma":case"webmv":return"webm";case"ogg":case"oga":case"ogv":return"ogg";default:return t}},createErrorMessage:function(t,e,i){var n=t.htmlMediaElement,s=document.createElement("div");s.className="me-cannotplay";try{s.style.width=n.width+"px",s.style.height=n.height+"px"}catch(r){}e.errorHtml?s.innerHTML=e.errorHtml:s.innerHTML=""!==i?'<a href="'+t.url+'"><img src="'+i+'" width="100%" height="100%" /></a>':'<a href="'+t.url+'"><span>Download File</span></a>',n.parentNode.insertBefore(s,n),n.style.display="none",e.error(n)},createPlugin:function(t,e,i,n,s,r){var o,a,l,u=t.htmlMediaElement,c=1,h=1,d="me_"+t.method+"_"+mejs.meIndex++,f=new mejs.PluginMediaElement(d,t.method,t.url),p=document.createElement("div");f.tagName=u.tagName;for(var m=0;m<u.attributes.length;m++){var g=u.attributes[m];1==g.specified&&f.setAttribute(g.name,g.value)}for(a=u.parentNode;null!==a&&"body"!=a.tagName.toLowerCase();){if("p"==a.parentNode.tagName.toLowerCase()){a.parentNode.parentNode.insertBefore(a,a.parentNode);break}a=a.parentNode}switch(t.isVideo?(c=e.videoWidth>0?e.videoWidth:null!==u.getAttribute("width")?u.getAttribute("width"):e.defaultVideoWidth,h=e.videoHeight>0?e.videoHeight:null!==u.getAttribute("height")?u.getAttribute("height"):e.defaultVideoHeight,c=mejs.Utility.encodeUrl(c),h=mejs.Utility.encodeUrl(h)):e.enablePluginDebug&&(c=320,h=240),f.success=e.success,mejs.MediaPluginBridge.registerPluginElement(d,f,u),p.className="me-plugin",p.id=d+"_container",t.isVideo?u.parentNode.insertBefore(p,u):document.body.insertBefore(p,document.body.childNodes[0]),l=["id="+d,"isvideo="+(t.isVideo?"true":"false"),"autoplay="+(n?"true":"false"),"preload="+s,"width="+c,"startvolume="+e.startVolume,"timerrate="+e.timerRate,"flashstreamer="+e.flashStreamer,"height="+h],null!==t.url&&("flash"==t.method?l.push("file="+mejs.Utility.encodeUrl(t.url)):l.push("file="+t.url)),e.enablePluginDebug&&l.push("debug=true"),e.enablePluginSmoothing&&l.push("smoothing=true"),r&&l.push("controls=true"),e.pluginVars&&(l=l.concat(e.pluginVars)),t.method){case"silverlight":p.innerHTML='<object data="data:application/x-silverlight-2," type="application/x-silverlight-2" id="'+d+'" name="'+d+'" width="'+c+'" height="'+h+'" class="mejs-shim"><param name="initParams" value="'+l.join(",")+'" /><param name="windowless" value="true" /><param name="background" value="black" /><param name="minRuntimeVersion" value="3.0.0.0" /><param name="autoUpgrade" value="true" /><param name="source" value="'+e.pluginPath+e.silverlightName+'" /></object>';break;case"flash":mejs.MediaFeatures.isIE?(o=document.createElement("div"),p.appendChild(o),o.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" id="'+d+'" width="'+c+'" height="'+h+'" class="mejs-shim"><param name="movie" value="'+e.pluginPath+e.flashName+"?x="+new Date+'" /><param name="flashvars" value="'+l.join("&amp;")+'" /><param name="quality" value="high" /><param name="bgcolor" value="#000000" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="true" /></object>'):p.innerHTML='<embed id="'+d+'" name="'+d+'" play="true" loop="false" quality="high" bgcolor="#000000" wmode="transparent" allowScriptAccess="always" allowFullScreen="true" type="application/x-shockwave-flash" pluginspage="//www.macromedia.com/go/getflashplayer" src="'+e.pluginPath+e.flashName+'" flashvars="'+l.join("&")+'" width="'+c+'" height="'+h+'" class="mejs-shim"></embed>';break;case"youtube":var v=t.url.substr(t.url.lastIndexOf("=")+1);youtubeSettings={container:p,containerId:p.id,pluginMediaElement:f,pluginId:d,videoId:v,height:h,width:c},mejs.PluginDetector.hasPluginVersion("flash",[10,0,0])?mejs.YouTubeApi.createFlash(youtubeSettings):mejs.YouTubeApi.enqueueIframe(youtubeSettings);break;case"vimeo":f.vimeoid=t.url.substr(t.url.lastIndexOf("/")+1),p.innerHTML='<iframe src="http://player.vimeo.com/video/'+f.vimeoid+'?portrait=0&byline=0&title=0" width="'+c+'" height="'+h+'" frameborder="0" class="mejs-shim"></iframe>'}return u.style.display="none",f},updateNative:function(t,e,i,n){var s,r=t.htmlMediaElement;for(s in mejs.HtmlMediaElement)r[s]=mejs.HtmlMediaElement[s];return e.success(r,r),r}},mejs.YouTubeApi={isIframeStarted:!1,isIframeLoaded:!1,loadIframeApi:function(){if(!this.isIframeStarted){var t=document.createElement("script");t.src="http://www.youtube.com/player_api";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e),this.isIframeStarted=!0}},iframeQueue:[],enqueueIframe:function(t){this.isLoaded?this.createIframe(t):(this.loadIframeApi(),this.iframeQueue.push(t))},createIframe:function(t){var e=t.pluginMediaElement,i=new YT.Player(t.containerId,{height:t.height,width:t.width,videoId:t.videoId,playerVars:{controls:0},events:{onReady:function(){t.pluginMediaElement.pluginApi=i,mejs.MediaPluginBridge.initPlugin(t.pluginId),setInterval(function(){mejs.YouTubeApi.createEvent(i,e,"timeupdate")},250)},onStateChange:function(t){mejs.YouTubeApi.handleStateChange(t.data,i,e)}}})},createEvent:function(t,e,i){var n={type:i,target:e};if(t&&t.getDuration){e.currentTime=n.currentTime=t.getCurrentTime(),e.duration=n.duration=t.getDuration(),n.paused=e.paused,n.ended=e.ended,n.muted=t.isMuted(),n.volume=t.getVolume()/100,n.bytesTotal=t.getVideoBytesTotal(),n.bufferedBytes=t.getVideoBytesLoaded();var s=n.bufferedBytes/n.bytesTotal*n.duration;n.target.buffered=n.buffered={start:function(t){return 0},end:function(t){return s},length:1}}e.dispatchEvent(n.type,n)},iFrameReady:function(){for(this.isLoaded=!0,this.isIframeLoaded=!0;this.iframeQueue.length>0;){var t=this.iframeQueue.pop();this.createIframe(t)}},flashPlayers:{},createFlash:function(t){this.flashPlayers[t.pluginId]=t;var e,i="http://www.youtube.com/apiplayer?enablejsapi=1&amp;playerapiid="+t.pluginId+"&amp;version=3&amp;autoplay=0&amp;controls=0&amp;modestbranding=1&loop=0";mejs.MediaFeatures.isIE?(e=document.createElement("div"),t.container.appendChild(e),e.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" id="'+t.pluginId+'" width="'+t.width+'" height="'+t.height+'" class="mejs-shim"><param name="movie" value="'+i+'" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="true" /></object>'):t.container.innerHTML='<object type="application/x-shockwave-flash" id="'+t.pluginId+'" data="'+i+'" width="'+t.width+'" height="'+t.height+'" style="visibility: visible; " class="mejs-shim"><param name="allowScriptAccess" value="always"><param name="wmode" value="transparent"></object>'},flashReady:function(t){var e=this.flashPlayers[t],i=document.getElementById(t),n=e.pluginMediaElement;n.pluginApi=n.pluginElement=i,mejs.MediaPluginBridge.initPlugin(t),i.cueVideoById(e.videoId);var s=e.containerId+"_callback";window[s]=function(t){mejs.YouTubeApi.handleStateChange(t,i,n)},i.addEventListener("onStateChange",s),setInterval(function(){mejs.YouTubeApi.createEvent(i,n,"timeupdate")},250)},handleStateChange:function(t,e,i){switch(t){case-1:i.paused=!0,i.ended=!0,mejs.YouTubeApi.createEvent(e,i,"loadedmetadata");break;case 0:i.paused=!1,i.ended=!0,mejs.YouTubeApi.createEvent(e,i,"ended");break;case 1:i.paused=!1,i.ended=!1,mejs.YouTubeApi.createEvent(e,i,"play"),mejs.YouTubeApi.createEvent(e,i,"playing");break;case 2:i.paused=!0,i.ended=!1,mejs.YouTubeApi.createEvent(e,i,"pause");break;case 3:mejs.YouTubeApi.createEvent(e,i,"progress");break;case 5:}}},mejs.MediaElement}.call(e,n,e,t),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(7)],s=function(t){var e=t.extend({url:"/media"});return e}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(9),i(4),i(52)],s=function(t,e,i,n){var s=n.extend({templateName:"processing_status",initialize:function(t){this.comment=t.comment,this.listenTo(this.comment,"change:processing_status",this.render),this.listenTo(this.comment.user,"change:ban_level",this.render)},render:function(){var t=this.comment.toJSON();return t.user=this.comment.user.toJSON(),t.current_user=i.current.user.toJSON(),this.templateOnly(t),this}});return s}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(6),i(4),i(52),i(74),i(75),i(76),i(77),i(87),i(78),i(15)],s=function(t,e,i,n,s,r,o,a,l,u,c){var h=n.extend({mixins:[a,s,o],templateName:"comment_edit_form",className:"vf-comment-edit vf-clearfix",events:{"click .vf-comment-edit-cancel":"cancel","click .vf-comment-edit-save":"submit","keydown .vf-comment-container":"onTextChange","input .vf-comment-container":"onTextChange"},eventsForIE:{"click .vf-comment-edit-cancel":"cancel","click .vf-comment-edit-save":"submit","input .vf-comment-container":"onIETextChange","keyup .vf-comment-container":"onIETextChange","keydown .vf-comment-container":"onIETextChange"},initialize:function(t){if(e.bindAll(this,"onSuccess","onError"),this.countdown=new l,this.listenTo(this.countdown,"finish",this.onCountFinish),this.forceEncodeCount=c.getIEVersion()&&c.getIEVersion()<=9,this.model.hasEditTimeLeft()){var i=this.model.getEditTimeLeft();this.countdown.start(i)}this.$holder=t.holder,this.maxCharacters=this.domainSettings.get("comment_max_length"),this.showCharacterCount=this.maxCharacters-100,this.originalContent=this.model.get("content")},render:function(){var t=c.getIEVersion();0!==t&&9>=t&&this.delegateEvents(this.eventsForIE);var e={showTimer:this.model.hasEditTimeLimit(),comment:this.model.toJSON()};this.$el.html(this.template(e)),this.$saveButton=this.$(".vf-comment-edit-save"),this.$cancelButton=this.$(".vf-comment-edit-cancel"),this.$tipsyMask=this.$(".vf-tipsy-mask"),this.$("textarea").focus().trigger("input"),this.countdown.setElement(this.$(".vf-timer")),this.countdown.renderTime(),this.countdown.finished&&this.onCountFinish()},onTextChange:function(e){e&&e.ctrlKey&&13===e.keyCode&&"keydown"===e.type&&this.submit(e);var i=t(e.target);this.resizeWithLimit(i,100,400),this.onCharactersChange(e)},onIETextChange:function(e){var i=t(e.target);this.resizeTextarea(i),this.onCharactersChange(e)},replaceHolder:function(){this.$holder.replaceWith(this.$el)},revertHolder:function(){this.$el.replaceWith(this.$holder)},onCountFinish:function(){this.$(".vf-time-remaining-desc").empty(),this.$(".vf-timer").empty().text(this.i18n("timer_ended")),this.outOfTime=!0,this.disableSave(!0),this.$(".vf-tipsy-mask").tipsy({title:"timer_ended_tip"})},cancel:function(t){t&&t.preventDefault(),this.trigger("finish")},saveComment:function(){this.submittingComment=!0,this.disableSave(!0),this.$(".vf-error-message, .vf-char-count").empty(),this.$(".vf-comment-edit-save").loader("show");var t=!this.forceEncodeCount;this.model.save({content:this.model.get("content")},{xhr:t,success:this.onSuccess,error:this.onError})},onSuccess:function(t){this.submittingComment=!1,this.$(".vf-comment-edit-save").loader("hide"),this.enableSave(!0),this.trigger("finish")},onError:function(t){this.submittingComment=!1,this.enableSave(!0),this.model.set("content",this.originalContent),this.$(".vf-comment-edit-save").loader("hide");var e=u.codeToI18n(t.api_code),i=this.i18n.apply(this,e);this.showError(i)},showError:function(t){this.$(".vf-error-box").html("<div class='vf-error-message'>"+t+"<div>")},submit:function(t){t.preventDefault(),this.outOfTime||(this.model.set("content",r.cleanString(this.$("textarea").val())),this.validateComment(this.model)?this.originalContent===this.model.get("content")?this.cancel():this.saveComment():(this.model.set("content",this.originalContent),this.showError(this.commentError)))},onCharactersChange:function(e){if(!this.submittingComment&&!this.outOfTime){var i=t(e.target).val();this.countCharacters(i,this.showCharacterCount,this.maxCharacters,this.$(".vf-char-count"),this.$tipsyMask)?this.disableSave(!0):this.enableSave(!0)}},disableSave:function(t){!this.$saveButton||this.forcedDisabled!==!1&&t!==!0||(this.save=!1,this.$saveButton.attr("disabled",!0),this.$tipsyMask.show(),this.forcedDisabled=!!t)},enableSave:function(t){!this.$saveButton||this.forcedDisabled!==!1&&t!==!0||(this.save=!0,this.forcedDisabled=!1,this.$saveButton.removeAttr("disabled"),this.$tipsyMask.hide())},remove:function(){n.prototype.remove.call(this),this.countdown.stop()}});return h}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(52),i(15)],s=function(t,e,i){var n=e.extend({initialize:function(){t.bindAll(this,"timerComplete"),this.started=!1,this.timerIntervalShort=1e3,this.timerIntervalMedium=1e4,this.timerIntervalLong=6e4},renderTime:function(){var t=this.getTimeLeftWords(this.endTime,this.domainSettings.currentTime());this.$el.html(t)},start:function(t){this.endTime=t,this.stop(),this.started=!0,this.timerComplete()},stop:function(){this.started=!1},timerComplete:function(){if(!this.started)return!1;this.renderTime();var t=i.getTimeLeft(this.endTime,this.domainSettings.currentTime());t>36e5?setTimeout(this.timerComplete,this.timerIntervalLong):t>9e5?setTimeout(this.timerComplete,this.timerIntervalMedium):t>0?setTimeout(this.timerComplete,this.timerIntervalShort):(this.finished=!0,this.trigger("finish"))}});return n}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(6),i(52),i(87)],s=function(t,e,i,n){var s=i.extend({templateName:"comment_user_actions",className:"vf-comment-user-actions",events:{"click .vf-comment-edit-link":"onEdit","click .vf-comment-remove-link":"onRemove"},confirmEvents:{"click .vf-yes":"onConfirmYes","click .vf-no":"onConfirmNo"},initialize:function(t){if(e.bindAll(this,"onRemoveSuccess","onRemoveError"),this.comment=t.comment,this.parent=t.parent,this.countdown=new n,this.listenTo(this.countdown,"finish",this.onCountFinish),this.comment.hasEditTimeLeft()){var i=this.comment.getEditTimeLeft();this.countdown.start(i)}},render:function(){var t={showTimer:this.comment.hasEditTimeLimit(),canUpdate:this.can("update",this.comment),canRemove:this.can("remove",this.comment)};this.$el.html(this.template(t)),this.delegateEvents(),this.countdown.setElement(this.$(".vf-timer")),this.countdown.renderTime()},renderConfirm:function(){this.parent.$(".vf-comment-html").addClass("vf-remove-confirm"),this.$el.html(this.template(null,"comment_confirm_remove")),this.delegateEvents(this.confirmEvents)},onEdit:function(t){t.preventDefault(),this.trigger("edit")},onRemove:function(t){t.preventDefault(),this.renderConfirm()},onConfirmNo:function(t){t.preventDefault(),this.render(),this.parent.$(".vf-comment-html").removeClass("vf-remove-confirm"),this.delegateEvents()},onConfirmYes:function(t){t.preventDefault(),this.$(".vf-no").loader("show",{position:"right"}),this.comment.destroy({success:this.onRemoveSuccess,error:this.onRemoveError})},onRemoveError:function(t,e){var i=e.error||this.i18n("something_went_wrong");this.$(".vf-error-message").remove(),this.$el.append("<div class='vf-error-message'>"+i+"</div>"),this.parent.$(".vf-comment-html").removeClass("vf-remove-confirm"),this.$(".vf-no").loader("hide")},onRemoveSuccess:function(t,e){this.$(".vf-no").loader("hide"),this.parent.$(".vf-comment-html").removeClass("vf-remove-confirm"),this.comment.set("processing_status",e.result.processing_status),this.trigger("remove")},onCountFinish:function(){this.locked=!0,this.trigger("lock")},remove:function(){i.prototype.remove.call(this),delete this.parent,this.countdown.stop()}});return s}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(15),i(46)],s=function(t,e,i){return{isSelf:function(t,i){try{if(i.isGuest()&&"1"===t.user_anonymous)return!0;if("awaiting_moderation"===t.status&&!i.isModOrAdmin())return!0;var n;switch(t.event_type){case"comment.liked":case"comment.unliked":case"comment.disliked":case"comment.undisliked":n="actor_uuid";break;default:n="user_uuid"}return!(!i||!t||e.toUuid(i.id)!==t[n])}catch(s){return!1}},initRealtime:function(){this.subscriptions=[],this.listenTo(i,"content",this.filterRealtimeUpdate),this.subscribeRealtime()},subscribeRealtime:function(){t.forEach(t.result(this,"realtimeFilters"),function(t){this.subscriptions.push(i.subscribe(t))}.bind(this))},unsubscribeRealtime:function(){t.forEach(this.subscriptions,function(t){this.subscriptions.push(i.unsubscribe(t))}.bind(this))},filterRealtimeUpdate:function(e){e&&e.filter_id&&t.contains(this.subscriptions,e.filter_id)&&this.realtimeUpdate(e)}}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(52),i(23),i(22),i(4),i(9),i(12)],s=function(t,e,i,n,s,r){return t.extend({templateName:"recorder",initialize:function(t){var e=this.prepareRecorder(this.model.id);this.target=t.target,this.settings={swf_url:r.asset_url+"swf/recorder9.swf",domain:n.locations.domain,connection:n.locations.wowza_connection,uploadComplete:e.complete_string,recordButtonClick:e.record_string,stopRecordButtonClick:e.stop_string,previewButtonClick:e.preview_string,saveButtonClick:e.save_string,redoButtonClick:e.redo_string,recorderFailure:e.failure_string}},render:function(){return this.$el.html(this.template(this.settings)),this.delegateEvents(),this},prepareRecorder:function(t){function e(){delete window["record"+t],delete window["stop"+t],delete window["complete"+t],delete window["preview"+t],delete window["save"+t],delete window["redo"+t]}function i(){d=!1,h=!0,s.trigger("/recorder/start/click")}function n(){d=!1,h=!0,s.trigger("/recorder/stop/click")}function r(t){d=!0,h=!0,s.trigger("/recorder/save",t)}function o(t){s.trigger("/recorder/failed/click",t)}function a(){s.trigger("/recorder/preview/click")}function l(){s.trigger("/recorder/save/click")}function u(){d=!1,h=!1,s.trigger("/recorder/redo/click")}function c(){return h?d?i18n("upload_status_complete"):i18n("upload_status_uploading"):i18n("upload_status_idle")}var h=!1,d=!1;return window["record"+t]=i,window["stop"+t]=n,window["complete"+t]=r.bind(this),window["preview"+t]=a,window["save"+t]=l,window["redo"+t]=u,window["failure"+t]=o,{complete_string:"complete"+t,record_string:"record"+t,stop_string:"stop"+t,preview_string:"preview"+t,save_string:"save"+t,redo_string:"redo"+t,failure_string:"failure"+t,clear:e,getStatus:c}}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(52)],s=function(t){return t.extend({templateName:"preview",render:function(){var t=this.model.toJSON();return t.imageURL=this.model.largestImage().url,this.$el.html(this.template(t)),this.delegateEvents(),this}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(93),i(105),i(128),i(130)],s=function(){}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(4),i(94),i(15),i(38)],s=function(t,e,n,s){t.register({name:"comments",create:function(i){if(t.current.settings.get("enable_commenting")){var n=new e({el:i,section:t.locations.section});return n}},loadDeps:function(t){i.e(1,function(e){var i=[e(39)];(function(e){s.loadTemplates(e),t.call()}).apply(null,i)})}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(6),i(9),i(46),i(15),i(11),i(52),i(73),i(98),i(70),i(95),i(99),i(101),i(102),i(100),i(103),i(28),i(104),i(89)],s=function(t,e,i,n,s,r,o,a,l,u,c,h,d,f,p,m,g,v,y){var b=o.extend({templateName:"commenting",mixins:[y],events:{"click .vf-load-more":"loadMoreComments","click .vf-show-all":"loadAllComments"},initialize:function(t){e.bindAll(this,"onCommentsError","onCommentsSuccess","loadMoreComments","loadMoreSuccess","loadMoreError","canView","onWindowChange","loadNewComments","isLoadedThread","updateRealtimeCount","realtimeToggle");var i={},n=this.$el.attr("data-path"),s=this.$el.attr("data-title"),r=this.$el.attr("data-unique_id");if(this.realtimeIDs=[],this.numCommentsMade=0,this.isShare=!1,n){var o=this.$el.attr("data-section");o&&(i.section=o),n=this.parsePath(n),i.title=s||this.locations.domain+n,r&&(i.unique_id=r),i.path=n,t.page=new g,t.page.getPage(i),t.page.on("change:id",function(){this.todoInitialize(t)}.bind(this))}else this.todoInitialize(t)},onIsOnScreen:function(){this.hasRealtime()&&(this.rtToggledOn=!0,this.listenTo(v,"rt-comment-throttler",this.handleThrottleEvent),v.subscribe({namespace:"rt-comment-throttler",interval:3e5}),this.realtimeToggle(this.rtToggledOn,!1)),this.runShareLoader()},onWindowChange:function(){var e=s.isElementPartiallyInViewport(this.$el),n=m.parseHash();(e||n)&&(t(window).off(this.realtimeUID),this.onIsOnScreen(),this.stopListening(this,"windowChange"),e&&!n&&i.trigger("/commenting/page/load-thread",this.page))},runShareLoader:function(){m.fetchShare({page:this.page}).done(this.showSharedComment.bind(this)).fail(this.showPageComments.bind(this))},todoInitialize:function(e){this.user=this.currentUser,this.page=e.page||this.currentPage,this.section=e.section,this.settings=this.domainSettings,this.sort=this.$el.attr("data-sort")||this.settings.get("commenting_sort"),this.listenTo(this,"windowChange",this.onWindowChange),this.realtimeUID=".vf-rt-commenting-"+this.$el.data("widget-id"),t(window).off(this.realtimeUID),t(window).on("DOMContentLoaded"+this.realtimeUID+" load"+this.realtimeUID+" resize"+this.realtimeUID+" scroll"+this.realtimeUID,this.onWindowChange),this.pageSettings=new l({page:this.page}),this.collection=this.threads=this.page.threads(),this.collection.settings.limit=this.$el.attr("data-limit")||10,this.collection.sortBy(this.sort)||(r.warn("data-sort value is invalid ("+this.sort+")"),this.sort=this.collection.defaultSort);var s=this.hasRealtime();this.views={login_dashboard:new a({user:this.user,settings:this.settings,hasRealtime:s}),page_count:new f({model:this.page,hasRealtime:s}),comments_options:new c({model:this.page,settings:this.settings,isShare:this.isShare,hasRealtime:s}),comments:new p({view:h,collection:this.collection,canView:this.canView,hasRealtime:s})},this.views.comment_box=new u({section:this.section,page:this.page,user:this.user,settings:this.settings,loginDashboard:this.views.login_dashboard,hasRealtime:s}),this.domainSettings.get("enable_anonymous_comments")&&this.$el.addClass("vf-enable-anonymous"),this.listenTo(this.page,"change:status",this.onStatusChange),this.listenTo(i,"comment:created",this.addComment),this.listenTo(this.user,"change:id",this.userChanged),this.listenTo(this.views.comments_options,"change:sort",this.changeCommentSort),this.listenTo(this.views.comments_options,"fetch",this.loadNewComments),this.listenTo(this.views.comments_options,"visible",this.isLoadedThread),this.listenTo(this.views.comments_options,"new_rt_comment",this.addRealtimeID),this.listenTo(this.views.comments_options,"realtime-toggle",this.realtimeToggle),this.render(),this.checkScrollDown(),this.listenTo(this.views.comments,"render add",this.toggleLoadingButtons),this.listenTo(this.views.comments,"render add",this.toggleNoCommentsMessage),this.listenTo(n,"content",this.realtimeUpdate),t(window).on("hashchange",this.onHashChange.bind(this))},hasRealtime:function(){var t;return this.page&&(t=this.page.get("status"),"closed"===t||"hidden"===t)?!1:!!this.settings.get("enable_realtime")},canView:function(t,e){return this.user.canAnonymouslyPost()&&t.has("user")&&t.get("user").name===this.user.get("name")?!0:t.has("user")&&t.get("user").id===this.user.id||this.user.isModOrAdmin()||"completed"===t.get("processing_status")||"removed"===t.get("processing_status")},isLoadedThread:function(t,e){var i=this.collection.isLoadedThread(t);return e?void e(i):i},showPageComments:function(){t.fn.loader.hideErrors(),this.views.comments.$el.loader("show",{loaderSize:"large",block:!0,inside:!0}).addClass("vf-comment-sorting-loader"),this.collection=this.threads,this.views.comments.setCollection(this.collection),this.collection.fetchBeginning({success:function(){this.views.comments_options.realtimeReset(),this.onCommentsSuccess()}.bind(this),error:this.onCommentsError})},loadNewComments:function(e){e="newest";var n=this.collection,s=this;t.fn.loader.hideErrors(),this.views.comments.$el.loader("show",{loaderSize:"large",block:!0}).addClass("vf-comment-sorting-loader"),i.trigger("threads:cleanRealtimeNew"),n.multiFetch({realtimeNewComment:!0}).add(this.realtimeIDs).add("fetchPageBefore",{reverse:!0}).success(function(t,e){t=t.sort(s.sortRealtimeResponses);for(var i=0,r=0;r<t.length;r++)i+=s.processModels(t[r],n);i>0&&n.trigger("sync"),s.updateRealtimeCount(i)}).error(this.onCommentsError)},processModels:function(t,e){var n=t.get("thread_id"),s=t.get("id"),r=0;if(n===s)e.isLoadedThread(s)||(r+=1,t.thread&&(r+=t.thread.length),e.add(t,{at:0}));else if(e.isLoadedThread(n)){var o=e.get(n).thread;o&&o.contains(t)||(r+=1,i.trigger("comment:created",t))}return r},sortRealtimeResponses:function(t,e){if(t.get("id")!==t.get("thread_id")){if(e.get("id")===e.get("thread_id"))return 1}else if(e.get("id")!==e.get("thread_id"))return-1;return t.get("date_created")===e.get("date_created")?0:t.get("date_created")>e.get("date_created")?1:-1},showSharedComment:function(e){var i=m.parseHash();this.isShare=!0,this.views.comments_options.isShare=this.isShare,this.views.comments_options.realtimeReset(),this.collection=e,this.views.comments.setCollection(this.collection),this.views.comments.render(),t(window).scrollTop(this.$el.position().top);var n=this.views.comments.views[0],s=n.findComment(function(t){return t.model.id===i});s.$el.addClass("vf-comment-background-highlight"),setTimeout(function(){s.$el.removeClass("vf-comment-background-highlight")},5e3)},render:function(){var t=this.page.get("status"),e={commentingClosed:"closed"===t,hasCommentBox:"closed"!==t&&"hidden"!==t,hasCommentOptions:"hidden"!==t,hasComments:"hidden"!==t,hasCommentMeta:"hidden"!==t,hasLoginDashboard:"hidden"!==t&&!this.settings.get("disable_widget_logins"),hasRealtime:this.hasRealtime()};return this.$el.html(this.template(e)),this.insertSubViews(this.views),this.showPageSettings(),this.$view_all_btn=this.$(".vf-show-all-con"),this.$show_more_btn=this.$(".vf-load-more-con"),this.toggleLoadingButtons(),this.settings.get("viafoura_branding")||this.$(".vf-branding").remove(),this.trigger("windowChange"),this},clearComments:function(){this.views.comments.clear(),this.$view_all_btn.hide(),this.$show_more_btn.hide()},toggleNoCommentsMessage:function(){if(this.collection.isEmpty()){var t=this.i18n("no_comments");"editor-picks"==this.sort&&(t=this.i18n("no_comments_editors_pick")),this.views.comments.$el.html("<p class='vf-no-messages'>"+t+"</p>")}else this.views.comments.$(".vf-no-messages").remove()},toggleLoadingButtons:function(){this.$view_all_btn.toggle(this.isShare),this.$show_more_btn.toggle(!!this.collection.after_count),this.$show_more_btn.children(".vf-error-message").remove(),this.$view_all_btn.children(".vf-error-message").remove()},changeCommentSort:function(t){this.clearComments(),this.views.comments_options.realtimeReset(),this.collection.sortBy(t),this.collection.fetchBeginning({success:this.onCommentsSuccess,error:this.onCommentsError}),this.views.comments.$el.loader("show",{loaderSize:"large",block:!0,inside:!0}).addClass("vf-comment-sorting-loader"),this.sort=t},onCommentsSuccess:function(){this.$(".vf-horizontal-list").loader("hide")},onCommentsError:function(){this.$(".vf-horizontal-list").loader("hide");var t=this.i18n("something_went_wrong");this.$(".vf-horizontal-list").html("<div class='vf-error-message'>"+t+"</div>")},addComment:function(t){var e={slide:!0};return this.page.id===t.get("parent_id")&&(this.numCommentsMade+=1,e.prepend=!0,e.at=0,this.collection.add(t,e)),this},loadAllComments:function(e){e.preventDefault();var i=t(window).scrollTop();m.clearShare(),this.showPageComments(),this.isShare=!1,this.views.comments_options.isShare=!1,t(window).scrollTop(i)},closeReplyBoxes:function(){this.views.comments.each(function(t){t.closeReplies()})},loadMoreComments:function(t){t.preventDefault(),this.$show_more_btn.children(".vf-error-message").remove(),this.$show_more_btn.hide(),this.$show_more_btn.loader("show",{loaderSize:"large",block:!0
}),this.collection.fetchPageAfter({success:this.loadMoreSuccess,error:this.loadMoreError})},loadMoreSuccess:function(){this.$show_more_btn.loader("hide"),i.trigger("/commenting/page/load-more",this.page)},loadMoreError:function(){this.$show_more_btn.show().loader("hide"),this.$show_more_btn.children(".vf-error-message").remove();var t=this.i18n("something_went_wrong");this.$show_more_btn.append("<div class='vf-error-message'>"+t+"</div>")},showPageSettings:function(){this.user.isModOrAdmin()?this.$(".vf-page-settings").empty().append(this.pageSettings.render().$el):this.pageSettings.remove()},onStatusChange:function(){this.collection.before_count=0,this.render(),this.page.isClosed()&&this.closeReplyBoxes()},userChanged:function(){this.showPageSettings(),this.$el.toggleClass("vf-is-logged-in",this.user.isLoggedIn()),this.clearComments(),m.fetchShare({page:this.page}).done(this.showSharedComment.bind(this)).fail(this.showPageComments.bind(this)),this.page.fetch({batch:!0})},onHashChange:function(){m.parseHash()&&(i.trigger("/sharelink/show"),this.clearComments(),m.fetchShare({page:this.page}).done(this.showSharedComment.bind(this)).fail(this.showPageComments.bind(this)))},updateRealtimeCount:function(t){this.numCommentsMade=0,t=t>0?t:1/0,this.views.comments_options.realtimeIncrement(-t),this.onCommentsSuccess(),i.trigger("/commenting/page/rt-load-more",this.page)},realtimeIsOn:function(){return v.isActive("rt-comment-throttler")&&this.rtToggledOn},realtimeToggle:function(t,e,i){this.rtToggledOn=t,this.realtimeIsOn()?(this.page.id&&(this.views.comments_options.updateToggle("connected"),this.updateFilterID(n.subscribe({page_uuid:[s.toUuid(this.page.id)],event_type:["comment"]}))),e&&m.fetchShare({page:this.page}).done(this.showSharedComment.bind(this)).fail(this.changeCommentSort("newest")),this.isShare||i!==!0||this.getNewRTCommentCount()):(this.updateFilterID(void 0),n.unsubscribe(this.filter_id),this.views.comments_options.updateToggle("disconnected"))},updateHasRealtime:function(t){this.hasRealtime=t,e.each(this.views,function(e){e.hasRealtime=t}),this.views.comments.updateHasRealtime(t)},getNewRTCommentCount:function(){if(this.collection.before_id){var t=this.collection,i=e.clone(t.settings,!0),n=t.before_id;t.settings.limit=1,t.fetchPageBefore({add:!1,remove:!1,silent:!0,setCounts:!1,setBeforeAfterIDs:!1,success:function(t,e){var i=e.result.results.length,n=e.result.before_count-this.numCommentsMade+i;this.views.comments_options.realtimeReset(),this.views.comments_options.realtimeIncrement(n),this.onCommentsSuccess()}.bind(this)}),t.settings=i,t.before_id=n}},handleThrottleEvent:function(t){("active"===t||"inactive"===t)&&this.realtimeToggle(this.rtToggledOn,!1,!0)},updateFilterID:function(t){this.filter_id=t,e.each(this.views,function(e){e.filter_id=t}),this.views.comments.updateFilterID(t)},checkScrollDown:function(){if(window.location.hash.match(/^#vf-commenting-widget$/)){var e=t(".vf-widget.vf-comments").first();if(e.length>0){var i=e.offset();t(window).scrollTop(i.top)}}},realtimeUpdate:function(t){if(!this.isShare&&this.filter_id&&t.filter_id&&t.filter_id===this.filter_id&&"comment.enable"===t.event_type){var e=s.toVfId(t.comment_uuid);this.isSelf(t,this.currentUser)||t.comment_uuid!==t.thread_uuid||this.realtimeIDs.push(e)}}});return b}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(2),i(96),i(52),i(94),i(89),i(97),i(4),i(15),i(46)],s=function(t,e,i,n,s,r,o,a,l,u){var c=n.extend({templateName:"comments_options",mixins:[r,o],new_comments:0,new_comments_counter_limit:10,waypoint:null,events:{"change .vf-comments-sort":"changeSortOption","click .vf-subscribe":"follow","click .vf-comments-realtime":"loadNewest","click .vf-rt-toggle":"realtimeToggle","touchstart .vf-rt-main-static":"touchstartStatic","touchend .vf-rt-main-static":"touchendStatic","touchstart .vf-rt-main-sticky":"touchstartSticky","touchend .vf-rt-main-sticky":"touchendSticky"},initialize:function(e){this.isShare=!1,t.bindAll(this,"onError","onSuccess","waypointHandler"),this.settings=e.settings,e.hasRealtime&&(this.listenTo(u,"content",this.realtimeUpdate),this.listenTo(u,"status",this.updateToggle)),this.viewVars={hasRealtime:e.hasRealtime}},render:function(){this.templateOnly(t.defaults(this.viewVars,this.model.toJSON())),this.$sort=this.$(".vf-comments-sort"),this.$toggle=this.$(".vf-rt-toggle");var e=this.settings.get("commenting_sort");return this.$sort.val(e),this.settings.get("disable_email_notifications")&&this.$(".vf-subscribe").hide(),this.settings.get("enable_comment_sorting",!0)||this.$(".vf-comments-sort-block").hide(),this.listenTo(this.model,"change:subscribed",this.followChanged),l.isMobile()&&this.initializeTouchEvents(),this},changeSortOption:function(t){var e=this.currentSortOption();"string"==typeof t&&t!==e&&(this.$sort.val(t),e=t),this.trigger("change:sort",e)},currentSortOption:function(){return this.$sort.val()},follow:function(t){t.preventDefault(),this.authorize("follow",this.model)&&(e.fn.loader.hideErrors(),this.model.toggleFollow({success:this.onSuccess,error:this.onError}),this.$(".vf-subscribe").loader("show",{position:"right"}))},onSuccess:function(){this.$(".vf-subscribe").loader("hide")},onError:function(){this.$(".vf-subscribe").loader("error",{position:"right"}).tipsy({title:"something_went_wrong",interactive:!0})},followChanged:function(t,e){e?this.$(".vf-subscribe").text(this.i18n("unsubscribe_btn")).attr("data-title","unsubscribe-page"):this.$(".vf-subscribe").text(this.i18n("subscribe_btn")).attr("data-title","subscribe-page")},realtimeUpdate:function(t){t&&this.filter_id&&this.filter_id===t.filter_id&&!this.isShare&&"comment.enable"===t.event_type&&t.thread_uuid&&(this.isSelf(t,a.current.user)||this.trigger("visible",l.toVfId(t.thread_uuid),function(t){t||this.realtimeIncrement(1)}.bind(this)))},initSticky:function(){if(this.new_comments<1)return this.waypointHandler("up"),i.destroyAll(),void(this.waypoint&&(this.waypoint.destroy(),this.waypoint=null));if(!this.waypoint){var n=this.$(".vf-rt-main-sticky"),s=this.$(".vf-rt-main-static"),r=s.width(),o=s.offset().left;r&&n.width(r),o&&n.offset({left:o}),e(window).resize(t.debounce(function(){r=s.width(),o=s.offset().left,r&&n.width(r),o&&n.offset({left:o})},150).bind(this)),this.waypoint=new i({element:this.$(".vf-rt-main-static")[0],offset:-30,enabled:!0,handler:this.waypointHandler})}},initializeTouchEvents:function(){var t=this.$(".vf-rt-main-static .vf-rt-hover-state"),e=this.$(".vf-rt-main-sticky .vf-rt-hover-state");this.rt_static={$el:t,heightDefault:t.height(),heightOnHover:this.$(".vf-rt-main-static").height(),transition:t.css("transition")},this.rt_sticky={$el:e,heightDefault:e.height(),heightOnHover:this.$(".vf-rt-main-sticky").height(),transition:e.css("transition")}},touchstartStatic:function(t){o.renderHoverStyles(t,this.rt_static.$el,this.rt_static.heightOnHover,this.rt_static.transition)},touchendStatic:function(t){o.removeHoverStyles(t,this.rt_static.$el,this.rt_static.heightDefault,this.rt_static.transition),this.loadNewest(t)},touchstartSticky:function(t){o.renderHoverStyles(t,this.rt_sticky.$el,this.rt_sticky.heightOnHover,this.rt_sticky.transition)},touchendSticky:function(t){o.removeHoverStyles(t,this.rt_sticky.$el,this.rt_sticky.heightDefault,this.rt_sticky.sticky_transition),this.loadNewest(t)},waypointHandler:function(t){var e=this.$(".vf-rt-main-sticky");"down"===t?e.addClass("stuck vf-rt-sliding").one("transitionend webkitTransitionEnd",function(){e.removeClass("vf-rt-sliding")}):"up"===t&&e.removeClass("stuck vf-rt-sliding")},loadNewest:function(t){t.preventDefault(),l.isElementPartiallyInViewport(this.$el)||e(window).scrollTop(this.$el.offset().top);var i=this.currentSortOption();"newest"!==i?this.changeSortOption("newest"):this.trigger("fetch")},realtimeIncrement:function(t){this.new_comments+=t,this.new_comments<0&&(this.new_comments=0),this.initSticky(),this.renderCounter()},realtimeReset:function(){this.new_comments=0,this.initSticky(),this.renderCounter()},renderCounter:function(){this.new_comments&&(this.$(".vf-rt-label").html(this.i18n("newest"===this.currentSortOption()?"realtime_new_comments":"realtime_new_comments_switch",this.new_comments,this.new_comments_counter_limit)),this.$(".vf-rt-bubble-text").html(this.new_comments<=this.new_comments_counter_limit?this.new_comments:this.new_comments_counter_limit+"+")),this.$(".vf-rt-bubble-text").toggleClass("vf-rt-over-limit",this.new_comments>this.new_comments_counter_limit),this.$(".vf-rt-main-static").toggleClass("invisible",0===this.new_comments)},updateToggle:function(t){if("unsupported"===t)return void this.$toggle.hide();this.$toggle.toggleClass("active vf-rt-accent-color-background","connected"===t).toggleClass("connecting","connecting"===t).find(".vf-rt-toggle-dot").toggleClass("vf-rt-main-color-background","connected"===t);var e="connecting"===t?"realtime_connecting":"realtime_on";this.$toggle.find("span").html(this.i18n(e)),this.$toggle.tipsy("hide"),this.$toggle.attr("data-title","connected"===t?"realtime-toggle-on":"realtime-toggle-off")},realtimeToggle:function(){var t=!this.$toggle.hasClass("active");this.trigger("realtime-toggle",t,!0)},updateHasRealtime:function(e){this.hasRealtime=e,t.each(this.views,function(t){t.hasRealtime=e})}});return c}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2)],s=function(t){var e={$:t};return function(){"use strict";function t(e){if(!e)throw new Error("No options passed to Waypoint constructor");if(!e.element)throw new Error("No element option passed to Waypoint constructor");if(!e.handler)throw new Error("No handler option passed to Waypoint constructor");this.key="waypoint-"+i,this.options=t.Adapter.extend({},t.defaults,e),this.element=this.options.element,this.adapter=new t.Adapter(this.element),this.callback=e.handler,this.axis=this.options.horizontal?"horizontal":"vertical",this.enabled=this.options.enabled,this.triggerPoint=null,this.group=t.Group.findOrCreate({name:this.options.group,axis:this.axis}),this.context=t.Context.findOrCreateByElement(this.options.context),t.offsetAliases[this.options.offset]&&(this.options.offset=t.offsetAliases[this.options.offset]),this.group.add(this),this.context.add(this),n[this.key]=this,i+=1}var i=0,n={};t.prototype.queueTrigger=function(t){this.group.queueTrigger(this,t)},t.prototype.trigger=function(t){this.enabled&&this.callback&&this.callback.apply(this,t)},t.prototype.destroy=function(){this.context.remove(this),this.group.remove(this),delete n[this.key]},t.prototype.disable=function(){return this.enabled=!1,this},t.prototype.enable=function(){return this.context.refresh(),this.enabled=!0,this},t.prototype.next=function(){return this.group.next(this)},t.prototype.previous=function(){return this.group.previous(this)},t.destroyAll=function(){var t=[];for(var e in n)t.push(n[e]);for(var i=0,s=t.length;s>i;i++)t[i].destroy()},t.refreshAll=function(){t.Context.refreshAll()},t.viewportHeight=function(){return window.innerHeight||document.documentElement.clientHeight},t.viewportWidth=function(){return document.documentElement.clientWidth},t.adapters=[],t.defaults={context:window,continuous:!0,enabled:!0,group:"default",horizontal:!1,offset:0},t.offsetAliases={"bottom-in-view":function(){return this.context.innerHeight()-this.adapter.outerHeight()},"right-in-view":function(){return this.context.innerWidth()-this.adapter.outerWidth()}},e.Waypoint=t}(),function(){"use strict";function t(t){setTimeout(t,1e3/60)}function i(t){this.element=t,this.Adapter=r.Adapter,this.adapter=new this.Adapter(t),this.key="waypoint-context-"+n,this.didScroll=!1,this.didResize=!1,this.oldScroll={x:this.adapter.scrollLeft(),y:this.adapter.scrollTop()},this.waypoints={vertical:{},horizontal:{}},t.waypointContextKey=this.key,s[t.waypointContextKey]=this,n+=1,this.createThrottledScrollHandler(),this.createThrottledResizeHandler()}var n=0,s={},r=e.Waypoint,o=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||t,a=window.onload;i.prototype.add=function(t){var e=t.options.horizontal?"horizontal":"vertical";this.waypoints[e][t.key]=t,this.refresh()},i.prototype.checkEmpty=function(){var t=this.Adapter.isEmptyObject(this.waypoints.horizontal),e=this.Adapter.isEmptyObject(this.waypoints.vertical);t&&e&&(this.adapter.off(".waypoints"),delete s[this.key])},i.prototype.createThrottledResizeHandler=function(){function t(){e.handleResize(),e.didResize=!1}var e=this;this.adapter.on("resize.waypoints",function(){e.didResize||(e.didResize=!0,o(t))})},i.prototype.createThrottledScrollHandler=function(){function t(){e.handleScroll(),e.didScroll=!1}var e=this;this.adapter.on("scroll.waypoints",function(){(!e.didScroll||r.isTouch)&&(e.didScroll=!0,o(t))})},i.prototype.handleResize=function(){r.Context.refreshAll()},i.prototype.handleScroll=function(){var t={},e={horizontal:{newScroll:this.adapter.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.adapter.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}};for(var i in e){var n=e[i],s=n.newScroll>n.oldScroll,r=s?n.forward:n.backward;for(var o in this.waypoints[i]){var a=this.waypoints[i][o],l=n.oldScroll<a.triggerPoint,u=n.newScroll>=a.triggerPoint,c=l&&u,h=!l&&!u;(c||h)&&(a.queueTrigger(r),t[a.group.id]=a.group)}}for(var d in t)t[d].flushTriggers();this.oldScroll={x:e.horizontal.newScroll,y:e.vertical.newScroll}},i.prototype.innerHeight=function(){return this.element===this.element.window?r.viewportHeight():this.adapter.innerHeight()},i.prototype.remove=function(t){delete this.waypoints[t.axis][t.key],this.checkEmpty()},i.prototype.innerWidth=function(){return this.element===this.element.window?r.viewportWidth():this.adapter.innerWidth()},i.prototype.destroy=function(){var t=[];for(var e in this.waypoints)for(var i in this.waypoints[e])t.push(this.waypoints[e][i]);for(var n=0,s=t.length;s>n;n++)t[n].destroy()},i.prototype.refresh=function(){var t,e=this.element===this.element.window,i=this.adapter.offset(),n={};this.handleScroll(),t={horizontal:{contextOffset:e?0:i.left,contextScroll:e?0:this.oldScroll.x,contextDimension:this.innerWidth(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:e?0:i.top,contextScroll:e?0:this.oldScroll.y,contextDimension:this.innerHeight(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}};for(var s in t){var r=t[s];for(var o in this.waypoints[s]){var a,l,u,c,h,d=this.waypoints[s][o],f=d.options.offset,p=d.triggerPoint,m=0,g=null==p;d.element!==d.element.window&&(m=d.adapter.offset()[r.offsetProp]),"function"==typeof f?f=f.apply(d):"string"==typeof f&&(f=parseFloat(f),d.options.offset.indexOf("%")>-1&&(f=Math.ceil(r.contextDimension*f/100))),a=r.contextScroll-r.contextOffset,d.triggerPoint=m+a-f,l=p<r.oldScroll,u=d.triggerPoint>=r.oldScroll,c=l&&u,h=!l&&!u,!g&&c?(d.queueTrigger(r.backward),n[d.group.id]=d.group):!g&&h?(d.queueTrigger(r.forward),n[d.group.id]=d.group):g&&r.oldScroll>=d.triggerPoint&&(d.queueTrigger(r.forward),n[d.group.id]=d.group)}}for(var v in n)n[v].flushTriggers();return this},i.findOrCreateByElement=function(t){return i.findByElement(t)||new i(t)},i.refreshAll=function(){for(var t in s)s[t].refresh()},i.findByElement=function(t){return s[t.waypointContextKey]},window.onload=function(){a&&a(),i.refreshAll()},r.Context=i}(),function(){"use strict";function t(t,e){return t.triggerPoint-e.triggerPoint}function i(t,e){return e.triggerPoint-t.triggerPoint}function n(t){this.name=t.name,this.axis=t.axis,this.id=this.name+"-"+this.axis,this.waypoints=[],this.clearTriggerQueues(),s[this.axis][this.name]=this}var s={vertical:{},horizontal:{}},r=e.Waypoint;n.prototype.add=function(t){this.waypoints.push(t)},n.prototype.clearTriggerQueues=function(){this.triggerQueues={up:[],down:[],left:[],right:[]}},n.prototype.flushTriggers=function(){for(var e in this.triggerQueues){var n=this.triggerQueues[e],s="up"===e||"left"===e;n.sort(s?i:t);for(var r=0,o=n.length;o>r;r+=1){var a=n[r];(a.options.continuous||r===n.length-1)&&a.trigger([e])}}this.clearTriggerQueues()},n.prototype.next=function(e){this.waypoints.sort(t);var i=r.Adapter.inArray(e,this.waypoints),n=i===this.waypoints.length-1;return n?null:this.waypoints[i+1]},n.prototype.previous=function(e){this.waypoints.sort(t);var i=r.Adapter.inArray(e,this.waypoints);return i?this.waypoints[i-1]:null},n.prototype.queueTrigger=function(t,e){this.triggerQueues[e].push(t)},n.prototype.remove=function(t){var e=r.Adapter.inArray(t,this.waypoints);e>-1&&this.waypoints.splice(e,1)},n.prototype.first=function(){return this.waypoints[0]},n.prototype.last=function(){return this.waypoints[this.waypoints.length-1]},n.findOrCreate=function(t){return s[t.axis][t.name]||new n(t)},r.Group=n}(),function(){"use strict";function i(e){this.$element=t(e)}var n=e.Waypoint;t.each(["innerHeight","innerWidth","off","offset","on","outerHeight","outerWidth","scrollLeft","scrollTop"],function(t,e){i.prototype[e]=function(){var t=Array.prototype.slice.call(arguments);return this.$element[e].apply(this.$element,t)}}),t.each(["extend","inArray","isEmptyObject"],function(e,n){i[n]=t[n]}),n.adapters.push({name:"jquery",Adapter:i}),n.Adapter=i}(),function(){"use strict";function t(t){return function(){var e=[],n=arguments[0];return t.isFunction(arguments[0])&&(n=t.extend({},arguments[1]),n.handler=arguments[0]),this.each(function(){var s=t.extend({},n,{element:this});"string"==typeof s.context&&(s.context=t(this).closest(s.context)[0]),e.push(new i(s))}),e}}var i=e.Waypoint;e.$&&(e.$.fn.waypoint=t(e.$))}(),e.Waypoint}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(15)],s=function(t,e){var i={renderHoverStyles:function(t,e,i,n){t.preventDefault(),e.css({"-webkit-transition":n,"-moz-transition":n,"-ms-transition":n,"-o-transition":n,transition:n,height:i,top:0})},removeHoverStyles:function(t,e,i,n){t.preventDefault(),e.css({"-webkit-transition":n,"-moz-transition":n,"-ms-transition":n,"-o-transition":n,transition:n,height:i,top:"100%"})}};return i}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(6),i(9),i(52)],s=function(t,e,i,n){var s=n.extend({templateName:"page_settings",events:{"change .vf-thread-option":"changePageSettings","change .vf-smartmod-option":"changePageSMSettings","change .vf-premod-option":"changePageSMSettings"},initialize:function(t){e.bindAll(this,"changePageSettings","changePageSMSettings"),this.page=t.page,this.model=t.page},render:function(){var t=this.model.toJSON();return t.moderation_smartmod_enabled=1===this.domainSettings.get("moderation_smartmod_enabled"),this.templateOnly(t),this.initToggles(),this.togglePremod(this.pageSmartmodOn(),"enable_premod_unknown"===this.model.get("smartmod")),this.toggleSmartmod(this.pageSmartmodOn()),this},pageSmartmodOn:function(t){return t=t||this.model.get("smartmod"),"disable"!==t&&1===this.domainSettings.get("moderation_smartmod_enabled")},changePageSettings:function(e){var i=t(e.target),n=i.val();this.model.save({status:n})},getSmartmodFromButtons:function(){return this.getSmartmodSettingText(this.$el.smartmod_option.is(":checked"),this.$el.premod_option.is(":checked"))},getSmartmodSettingText:function(t,e){return t?e?"enable_premod_unknown":"enable":"disable"},changePageSMSettings:function(){var t=this.getSmartmodFromButtons();this.model.save({smartmod:t,status:this.model.get("status")}),this.toggleSmartmod("disable"!==t),this.togglePremod(this.pageSmartmodOn(t),"enable_premod_unknown"===t)},initToggles:function(){this.$el.page_setting_tooltip=this.$el.find(".vf-page-settings-tooltip"),this.$el.smartmod_toggle=this.$el.find(".vf-smartmod-toggle"),this.$el.smartmod_option=this.$el.find(".vf-smartmod-option"),this.$el.premod_setting=this.$el.find(".vf-premod-setting"),this.$el.premod_option=this.$el.find(".vf-premod-option")},toggleSmartmod:function(t){var e;this.$el.find(".vf-thread-option").prop("disabled",t),t?(e="enable",this.$el.page_setting_tooltip.show()):(e="disable",this.$el.page_setting_tooltip.hide().tipsy("remove")),this.$el.smartmod_toggle.attr("data-title","smartmod-toggle-"+e),this.$el.smartmod_toggle.find(".vf-switch").text(this.i18n("toggle_"+e)),this.$el.smartmod_toggle.tipsy("hide")},togglePremod:function(t,e){this.$el.premod_setting.toggle(t);var i=e?"toggle_enable":"toggle_disable";this.$el.premod_setting.find(".vf-switch").text(this.i18n(i)),e||this.$el.premod_option.attr("checked",!1)}});return s}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(6),i(8),i(9),i(52),i(94),i(68),i(100),i(89),i(97),i(29),i(15),i(4),i(46)],s=function(t,e,i,n,s,r,o,a,l,u,c,h,d,f){var p=s.extend({templateName:"comment_thread",mixins:[l,u],events:{"click .vf-replies-button":"loadReplies","click .vf-rt-reply":"loadRealtimeReplies","touchstart .vf-rt-reply":"touchstartReply","touchend .vf-rt-reply":"touchendReply"},initialize:function(t){e.bindAll(this,"afterLoad","rtAfterLoad","realtimeRenderNotification","updateLoadReplies"),this.new_replies=0,this.new_replies_counter_limit=10,this.views=[];var i=[];this.model.has("thread")&&(i=this.model.getThreadsAsc()),this.collection=this.model.replies(),this.collection.add(i),this.collection.before_id=e.result(e.last(i),"id"),this.collection.after_id=e.result(e.first(i),"id"),this.subviews={root_comment:new o({model:this.model,hasRealtime:t.hasRealtime}),replies:new a({collection:this.collection,view:o,canView:t.canView,hasRealtime:t.hasRealtime})},t.hasRealtime&&this.listenTo(f,"content",this.realtimeUpdate)},findComment:function(t){return t(this)?this:this.findReply(t)},findReply:function(t){return e.find(this.subviews.replies.views,t)},render:function(){if(this.templateOnly(this.model.toJSON()),this.subviews.replies.render(),this.$load_replies=this.$(".vf-replies-button"),(!this.model.thread||this.model.thread.after_count<1)&&this.$load_replies.parent().addClass("hidden"),this.$rtReplyNote=this.$el.find(".vf-rt-reply"),this.$rtReplyNoteText=this.$el.find(".vf-rt-label"),this.$rtReplyNoteCount=this.$el.find(".vf-rt-bubble-text"),this.listenTo(n,"comment:created",this.addReplies),h.isMobile()){var t=this.$el.find(".vf-rt-reply .vf-rt-hover-state");this.rt_reply={$el:t,heightDefault:t.height()}}return this},addReplies:function(t){return this.model.get("thread_id")===t.get("thread_id")&&this.subviews.replies.collection.add(t,{slide:!0}),this},realtimeUpdate:function(t){if(t&&this.filter_id&&this.filter_id===t.filter_id&&t&&t.thread_uuid&&t.thread_uuid===h.toUuid(this.model.get("thread_id")))switch(t.event_type){case"comment.enable":this.isSelf(t,d.current.user)||this.realtimeIncrement();break;default:return}},realtimeReset:function(){this.new_replies=0,this.realtimeRenderNotification()},realtimeIncrement:function(){this.$rtReplyNote.removeClass("invisible"),this.new_replies=this.new_replies+1,this.realtimeRenderNotification()},realtimeRenderNotification:function(){this.$rtReplyNote.toggleClass("invisible",0===this.new_replies),this.$rtReplyNote.addClass("vf-rt-sliding").one("transitionend webkitTransitionEnd",function(){this.$rtReplyNote.removeClass("vf-rt-sliding")}.bind(this)),this.$rtReplyNoteText.html(this.i18n("comment_has_realtime_replies",this.new_replies,this.new_replies_counter_limit)),this.$rtReplyNoteCount.toggleClass("vf-rt-over-limit",this.new_replies>this.new_replies_counter_limit).html(this.new_replies<=this.new_replies_counter_limit?this.new_replies:this.new_replies_counter_limit+"+"),this.rt_reply&&(this.rt_reply.heightOnHover=this.$rtReplyNote.height(),this.rt_reply.transition=this.$rtReplyNote.find(".vf-rt-hover-state").css("transition"))},updateLoadReplies:function(){this.collection&&this.collection.after_count&&this.collection.after_count>0?this.$load_replies.html(this.i18n("comment_has_replies",this.collection.after_count)).parent().removeClass("hidden"):this.$load_replies.parent().addClass("hidden")},loadRealtimeReplies:function(t){t.preventDefault();var e=this.collection.length>0?this.rtAfterLoad:this.afterLoad;n.trigger("threads:cleanRealtimeNew",this.model.get("thread_id"));var i=this.collection.settings&&this.collection.settings.limit?this.collection.settings.limit:10;this.collection.settings.limit=50,this.collection.fetchPageBefore({slide:!0,realtimeNewComment:!0,success:function(){n.trigger("/commenting/comment/rt-load-replies",this.model.page,this.model),e()}.bind(this)}),this.collection.settings.limit=i},loadReplies:function(t){t.preventDefault(),this.collection&&(this.collection.settings.limit=this.collection.length<=2?10-this.collection.length:10,this.collection.fetchPageAfter({prepend:!0,slide:!0,success:function(){n.trigger("/commenting/comment/load-replies",this.model.page,this.model),this.updateLoadReplies()}.bind(this)}))},afterLoad:function(){this.updateLoadReplies(),this.rtAfterLoad()},rtAfterLoad:function(){this.new_replies=this.collection.before_count,this.realtimeRenderNotification()},closeReplies:function(){this.subviews.root_comment.closeReplyBox(),this.subviews.replies.each(function(t){t.closeReplyBox()})},remove:function(){this.subviews.root_comment&&(this.subviews.root_comment.remove(),this.subviews.root_comment=null),s.prototype.remove.call(this)},touchstartReply:function(t){u.renderHoverStyles(t,this.rt_reply.$el,this.rt_reply.heightOnHover,this.rt_reply.transition)},touchendReply:function(t){u.removeHoverStyles(t,this.rt_reply.$el,this.rt_reply.heightDefault,this.rt_reply.reply_transition),this.loadRealtimeReplies(t)},updateFilterID:function(t){this.filter_id=t,e.each(this.views,function(e){e.filter_id=t}),this.subviews.root_comment.filter_id=t,this.subviews.replies.updateFilterID(t)}});return p}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(6),i(8),i(52)],s=function(t,e,i,n){var s=n.extend({templateName:"horizontal_list",initialize:function(t){this.views=[],this.view=t.view,this.canView=t.canView},render:function(){return this.templateOnly(),e.each(this.views,function(t){t.remove()}),this.views=[],this.collection&&this.setCollection(this.collection),this.collection.each(function(t,e,i){if(!this.canView||this.canView(t)){var n=new this.view({model:t,canView:this.canView,hasRealtime:this.options.hasRealtime});this.$el.append(n.render().$el),this.views.push(n)}}.bind(this)),this.updateFilterID(this.filter_id),this.trigger("render"),this},updateFilterID:function(t){this.filter_id=t,e.each(this.views,function(i){i.filter_id=t,e.isFunction(i.updateFilterID)&&i.updateFilterID(t)})},setCollection:function(t){this.collection&&this.stopListening(this.collection),this.collection=t,this.listenTo(this.collection,"reset",this.render),this.listenTo(this.collection,"add",this.onAddItem)},onAddItem:function(t,i,n){if(!this.canView||this.canView(t)){var s=n.at,r=new this.view({model:t,canView:this.canView,hasRealtime:this.options.hasRealtime}).render();r.filter_id=this.filter_id,e.isFunction(r.updateFilterID)&&r.updateFilterID(this.filter_id),n.prepend?this.$el.prepend(r.$el):0===s&&this.views.length>0?this.views[s].$el.before(r.$el):this.$el.append(r.el),this.views.splice(s,0,r),n.slide&&r.$el.hide().slideDown(),this.trigger("add")}},each:function(t,i){e.each(this.views,t,i)},clear:function(){this.each(function(t){t.remove()})}});return s}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(6),i(8),i(52),i(94),i(99)],s=function(t,e,i,n,s,r){var o=n.extend({templateName:"comments",initialize:function(t){this.views=[]},render:function(){return this.templateOnly(),this.views=[],this.collection.forEach(function(t,e,i){var n=new r({model:t});this.$el.append(n.render().$el),this.views.push(n)}.bind(this)),this},setCollection:function(t){this.collection&&this.collection.off(),this.collection=t,this.listenTo(this.collection,"reset",this.render),this.listenTo(this.collection,"add",this.onAddComment)},onAddComment:function(t,e,i){var n=i.index,s=new r({model:t});0===n?this.views[n].$el.before(s.render().$el):this.views[n-1].$el.after(s.render().$el),this.views.splice(n,0,s)}});return o}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(6),i(8),i(52),i(9),i(4),i(89),i(46)],s=function(t,e,i,n,s,r,o,a){return n.extend({templateName:"page_count",mixins:[o],initialize:function(t){this.listenTo(this.model,"change:num_replies",this.render),this.listenTo(s,"comment:created",this.incrementCount),t.hasRealtime&&this.listenTo(a,"content",this.realtimeUpdate)},render:function(){var t=this.model.toJSON();this.model.total_count&&(t.num_replies=this.model.total_count),this.templateOnly(t)},incrementCount:function(){this.model.set("num_replies",this.model.get("num_replies")+1)},realtimeUpdate:function(t){t&&this.filter_id&&this.filter_id===t.filter_id&&t.event_type&&"comment.enable"===t.event_type&&!this.isSelf(t,r.current.user)&&this.incrementCount()}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(6),i(27)],s=function(t,e,i){var n={fetchShare:function(n){n=n||{},e.defaults(n,{id:this.parseHash()});var s=t.Deferred(),r=n.id,o=n.type,a=n.page;return!r&&0!==r||r===n.avoid?(s.reject(),s.promise()):(this.model=new i({id:r,page:a}),this.model.getThread({success:function(t){if(0===t.length)return this.clearShare(),void s.reject();var e=t.models[0];a&&e.page.id!==a.id?(this.clearShare(),s.reject()):o&&e.has("type")&&e.get("type")!==o?(this.clearShare(),s.reject()):s.resolve(t)}.bind(this),error:function(){s.reject()}.bind(this)}),s.promise())},parseHash:function(){var t=window.location.hash.match(/^#vf-(\d+)/);if(t&&t.length>1){var e=parseInt(t[1],10);if("number"==typeof e)return e}return!1},setShare:function(t){var e="";t&&(e="vf-"+t),""!==e?window.location.hash=e:window.location.hash=window.location.hash.split("vf-")[0]},clearShare:function(){this.setShare()}};return n}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(6),i(9)],s=function(t,e,i){function n(){this.subscriptions={}}return e.extend(n.prototype,i,{subscribe:function(t){if(t&&t.namespace&&this.subscriptions[t.namespace]){var i=this.subscriptions[t.namespace];return i.subscribers+=1,this.trigger(i.namespace,"subscribed"),i}var i={timeoutID:null};return e.defaults(i,t,{subscribers:0,namespace:e.uniqueId("a"),interval:3e5,handlers:["focus","click","scroll","mousemove","touchstart","touchend","touchcancel","touchleave","touchmove"],status:"active"}),this.subscriptions[i.namespace]=i,this.bindHandlers(i),this.trigger(i.namespace,"subscribed"),i},unsubscribe:function(e){var i=this.subscriptions[e];i.subscribers-=1,i.subscribers<1&&(clearTimeout(i.timeoutID),t(window).off(e),this.trigger(e,"unsubscribed"),delete this.subscriptions[e])},isActive:function(t){return"active"===this.subscriptions[t].status},setActive:function(t){clearTimeout(t.timeoutID),"active"!==t.status&&(t.status="active",this.trigger(t.namespace,"active")),t.timeoutID=setTimeout(this.setInactive.bind(this,t),t.interval)},setInactive:function(t){"inactive"!==t.status&&(t.status="inactive",this.trigger(t.namespace,"inactive"))},bindHandlers:function(e){var i=e.handlers.join("."+e.namespace+" ")+"."+e.namespace;t(window).on(i,this.setActive.bind(this,e))}}),new n}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(38),i(4),i(106),i(110),i(113),i(116)],s=function(t,e,n,s,r,o){var a;e.register({name:"trending-articles",create:function(t){return new a({el:t})},loadDeps:function(e){i.e(2,function(i){var n=[i(117)];(function(){a=i(118);var n=i(127);t.loadTemplates(n),e&&e()}).apply(null,n)})}});var l;e.register({name:"trending-comments",create:function(t){return new l({el:t})},loadDeps:function(e){i.e(2,function(i){var n=[i(117)];(function(){l=i(121);var n=i(127);t.loadTemplates(n),e&&e()}).apply(null,n)})}});var u;e.register({name:"quote",create:function(t){return new u({el:t})},loadDeps:function(e){i.e(2,function(i){var n=[i(117)];(function(){u=i(125);var n=i(127);t.loadTemplates(n),e&&e()}).apply(null,n)})}});var c;e.register({
name:"users",create:function(t){return new c({el:t})},loadDeps:function(e){i.e(2,function(i){var n=[i(117)];(function(){c=i(123);var n=i(127);t.loadTemplates(n),e&&e()}).apply(null,n)})}}),e.register({name:"community-articles",create:function(t){return new n({el:t})},loadDeps:function(e){i.e(1,function(i){var n=[i(39)];(function(i){t.loadTemplates(i),e&&e()}).apply(null,n)})}}),e.register({name:"community-users",create:function(t){return new s({el:t})},loadDeps:function(e){i.e(1,function(i){var n=[i(39)];(function(i){t.loadTemplates(i),e&&e()}).apply(null,n)})}}),e.register({name:"community-comments",create:function(t){return new r({el:t,show:"recent"})},loadDeps:function(e){i.e(1,function(i){var n=[i(39)];(function(i){t.loadTemplates(i),e&&e()}).apply(null,n)})}}),e.register({name:"community-popular",create:function(t){return new r({el:t,show:"top"})},loadDeps:function(e){i.e(1,function(i){var n=[i(39)];(function(i){t.loadTemplates(i),e&&e()}).apply(null,n)})}}),e.register({name:"community-tabs",create:function(t){return new o({el:t})},loadDeps:function(e){i.e(1,function(i){var n=[i(39)];(function(i){t.loadTemplates(i),e&&e()}).apply(null,n)})}}),e.register({name:"community-tab",create:function(t){return new o({el:t})},loadDeps:function(e){i.e(1,function(i){var n=[i(39)];(function(i){t.loadTemplates(i),e&&e()}).apply(null,n)})}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(107),i(64),i(108),i(109),i(4)],s=function(t,e,i,n,s){var r=t.extend({initialize:function(t){var s=this.$el.data();this.collection=new i,this.view=new e({itemView:n,collection:this.collection,settings:s}),this.collection.settings.section=null,void 0!==s.section&&(this.collection.settings.section=s.section),this.collection.settings.days=s.days||0,this.collection.settings.limit=s.limit||5,s.navigation&&(this.navigation=s.navigation),this.listenTo(this.collection,"reset",this.render),this.collection.fetch({batch:!0,reset:!0})}});return r}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(52),i(4)],s=function(t,e,i){var n=e.extend({templateName:"community",events:{"click .vf-next-btn":"nextPage","click .vf-prev-btn":"prevPage"},initialize:function(t){var e=this.$el.data();this.view=new t.mainView({collection:t.collection(),itemView:t.itemView}),e.navigation&&(this.navigation=e.navigation)},render:function(){this.$el.html(this.template(this.$el.data())),this.$el.find(".vf-data-container").append(this.view.el),this.renderUI()},renderUI:function(){if("cycle"===this.navigation){var t=this.collection,e=this.$(".vf-prev-btn"),i=this.$(".vf-next-btn");t.before_count||t.after_count?(e.toggleClass("vf-disable",!t.before_count),i.toggleClass("vf-disable",!t.after_count)):(e.hide(),i.hide())}},nextPage:function(t){t.preventDefault();var e=this.collection,i=e.settings;i.before_id&&delete i.before_id,e.after_count>0&&(i.after_id=e.at(e.length-1).id,e.fetch({reset:!0}))},prevPage:function(t){t.preventDefault();var e=this.collection,i=e.settings;i.after_id&&delete i.after_id,e.before_count>0&&(e.settings.before_id=e.at(0).id,e.fetch({reset:!0}))}});return n}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(25),i(28),i(9)],s=function(t,e,i,n){var s=e.extend({model:i,url:"/pages",initialize:function(e,i){this.settings={show:"top",days:0,limit:5},i&&i.settings&&t.extend(this.settings,i.settings)}});return s}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(52),i(4)],s=function(t,e,i){var n=e.extend({templateName:"page_row",tagName:"li",className:"vf-item vf-page-row",initialize:function(){this.listenTo(this.model,"change",this.render),this.render()},render:function(){var t=this.model.toJSON(),e=this.options.settings,i={model:t,host:location.hostname,hasImage:e.hasImage||!1,hasDescription:e.hasDescription||!1,hasCount:!0};return this.$el.html(this.template(i)),this}});return n}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(107),i(64),i(111),i(112),i(4)],s=function(t,e,i,n,s){var r=t.extend({initialize:function(t){var s=this.$el.data();this.collection=new i,this.view=new e({itemView:n,collection:this.collection}),this.collection.settings.days=s.days||0,this.collection.settings.limit=s.limit||5,this.collection.settings.format=s.format||"list",this.collection.settings.section=null,void 0!==s.section&&(this.collection.settings.section=s.section),s.navigation&&(this.navigation=s.navigation),this.listenTo(this.collection,"reset",this.render),this.collection.fetch({batch:!0,reset:!0})}});return r}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(25),i(22),i(9)],s=function(t,e,i,n){var s=e.extend({model:i,url:"/users",initialize:function(e,i){this.settings={show:"top",days:0,limit:5},i&&i.settings&&t.extend(this.settings,i.settings)}});return s}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(52),i(4),i(9)],s=function(t,e,i){var n=t.extend({templateName:"user_row",tagName:"li",className:"vf-item vf-user-row clearfix",events:{"click .vf-username":"showAccount","click .vf-avatar":"showAccount"},initialize:function(){this.listenTo(this.model,"change",this.render,this),this.render()},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.$(".vf-avatar").attr("onerror","this.src='"+this.model.defaults.pic_small+"'"),this},showAccount:function(t){t&&t.preventDefault&&(t.preventDefault(),t.stopPropagation()),i.trigger("/user/account/click",this.model)}});return n}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(107),i(64),i(24),i(114),i(4),i(115)],s=function(t,e,i,n,s,r,o){var a=e.extend({initialize:function(t){var e=this.$el.data();this.collection=new n,this.orientation=e.orientation||"vertical",this.collection.settings.section=null,void 0!==e.section&&(this.collection.settings.section=e.section),this.collection.settings.show=t.show||"top",this.collection.settings.type=e.type||"comment",this.collection.settings.days=e.days||0,e.path&&(this.collection.rootUrl="/pages/"+encodeURIComponent(this.parsePath(decodeURIComponent(e.path))),"comment"===this.collection.settings.type&&(this.collection.settings.type="any")),e.navigation&&(this.navigation=e.navigation),this.cols=e.cols||1,this.rows=e.rows||e.limit||5,"horizontal"===e.orientation?this.collection.settings.limit=this.cols*this.rows:(this.collection.settings.limit=this.rows,this.view=new i({itemView:s,collection:this.collection})),"editor_pick"===e.filter&&(this.collection.settings.show="editor-picks"),this.collection.fetch({batch:!0,reset:!0}),this.listenTo(this.collection,"reset",this.render)},render:function(){this.$el.html(this.template(this.$el.data())),this.$data_container=this.$el.find(".vf-data-container"),"horizontal"===this.orientation?this.renderHorizontal():this.$el.find(".vf-data-container").append(this.view.el),this.renderUI()},renderHorizontal:function(){var e,i=this;this.collection.each(function(n,s){s%i.cols===0&&(e=i.createRow());var r=new o({model:n}),a=t(r.render().el);a.css({width:i.getColWidth()}),e.append(a),s%i.cols===0&&i.$data_container.append(e)})},createRow:function(){var e=t("<div />");return e.addClass("vf-community-widget vf-clearfix"),e},getColWidth:function(){this.$el.css({visibility:"hidden",display:"block"});var t=this.$data_container.width()/this.cols;return this.$el.removeAttr("style"),t}});return a}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(52),i(4),i(9),i(2)],s=function(t,e,i,n){var s=t.extend({templateName:"comment_row",tagName:"li",className:"vf-item",events:{"click .vf-username":"showAccount"},initialize:function(){this.listenTo(this.model,"change",this.render),this.render()},render:function(){return this.$el.html(this.template(this.getComment())),this.delegateEvents(),this.model.user.isGuest()&&(this.$el.addClass("vf-is-anonymous"),this.$el.undelegate(".vf-username","click")),this},getComment:function(){var t=this.model.toJSON();return t.timeAgo=this.getRelativeTime(t.date_created,this.domainSettings.currentTime()),t.video&&t.video.thumbs&&(t.video_placeholder=t.video.thumbs.medium),t.content&&t.content.replace(/&#?[a-zA-Z0-9]+;/g,"#").length>75&&(t.content=this.subStringLastWord(t.content,71)+" ..."),t.picture&&(t.picture.s?t.imageURL=t.picture.s.url:t.picture.t&&(t.imageURL=t.picture.t.url)),t},showAccount:function(t){t.preventDefault(),t.stopPropagation(),i.trigger("/user/account/click",this.model.toJSON().user)}});return s}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(4),i(9),i(114)],s=function(t,e,i){return i.extend({templateName:"popular",tagName:"div",className:"vf-community-comment",events:{"click .vf-user":"showAccount"},render:function(){var t=this.getComment();return this.$el.html(this.template(t)),this.delegateEvents(),this.model.user.isGuest()&&(this.$el.addClass("vf-is-anonymous"),this.$el.undelegate(".vf-username","click")),this},showAccount:function(t){t.preventDefault(),t.stopPropagation(),e.trigger("/user/account/click",this.model.get("user"))}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(4),i(52)],s=function(t,e,i){var n=i.extend({templateName:"tabs",events:{"click .vf-community-tabs > li a":"changeTabs"},initialize:function(e){this.$widgets=this.$el.children(".vf-widget");var i=this.tabs=[];this.$widgets.length>0&&(t.each(this.$widgets,function(e,n){var s=t(n),r="vf-tabs-"+e;i.push({title:s.data("title"),container:r}),s.addClass(r)}),this.render())},render:function(){this.$el.find(".vf-nav.vf-clearfix.vf-community-tabs").remove(),this.$el.prepend(this.template());for(var e=0;e<this.tabs.length;e++){var i=t("<li><a data-con="+this.tabs[e].container+" href='#'>"+this.tabs[e].title+"</a></li>");this.$(".vf-community-tabs").append(i)}this.$tabs=this.$el.find("ul li"),this.$widgets.first().addClass("vf-current"),this.$tabs.first().addClass("vf-current")},changeTabs:function(e){e.preventDefault();var i=t(e.target);this.$widgets.removeClass("vf-current"),this.$tabs.removeClass("vf-current"),i.parent().addClass("vf-current"),this.$el.find("."+i.data("con")).addClass("vf-current")}});return n}.apply(e,n),!(void 0!==s&&(t.exports=s))},,,,,,,,,,,,function(t,e,i){var n,s;n=[i(4),i(129),i(28),i(38)],s=function(t,e,n,s){t.register({name:"counter",create:function(t){var i=new n;return new e({el:t,model:i})},loadDeps:function(t){i.e(1,function(e){var i=[e(39)];(function(e){s.loadTemplates(e),t&&t()}).apply(null,i)})}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(52),i(4),i(9)],s=function(t,e,i,n){var s=e.extend({initialize:function(t){var e,s=this.$el.data();e=s.path?this.parsePath(s.path):s.id?s.id:this.parsePath(i.locations.path),this.model.set("id",encodeURIComponent(e)),this.listenTo(this.model,"change",this.render),this.listenTo(n,"comment:created",this.incrementCount),this.model.fetch({batch:!0}),this.render()},render:function(){var t=this.model.get("num_replies");return this.$el.text(t),this},incrementCount:function(t){t.get("page").id==this.model.id&&this.model.set("num_replies",this.model.get("num_replies")+1)}});return s}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(4),i(131),i(38)],s=function(t,e,n){t.register({name:"rating-star",create:function(t){return new e({el:t})},loadDeps:function(t){i.e(1,function(e){var i=[e(39)];(function(e){n.loadTemplates(e),t&&t()}).apply(null,i)})}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(6),i(4),i(52),i(9),i(28)],s=function(t,e,i,n,s,r){var o=n.extend({templateName:"ratings",events:{"mouseover .vf-rating":"clearRatings","mouseout .vf-rating":"restoreRatings","click span":"rate"},initialize:function(t){e.bindAll(this,"update"),this.user=i.current.user,this.settings=i.current.settings;var n=this.$el.data(),s=i.current.page,o=1===this.settings.attributes.enable_page_rating;e.bindAll(this,"render","onPageFetch"),o&&n.path&&(n.path=encodeURIComponent(this.parsePath(n.path)),s=new r({id:n.path}),s.fetch({batch:!0,success:this.onPageFetch})),this.model=s,n.path||this.onPageFetch()},onPageFetch:function(){this.render(),this.listenTo(this.model,"change",this.render)},render:function(){var t=this.model.toJSON();this.$el.html(this.template(t)),this.$ratings=this.$el.find(".vf-ratings"),this.setRating(this.currentRating())},currentRating:function(){var t=this.model;if(this.user.isLoggedIn()){var e=t.get("ratings");if(e&&e[t.id])return e[t.id].points.toFixed(1)}return t.get("rating").toFixed(1)},rate:function(e){if(e.preventDefault(),this.authorize("rate",this.model)){var i=t(e.target),n=i.data().value;this.restAPI.request("put","ratings/"+this.model.id,{points:n},{success:this.update,error:this.update})}},update:function(t){t&&t.result&&this.model.set(t.result)},select:function(e){var i=t(e.target);this.setRatings(i.data().value)},restoreRatings:function(t){this.setRating(this.currentRating())},clearRatings:function(t){this.$(".vf-rating span").removeClass("vf-till")},setRating:function(e){t(this.$el.find(".vf-rating span")[-1*(e-5)]).addClass("vf-till")}});return o}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(1)],s=function(t,e){window.JSON=window.JSON||e,t.fn.serializeObject=function(){var e={},i=this.serializeArray();return t.each(i,function(){e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),i=this,n=function(){},s=function(){return i.apply(this instanceof n&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return n.prototype=this.prototype,s.prototype=new n,s})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(12)],s=function(t,e){function i(e,i){s?t(e).html(a).children().addClass("vf-loading"):t.each(l,function(n,s){n==i.gifType&&t(e).html(s)})}function n(t){t.html("&#xe602;")}for(var s=!1,r=["animationName","webkitAnimationName","mozAnimationName","MSAnimationName","oanimationName"],o=document.createElement("div"),a='<span class="vf-l1"></span><span class="vf-l2"></span><span class="vf-l3"></span>',l={white:'<img src="'+e.asset_url+'img/vf-loader-white.gif" alt="loading">',whitelarge:'<img src="'+e.asset_url+'img/vf-loader-white-large.gif" alt="loading">',gray:'<img src="'+e.asset_url+'img/vf-loader-gray.gif" alt="loading">',blue:'<img src="'+e.asset_url+'img/vf-loader-blue.gif" alt="loading">',bluegray:'<img src="'+e.asset_url+'img/vf-loader-gray-blue.gif" alt="loading">'},u=0;u<r.length;u++)if(void 0!==o.style[r[u]]){s=!0;break}var c=[];t.fn.loader=function(e,s){if(0===this.length)return this;s=s||{};var r;return"show"===e?(r=t("<div>").addClass("vf-loader"),"large"==s.loaderSize&&r.addClass("vf-loader-large"),s.block&&r.addClass("vf-loader-block"),s.gifType||(s.gifType="white"),s.position||(s.position="left"),s.inside?this.html(r):"right"==s.position?(r.addClass("vf-loader-right"),this.after(r)):this.before(r),r.siblings(".vf-loader")[0]&&this.siblings(".vf-loader").remove(),this.siblings(".vf-loader-error")[0]&&this.siblings(".vf-loader-error").each(function(){t(this).tipsy("remove").remove()}),this.parents(".vf-comment-actions, .vf-flag-container")[0]&&this.parents(".vf-comment-actions, .vf-flag-container").removeClass("vf-force-focus"),i(r,s),t.data(this[0],"loader",r)):"hide"===e?(r=t.data(this[0],"loader"),r&&(r.remove(),t.data(this[0],"loader",null))):"error"==e&&(t.fn.loader.call(this,"hide"),r=t("<div class='vf-loader-error'>"),this.parents(".vf-comment-actions, .vf-flag-container")[0]&&this.parents(".vf-comment-actions, .vf-flag-container").addClass("vf-force-focus"),"right"==s.position?(r.addClass("vf-loader-right-error"),this.after(r)):this.before(r),c.push(this[0]),n(r),t.data(this[0],"loader",r)),r},t.fn.loader.hideErrors=function(){for(var e=0;e<c.length;e++)t(c[e]).loader("hide");return c.length=0,this}}.apply(e,n),!(void 0!==s&&(t.exports=s))}]);